//<script>

    //start code
    var Hantana = {}, viewSurvey = false;
    window.Hantana.user = window._hantanaSettings.tId;
    window.Hantana.setUserData = function (data) {
        window.Hantana.name = data.name;
        window.Hantana.email = data.email;
        window.Hantana.phone = data.phone;
        window.Hantana.description = data.description;
        window.Hantana.avatar = data.avatar;
    };

    function getDataUserApi(){
        return {
            name:(window.Hantana.name != undefined) ? window.Hantana.name : '',
            email:(window.Hantana.email != undefined) ? window.Hantana.email : '',
            phone:(window.Hantana.phone != undefined) ? window.Hantana.phone : '',
            description:(window.Hantana.description != undefined) ? window.Hantana.description : '',
            avatar:(window.Hantana.avatar != undefined) ? window.Hantana.avatar : '',
        };
    }
    function setCookie(name,value,days) {
        var expires = "";
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "")  + expires + "; path=/";
    }
    function getCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }
    // function eraseCookie(name) {   
    //     document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    // }

    var hantanaUser = getCookie('_hantanaUser');
    if(!hantanaUser){
        setCookie('_hantanaUser', Math.random().toString(36).substr(2, 9), 36500);
    }


    //not use
    window.Hantana.openSubscribe = function () {}
    window.Hantana.closeSubscribe = function () {}
    window.Hantana.toggleSubscribe = function () {}
    window.Hantana.setColorButtonSubscribe = function () {}
    window.Hantana.setTitleSubscribe = function () {}
    window.Hantana.setPlaceholderEmailTextBoxSubscribe = function () {}
    window.Hantana.setPlaceholderMobileTextBoxSubscribe = function () {}
    window.Hantana.hideAfterSendSubscribe = function (second, flag = false) {
        if(!flag){
            localStorage.removeItem("showSubscribeHantanaAfterUseFlag"); 
        }
    }
    window.Hantana.openPolls = function () {}
    window.Hantana.closePolls = function () {}
    window.Hantana.togglePolls = function () {}
    window.Hantana.setWelcomeMessagePolls = function () {}
    window.Hantana.setColorButtonPolls = function () {}
    window.Hantana.hideAfterSendPolls = function (second, flag = false) {
        if(!flag){
            localStorage.removeItem("showPollsHantanaAfterUseFlag"); 
        }
    }
    window.Hantana.openSubscribe = function () {}
    window.Hantana.closeSubscribe = function () {}
    window.Hantana.toggleSubscribe = function () {}
    window.Hantana.setColorButtonSubscribe = function () {}
    window.Hantana.setTitleSubscribe = function () {}
    window.Hantana.setPlaceholderEmailTextBoxSubscribe = function () {}
    window.Hantana.setPlaceholderMobileTextBoxSubscribe = function () {}
    window.Hantana.hideAfterSendSubscribe = function (second, flag = false) {
        if(!flag){
            localStorage.removeItem("showSubscribeHantanaAfterUseFlag"); 
        }
    }
    window.Hantana.showSurvey = function (flagOpen) {
        var refreshIntervalId = setInterval(function(){
            if(viewSurvey){
                window.Hantana.showSurvey(flagOpen);
                clearInterval(refreshIntervalId);
            }
        }, 200);
    }

    

    var startRunPage = new Date().getTime(),
    ipDetail = JSON.stringify({
        "ip": "0.0.0.0",
        "country_name": "NoData",
        "country_code": "NoData",
    }),
    resizeWindowHantana = false,
    checkAccountUserResultHantana = Number('0'),
    flagRequireRunHantana = 'false',
    vDataHantana = '0d0e0e0e0e',
    sDataHantana = '0808060d5b130f0e58085f13060b095a06130c5b5a065b',
    heatmapPrefixHantana = 'https://heatmap.hantana.org/',
    // heatmapPrefixHantana = 'http://localhost:1080/',
    primaryPrefixHantana = 'https://hantana.org/',
    // primaryPrefixHantana = 'http://localhost:5000/',
    popUpPrefixHantana = 'https://popup.hantana.org/',
    // popUpPrefixHantana = 'http://localhost:7687/',
    surveyPrefixHantana = 'https://survey.hantana.org/',
    sitemapPrefixHantana = 'https://sitemap.hantana.org/',
    viewsDataHantana = undefined,
    b = document.getElementsByTagName("html")[0],
    h = document.getElementsByTagName("head")[0],
    poweredByImg = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH4AAAAhCAMAAAAoJe+YAAABJlBMVEUAAAD////////////////////////////////////////////////////kNxD////////////////////////////////////////////////////////jNxH////////////////////////////////////////////////////////jNxHjNxHjNxH////////////////////////////////////jNxHjNxHjNxHjNxHjNxHjNxH////////////////jNxH////////////////jNxH////jNxHjNxHjNxHjNxHjNxHjNxHjNxHjNxH////jNxHjNxH////jNxHkNxHjNxH////jNxHjNxHjNxHjNxHjNxHjNxHjNxHjNxH///+K+vEQAAAAYHRSTlMACQL8HvjiaKQmBZxjIwrz77ot58GENRcP7tWSXvvkzH9DOjEM3dCKeHJSB/TluXBJ69K1r6uWbBwYEdPNw76nW00tFBMSxH57a09GNfntyK6OjHZYWATa2JphI6GHbzxZdBZmAAAD8klEQVRYw+2W13baQBBABwlRhJAoxtSARHEoMb2YYhtcwTWO7TiOU5j//4nMrkAHsOMHnxPy4vvAEatyd2ZntIJ33pmh9naeuir8F3rnP8uDh4f+7uP9Dqwb9b78aTrjQ/90zRN4+sHl1gQGZ7BGLq6nK1xNvsK6OBhMn/FpAjMihfwhPxCKoQy8gj1te4u9W56+wPY5mBQl0Wk+/hu6ZPgr2YamvEV/+mH6Ertd4DgRQ/wgUEN/6ZXgc+h5S+q3py/yYWLpP/KDzSjuvZJedxD33xL8QsLL5f6l9e+6t6L34QbpBfcwH8onvEAYFXvJGOujLJVIR8PUHY0KAUUP5e/CdFouOo+yI31s8Fnb0h09VKhml183VtVfPh6oaneybVXf+bI+zfVCIiciolhP0wP38GNcQ5TaWaiwUSoOuZBEdn4jABCOiXmXhKiFSgCHbR8Skud4qemu5sn+ogLjzPKfzvWpm3g7frMvMX3AgVt5Z1vDpg0iWyhFm54kSkMIeCR0xKtg+PCk4CRpHMDrQKm276qhzwAooNRyVvwoJhb1Z/PCK/fA5Nd85PNXU2/B9IZW36S4/RgLw2EMpY4MishcgSC2BIChuOGlUFN4kgV3En1FQdAR8wBx9ER4AcXBgmTLqSZ6u/PaV2d6x56fSIlMn626haNAIoY5OxzF8Judt4QLyMVL73hkl8MZJ+UoQtGzSYAhsd7xViMlezqkoUd4ofI+cxfn+yz867n+xkbI5tpDWHFt1USakxeO67wX7A4Ss8p38QbsNGM+Ol/nepfAa5aqR8jo/pwm4rL+dlZ392Cx07eiXyy9TJTpMylRa4QU/0zfkLm+Kcz1RgyjTV1JzaL3sBt5wjtBdOwX6JfpV0PtdxfGvlhr/7zx2qgpJZBbGHRT8hf03iRb+1ITgyMZsicYO6T14Hq+3vRWOnELrEJci/rf5l73CAucm2M/gaFYeha93ECHm44d6Ntken+J60lMv/4sHFPYYYBqFJNuS+/DG8j4mFfIi8vvru6Adx3lfjX7l+aumxBRB4ImzmQfUWwlCnWRGogaz4w+R2ln4qjfVXRRZw/HORElw0p+jUovvIVBfRiPiqxaVzO9/QSL/GBjA3M9qprEO5U9oE1LvCehWGspdayArYFttidu8F0hryHieDNFMwt6nDmpyNpvzIoxhk4KI4ko5UK6RmlZ4GJ7ue55QTD9LXBsxbsIcNKKl82iWFAyVIKJMCWEj0C6YmcXGpXK6Ajsd4VEQIb0MMLuoItAqHbC/GVcKdqF0qgqw2r4t8+3ocGavrh2dqdXF7CEWp5ere176+KhrMIyk0+3a/zaOoAVer9VeOedf8UfVjgRGhkca1YAAAAASUVORK5CYII=",
    poweredByImgDark = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAAAbCAMAAABItlHCAAABCFBMVEUAAAAuLi4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/jNxEvLy8vLy8vLy8vLy8vLy/jNxEvLy/kNxEvLy8vLy8vLy8vLy8vLy8vLy/jNxEvLy8vLy8vLy8vLy8vLy/jNxEvLy/jNxEvLy8vLy8vLy8vLy8vLy8vLy/kNhDjNxHjNxHjNxHjNxEvLy8vLy/jNxEvLy/jNxEvLy/jNxEvLy/jNxHkNxEvLy/jNxEvLy/jNxEvLy/jNxHjNxEvLy8vLy/jNxEvLy8vLy/jNxHjNxHjNxHjNxEvLy/jNxHjNxHjNxHjNxHjNxHjNxEvLy/Xvf9mAAAAVnRSTlMAAiIK+BnQ5AbhHtdE+77IFYEo7aRxExAN/H0D/ujCuqeKFfPcta1LQD/alHp1XFExBva/hC/u1M6cnI1zaTUNCNKyrZBrTjo35tliXCWVfVYgHKhjVpynFPUAAAMzSURBVEjH7ZTnctpAFIWv2qpLIIqEEEVUY0xxAZsW4x6X9MT7/m+Su5KCTOIfyUyYyY+cGdhdgfbTOfeu4L/+ms4bjfMy7Fyfn+bHF/tnV8vJIexSjeVF6TnW/XwCu9ObY+RstP+0swz39p+3lLtJUJmuFI2O4cHrcot/Anp3lhBS1C1E8sU+h4Nw2RzCq/Lylvb7oMP58y+6+AQoLk9rCrN2Sg/gVWmy2PuD7HLPiUpHG9SHiFSnloCjpFMfUEVNc9koZNh8zWKtiF3mWpF4SYn+IuA8w8WGNX4r2/L7ZPOj+bfbkx8VO2sknjh2u06zAPw1UVW7IACXtXtZ0uq8BadmBvq1x40uW7LeQXd8NTQ6LeJ7GIRvqyoJpZTUuEhq8/WQdeFZgt2LSQ+DQqHgV5Dktim5zjfFISg1qrasCq26TtsMSCh0p2L92qZEgp7YVG3bNFeg9GmrP8MbuQ1pkouT+1DeyvImJiVCEq+3NXZlxq1rVB8LQ7GJpmSxC1CorDgYV7BkhkgXbrFNO5xXI2MAn1a9tExHSVzbYZ7EJHURhmF/iiTO4Z1R9hQ3WVu0z0pkGsDLogHgjrW7Vb5pdsFgePBZeXmH7x5UKSn+RCotN6c4l5LqSe+xOinDmqzaBEmCxVpRU2NSD6fhaUW3puYIDFPm0SOtCpzRUWViB0ja3vn+3abpryLScqv3kGQ0pwPHC+nlTyQDlBmtdiW+FaQka+20xMXYfaQkk75ao3a7St+rNyXm8TZOLyUNqC2AZOPjKjUkIcTsIi4YKkVCVwBDMXjE9BhpQKvKKFB5EOoUv7c8lG5go8k9e/dFHme0nZxcH0aiODuwKkFL49p0EHnqgWvTh3ahTh/8hT6lIdyJiSdlLAeXg45sNu9goyf0kJuk6/NjJM2jTnzUB9G57OsGCAUik+zbuiXBAS5ByNs8cEMi6yunrqrt0UdSAK1a9wB6pz7HfbRlvX+3IOMXBwp3Pj6HVCdI3gMmJT744EkMmOGLOM0gJFq6OGMXcaFomoAhC7h0WepsBi77ZY2fVLe5qNNedGPppAy7UHm5/wbgZXxfGrAbHU62LXxqwH/9S/oObgadvknoFQMAAAAASUVORK5CYII=",
    arrowBottomHantana = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACABAMAAAAxEHz4AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAPUExURUxpcf///////////////0Wl2ZkAAAAEdFJOUwC4CY6jHNxcAAABNklEQVRo3u3YSxKCMBCEYUpvYHEALT0AZXkBlPufyQcRSchjuntnzb/P8BGyIV3neZ7neR7QuR+vyvr99Grg1+/694DxSA84TZ8OGkAgBABN+AJowgIgCT8ASVgBKMIaQBEiAEGIAQQhAcCEFAATNgCQsAWAhAwAIuQAECELAAh5AEAoAMyEEsBMKAKMhDLASKgATIQawESoAgyEOsBAaACahBagSWgCGoQ2oEEwAKoEC6BKMAEqBBugQjACigQroEgwAwoEO6BAAABZAgLIEiBAhoABMgQQsCGggA0BBiQEHJAQCEBEYAARgQKsCBxgRSABC4EFLAQaEAg8IBAEwEzolQFj+DnlG7qLNuDe3bQBD20L3pswiekD5FeQN1H+jPJBko+yRhjmqx76+dIVked5nuf9Z09QRtll6NRbLAAAAABJRU5ErkJggg==',
    imageOnBtnFeedbackHantana = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAA3CAMAAAB5LOkwAAAAqFBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8j1z1tAAAAN3RSTlMA+68E5g/ZCvdJHNPHODGbGfTw6piU4L61ZhYSAe7dz8zCn4l+dKWQg2FWTkE+Liomu3ZtII1dJHUleQAAAn1JREFUSMeVltmWojAQQIt9EVDBYVVUBPd9q///s5FMRiya7ob7lOSca6oqlQjUkUzjmgU9X/ZVS1xvjxr8zPi+WapDrNDlYH1Qvhck55EK+IXh/GaOm43zSsZmhF4RNwjaRkUClSxDqhvJSscfmeS1lEwRf0NYDj6NWMQWhOZHHn1E9MRsKiAKfjDlZXYvmVWGKweWyxbEqgiFgGgdJIivsrs4a4lh4Qt1p4ESpXr/qCmHkDkriRu2jJg67CgPO7Z4UhEnBpQ4T40ly35F3/CwykTWQMgRM1rVjcB2PrHJVn/pBlV2AkZAcCZY8kcqNwnLpjgAwdDx2ajIZQJ7Vo0bEArEFe2rrYCMBQA82Eh14IP7DFEmsSYh/mM6gHjGh8d6L6R7eKP0Ba64BuwnfGyd692j2l8MVtviPZlzZ/Dunp7NjVFloAhLROIwgzjUwB7MsSI486iIkxADZSAXyzqZIRLUQ5IRA13wyXwWYA01pAbqkGJHXOh1VWS4dFV60O+qhHClb0I4evGHMxr1X/hUeYAxJAsF1BnQbPUn3FVa5UFdiQSavQOSSCPLx9S4T5EwVwBuSPB2xFAyJLArdpKR4O/GH8aKhMUfCWmJFK9IuCDZYs3AHsvVGH555vP9fWA6m6WHdVbvd6zO0FfTidCwvgfG3sO2BAoPedHWECLgxG17c1od9HHabpMbVNitrg3tpmPQKhNCvP61bvMEKJKd/Szp26avi3xOzo8iatCE4mwe4sz3hm/zPZBt+BZJMU+28Yyi2zXPo8V/Zz2GVlR3wzKhLdqFGe4O2rNgykLqoLA/yUsMHTh6iKkNXUhm6G6hE+OlUEjQjWufHvtfDPQ9hKhZKxUAAAAASUVORK5CYII=',
    closeImageHantana = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4IiB2aWV3Qm94PSIwIDAgMzQ4LjMzMyAzNDguMzM0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzNDguMzMzIDM0OC4zMzQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIiBjbGFzcz0iIj48Zz48Zz4KCTxwYXRoIGQ9Ik0zMzYuNTU5LDY4LjYxMUwyMzEuMDE2LDE3NC4xNjVsMTA1LjU0MywxMDUuNTQ5YzE1LjY5OSwxNS43MDUsMTUuNjk5LDQxLjE0NSwwLDU2Ljg1ICAgYy03Ljg0NCw3Ljg0NC0xOC4xMjgsMTEuNzY5LTI4LjQwNywxMS43NjljLTEwLjI5NiwwLTIwLjU4MS0zLjkxOS0yOC40MTktMTEuNzY5TDE3NC4xNjcsMjMxLjAwM0w2OC42MDksMzM2LjU2MyAgIGMtNy44NDMsNy44NDQtMTguMTI4LDExLjc2OS0yOC40MTYsMTEuNzY5Yy0xMC4yODUsMC0yMC41NjMtMy45MTktMjguNDEzLTExLjc2OWMtMTUuNjk5LTE1LjY5OC0xNS42OTktNDEuMTM5LDAtNTYuODUgICBsMTA1LjU0LTEwNS41NDlMMTEuNzc0LDY4LjYxMWMtMTUuNjk5LTE1LjY5OS0xNS42OTktNDEuMTQ1LDAtNTYuODQ0YzE1LjY5Ni0xNS42ODcsNDEuMTI3LTE1LjY4Nyw1Ni44MjksMGwxMDUuNTYzLDEwNS41NTQgICBMMjc5LjcyMSwxMS43NjdjMTUuNzA1LTE1LjY4Nyw0MS4xMzktMTUuNjg3LDU2LjgzMiwwQzM1Mi4yNTgsMjcuNDY2LDM1Mi4yNTgsNTIuOTEyLDMzNi41NTksNjguNjExeiIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgY2xhc3M9ImFjdGl2ZS1wYXRoIiBkYXRhLW9sZF9jb2xvcj0iIzAwMDAwMCIgZmlsbD0iI0ZGRkZGRiIvPgo8L2c+PC9nPiA8L3N2Zz4K",
    langDataHantana = {
        "nextQuestionTextSurvey" : {
            "fa":{
                "text": "بعدی",
                "direction" : "rtl"
            },
            "en":{
                "text": "Next",
                "direction" : "ltr"
            }
        },
        "lastQuestionTextSurvey" : {
            "fa":{
                "text": "ارسال",
                "direction" : "rtl",
                "align" : "center"
            },
            "en":{
                "text": "Send",
                "direction" : "ltr",
                "align" : "center"
            }
        },
        "skipQuestionTextSurvey" : {
            "fa":{
                "text": "رد شدن",
                "direction" : "rtl",
                "align" : "center"
            },
            "en":{
                "text": "Skip",
                "direction" : "ltr",
                "align" : "center"
            }
        },
        "closeQuestionTextSurvey" : {
            "fa":{
                "text": "بستن",
                "direction" : "rtl"
            },
            "en":{
                "text": "Close",
                "direction" : "ltr"
            }
        },
        "placeholderInputsSurvey" : {
            "fa":{
                "text": "لطفا اینجا بنویسید",
                "direction" : "rtl",
                "align" : "right"
            },
            "en":{
                "text": "Please type here...",
                "direction" : "ltr",
                "align" : "left"
            }
        }
    };
    var previewSurveyFlag = window._hantanaSettings.preview;
    var previewFeedbackFlag = window._hantanaSettings.previewFeedback;
    var externalSurvey = window._hantanaSettings.externalSurvey;


    //add html2canvas js
    var html2canvas = document.createElement("script");
    // html2canvas.type = "text/javascript", html2canvas.async = !0, html2canvas.src = "https://hantana.s3.ir-thr-at1.arvanstorage.com/html2canvas.min.js";
    html2canvas.type = "text/javascript", html2canvas.async = !0, html2canvas.src = "https://hantana.org/widgets/js/html2canvas.min.js";
    h.appendChild(html2canvas);

    //on resize window change flag
    var currentWidth = window.innerWidth;
    window.addEventListener("resize", function(){
        var newWidth = window.innerWidth;
        if(currentWidth != newWidth && !resizeWindowHantana){
            resizeWindowHantana = true;
        }
    });

    function validateEmailHantana(email) {
        const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }

    function addToUntilSurveyList(surveyId, type){
        var getLocalStorageValue = window.localStorage.getItem('hantana_show_survey_until_' + type);
        if(getLocalStorageValue){
            getLocalStorageValue = JSON.parse(getLocalStorageValue);
            getLocalStorageValue.push(surveyId);
            window.localStorage.setItem('hantana_show_survey_until_' + type, JSON.stringify(getLocalStorageValue));
        }else{
            window.localStorage.setItem('hantana_show_survey_until_' + type, JSON.stringify([surveyId]));
        }
        var getCookieValue = getCookie('hantana_show_survey_until_cookie_' + type);
        if(getCookieValue){
            getCookieValue = JSON.parse(getCookieValue);
            getCookieValue.push(surveyId);
            setCookie('hantana_show_survey_until_cookie_' + type, JSON.stringify(getCookieValue), 36500);
        }else{
            setCookie('hantana_show_survey_until_cookie_' + type, JSON.stringify([surveyId]), 36500);
        }
    }
    function findUntilSurveyList(surveyId, type){
        var getLocalStorageValue = window.localStorage.getItem('hantana_show_survey_until_' + type);
        if(getLocalStorageValue){
            getLocalStorageValue = JSON.parse(getLocalStorageValue), findData = false;
            getLocalStorageValue.forEach(function(item){
                if(item.toString() == surveyId.toString()){
                    findData = true;
                }
            });
            return findData;
        }else{
            return false;
        }
    }
    function syncLocalStorageCookie(){
        for(var i = 1; i <= 3; i++){
            var getCookieValue = getCookie('hantana_show_survey_until_cookie_' + i);
            if(getCookieValue){
                var getLocalStorageValue = window.localStorage.getItem('hantana_show_survey_until_' + i);
                if(!getLocalStorageValue){
                    window.localStorage.setItem('hantana_show_survey_until_' + i, getCookieValue);
                }
            }else{
                var getLocalStorageValue = window.localStorage.getItem('hantana_show_survey_until_' + i);
                if(getLocalStorageValue){
                    setCookie('hantana_show_survey_until_cookie_' + i, getLocalStorageValue, 36500);
                }
            }
        }
    }
    syncLocalStorageCookie();

    
    function getOSHantana() {
        var string = navigator.userAgent;
        switch (true) {
            case /windows nt 6\.0/i.test(string):
                return 1;
            case /windows nt 6\.1/i.test(string):
                return 1;
            case /windows nt 6\.2/i.test(string):
                return 1;
            case /windows nt 6\.3/i.test(string):
                return 1;
            case /windows nt 10\.0/i.test(string):
                return 1;
            case /windows nt 5\.2/i.test(string):
                return 1;
            case /windows nt 5\.1/i.test(string):
                return 1;
            case /windows nt 5\.0/i.test(string):
                return 1;
            case /windows phone 8\.1/i.test(string):
                return 1;
            case /windows phone 8\.0/i.test(string):
                return 1;
            case /(android)/i.test(string):
                return 4;
            case /linux x86\_64/i.test(string):
                return 5;
            case /linux/i.test(string):
                return 5;
            case /os x 10[._]12/i.test(string):
                return 2;
            case /os x 10[._]13/i.test(string):
                return 2;
            case /os x 10[._]14/i.test(string):
                return 2;
            case /os x/i.test(string):
                return 2;
            case /\(iPad.*os (\d+)[._](\d+)/i.test(string):
                return 3;
            case /\(iPhone.*os (\d+)[._](\d+)/i.test(string):
                return 3;
            case /ios/i.test(string):
                return 3;
            case /X11/i.test(string):
                return 5;
            default:
                return 6;
        }
    }

    function parseUrlHantana(url) {
        if(url.endsWith('/')){ 
            url = url.slice(0, -1); 
        }
        var match = url.match(/^(http|https|ftp)?(?:[\:\/]*)([a-z0-9\.-]*)(?:\:([0-9]+))?(\/[^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/i);
        var regexParse = new RegExp('([a-z\-0-9]{2,63})\.([a-z\.]{2,5})$');
        var ret = new Object();
        ret['protocol'] = '';
        ret['host'] = '';
        ret['www'] = '';
        ret['domain'] = '';
        ret['type'] = '';
        ret['subdomain'] = '';
        ret['port'] = '';
        ret['portColon'] = '';
        ret['path'] = '';
        ret['query'] = '';
        ret['queryMark'] = '';
        ret['fragment'] = '';
        ret['fragmentSharp'] = '';
        if(match[1]){
            ret['protocol'] = match[1];
        }
        if(match[2]){
            if(match[2].startsWith('www.')){
                ret['www'] = match[2];
                ret['host'] = match[2].substring(4);
            }else{
                ret['www'] = 'www.' + match[2];
                ret['host'] = match[2];
            }
        }
        if(match[3]){
            ret['port'] = match[3];
            ret['portColon'] = ':' + match[3];
        }
        if(match[4]){
            ret['path'] = match[4];
            if(ret['path'].endsWith('/') && ret['path'] != '/'){ 
                ret['path'] = ret['path'].slice(0, -1); 
            }  
        }
        if(match[5]){
            ret['query'] = match[5];
        }
        if(match[5]){
            ret['queryMark'] = '?' + match[5];
        }
        if(match[6]){
            ret['fragment'] = match[6];
        }
        if(match[6]){
            ret['fragmentSharp'] = '#' + match[6];
        }
        var urlParts = regexParse.exec(ret['host']);
        if(urlParts){
            ret['domain'] = urlParts[urlParts.length - 1];
            ret['type'] = urlParts[urlParts.length - 2];
            ret['subdomain'] = ret['host'].replace(ret['type'] + '.' + ret['domain'], '').slice(0, -1);
        }
        return ret;
    }
    function isValidIranianNationalCodeHantana(input) {
        if (!/^\d{10}$/.test(input)) return false;
        const check = +input[9];
        const sum = input.split('').slice(0, 9).reduce((acc, x, i) => acc + +x * (10 - i), 0) % 11;
        return sum < 2 ? check === sum : check + sum === 11;
    }
    function ArabicToEnglishNumHantana(string) {
        return string.replace(/[\u0660-\u0669]/g, function (c) {
            return c.charCodeAt(0) - 0x0660;
        });
    }
    function PersianToEnglishNumHantana(string) {
        return string.replace(/[\u06f0-\u06f9]/g, function (c) {
            return c.charCodeAt(0) - 0x06f0;
        });
    }
    function ArabicAndPersianToEnglishHantana(value){
        return ArabicToEnglishNumHantana(PersianToEnglishNumHantana(value))
    }
    function checkMatchUrl(type, urlOrValue, urlPage){

        urlPage = urlPage.replace(/\/+$/,'');
        urlOrValue = urlOrValue.replace(/\/+$/,'');

        var result = false;
        if(type == 1){
            //Simple match
            var parseUrlData = parseUrlHantana(urlPage);
            var createUrl = (parseUrlData.host + parseUrlData.portColon + parseUrlData.path).replace(/\/+$/,'');

            var parseValueData = parseUrlHantana(urlOrValue);
            var createValueUrl = (parseValueData.host + parseValueData.portColon + parseValueData.path).replace(/\/+$/,'');

            if(createUrl == createValueUrl){
                result = true;
            }
        }
        if(type == 2){
            //Exact match
            if(urlPage == urlOrValue){
                result = true;
            }
        }
        if(type == 3){
            //Starts with
            if(urlPage.startsWith(urlOrValue)){
                result = true;
            }
        }
        if(type == 4){
            //Ends with
            if(urlPage.endsWith(urlOrValue)){
                result = true;
            }
        }
        if(type == 5){
            //Contains
            if(urlPage.search(urlOrValue) != -1){
                result = true;
            }
        }
        if(type == 6){
            //Regex
            var decodedString = Buffer.from(urlOrValue, 'base64').toString();
            var regExpression = new RegExp(decodedString);
            var resultRegex = regExpression.test(urlPage);
            if(resultRegex){
                result = true;
            }
        }
        return result;
    }

    function isJson(str) {
        try {
            JSON.parse(str);
        } catch (e) {
            return false;
        }
        return true;
    }

    function checkHeatmapsInPageHantana() {
        return new Promise(function (resolve, reject) {
            try {
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open("POST", heatmapPrefixHantana + 'getHeatmapPageDataHantana', true);
                // xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                // xmlhttp.send(JSON.stringify({pageUrl: window.location.href, vData: vDataHantana, sData: sDataHantana, siteToken: window._hantanaSettings.tId, acRes:checkAccountUserResultHantana}));
                xmlhttp.send("pageUrl="+window.location.href+"&vData="+vDataHantana+"&sData="+sDataHantana+"&siteToken="+window._hantanaSettings.tId+"&acRes="+checkAccountUserResultHantana);
                xmlhttp.onreadystatechange = function(e) {
                    if(4 == this.readyState){
                        if(isJson(xmlhttp.responseText)){
                            var response = JSON.parse(xmlhttp.responseText);
                            resolve(response);
                        }
                    }
                };
            }catch (error) {}
        });
    }

    function checkFeedbacksInPageHantana() {
        return new Promise(function (resolve, reject) {
            try {
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open("POST", primaryPrefixHantana + 'widget/feedback/getData', true);
                xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                xmlhttp.send("siteToken="+window._hantanaSettings.tId+"&pageUrl="+encodeURIComponent(window.location.href));
                xmlhttp.onreadystatechange = function(e) {
                    if(4 == this.readyState){
                        if(isJson(xmlhttp.responseText)){
                            var response = JSON.parse(xmlhttp.responseText);
                            resolve(response);
                        }
                    }
                };
            }catch (error) {}
        });
    }

    function checkSurveysInPageHantana() {
        return new Promise(function (resolve, reject) {
            try {
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open("POST", primaryPrefixHantana + 'widget/survey/getData', true);
                xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                xmlhttp.send("siteToken="+window._hantanaSettings.tId+"&pageUrl="+encodeURIComponent(window.location.href));
                xmlhttp.onreadystatechange = function(e) {
                    if(4 == this.readyState){
                        if(isJson(xmlhttp.responseText)){
                            var response = JSON.parse(xmlhttp.responseText);
                            resolve(response);
                        }
                    }
                };
            }catch (error) {}
        });
    }

    function checkSurveysNewInPageHantana() {
        return new Promise(function (resolve, reject) {
            try {
                var xmlhttp = new XMLHttpRequest();
                // xmlhttp.open("POST", primaryPrefixHantana + 'widget/surveyNew/getData');
                xmlhttp.open("POST", surveyPrefixHantana + 'api/widget/getSurvey', true);
                xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                xmlhttp.send("siteToken="+window._hantanaSettings.tId+"&pageUrl="+encodeURIComponent(window.location.href)+"&acRes="+checkAccountUserResultHantana);
                xmlhttp.onreadystatechange = function(e) {
                    if(4 == this.readyState){
                        if(isJson(xmlhttp.responseText)){
                            var response = JSON.parse(xmlhttp.responseText);
                            resolve(response);
                        }
                    }
                };
            }catch (error) {}
        });
    }

    function checkPopUpInPageHantana() {
        return new Promise(function (resolve, reject) {
            try {
                var typeDevice = 3;
                if(userAgentHantana() == "desktop"){
                    typeDevice = 1;
                }else if (userAgentHantana() == "tablet"){
                    typeDevice = 2;
                }
                var referrerUrl = '';
                if (document.referrer && document.referrer != ""){
                    referrerUrl = document.referrer;
                }
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open("GET", popUpPrefixHantana + "api/popup/widget/?siteToken="+window._hantanaSettings.tId+"&device="+typeDevice+"&urlPatch="+encodeURIComponent(window.location.href)+"&referrer="+referrerUrl, true);
                xmlhttp.send(null);
                xmlhttp.onreadystatechange = function(e) {
                    if(4 == this.readyState){
                        if(isJson(xmlhttp.responseText)){
                            var response = JSON.parse(xmlhttp.responseText);
                            resolve(response);
                        }
                    }
                };
            }catch (error) {
                console.log('error', error)
            }

        });
    }

    function checkSubscribesInPageHantana() {
        return new Promise(function (resolve, reject) {
            try {
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open("POST", primaryPrefixHantana + 'widget/subscribe/getData', true);
                xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                xmlhttp.send("siteToken="+window._hantanaSettings.tId+"&pageUrl="+encodeURIComponent(window.location.href));
                xmlhttp.onreadystatechange = function(e) {
                    if(4 == this.readyState){
                        if(isJson(xmlhttp.responseText)){
                            var response = JSON.parse(xmlhttp.responseText);
                            resolve(response);
                        }
                    }
                };
            }catch (error) {}
        });
    }

    function siteMapRequestHantana(){
        try {
            var e = new XMLHttpRequest;
            e.onreadystatechange=function(){},
                e.open("POST", sitemapPrefixHantana + "insertURL", true),
                e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),
                e.send("siteToken="+window._hantanaSettings.tId+"&url="+window.location.href+"&vData=" + vDataHantana);              
                e.onreadystatechange = function(ev) {
                    if(4 == this.readyState && window._hantanaSettings.log){
                        console.log('insertURL ok');
                    }
                }
        }catch (error) {}
    }
    function popUpDataSetHantana(popupId, type){
        try {
            var deviceData = 1;
            if(userAgentHantana() == 'tablet'){
                deviceData = 2;
            }else if(userAgentHantana() == 'mobile'){
                deviceData = 3;
            } 
            //interaction
            var viewData = 0;
            var interaction = 1;
            if(type == 1){
                //view
                viewData = 1;
                interaction = 0;
            }
            var e = new XMLHttpRequest;
            e.onreadystatechange=function(){},
            e.open("POST", popUpPrefixHantana + "api/popup/analytics", true),
            e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),
            e.send("siteToken="+window._hantanaSettings.tId+"&popupId="+popupId+"&device="+deviceData+"&view="+viewData+"&interaction="+interaction);
            e.onreadystatechange = function(ev) {
                if(4 == this.readyState && window._hantanaSettings.log){
                    console.log('ok => report popup');
                }
            }
        }catch (error) {}
    }



    function sendDataToEndPointAddress(urlAddress, data, getTextInputs){
        try {            
            var e = new XMLHttpRequest;
            e.open("POST", urlAddress, true),
            e.setRequestHeader("Content-type","application/json;charset=UTF-8"),
            e.send(JSON.stringify(data));
            e.onreadystatechange = function(ev) {
                if(2 == this.readyState){
                    getTextInputs.forEach(function(inp){
                        inp.value = '';
                    });
                }
            }
        }catch (error) {}
    }

    


    function sendDataToPakatAddress(token, data, getTextInputs, listId){
        try {
            var e = new XMLHttpRequest;
            e.open("POST", 'https://api.pakat.net/v3/contacts', true),
            e.setRequestHeader("api-key",token),
            e.setRequestHeader("Content-type","application/json"),
            e.setRequestHeader("Accept","application/json"),
            e.send(JSON.stringify({email: data.data.email,attributes: data, listIds:[listId]}));
            e.onreadystatechange = function(ev){
                if(2 == this.readyState){
                    getTextInputs.forEach(function(inp){
                        inp.value = '';
                    });
                }
            }
        }catch (error) {}
    }
    

    function checkViewsCountHantana(){
        return new Promise(function (resolve, reject) {
            try {
                var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance 
                xmlhttp.open("POST", sitemapPrefixHantana + "checkViews", true);
                xmlhttp.timeout = 8000;
                xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                xmlhttp.send(JSON.stringify({ "siteToken": window._hantanaSettings.tId }));
                xmlhttp.onreadystatechange = function(e) {
                    if(4 == this.readyState){
                        if(isJson(xmlhttp.responseText)){
                            var response = JSON.parse(xmlhttp.responseText);
                            resolve(response);
                        }
                    }
                };
                xhr.ontimeout = function (e) {
                    resolve({status: false, timeout: true ,code:101});
                };
            }catch (error) {}
        });
    }


    //chack on page url change
    var curentHref = window.location.href, arrWorks = [];
    function OnPageUrlChanged(state) {
        var evt = document.createEvent("Event");
        evt.state = state;
        evt.initEvent("pageurlchanged", true, false);
        window.dispatchEvent(evt);
    }
    setInterval(function(){
        if(window.location.href != curentHref){
            curentHref = window.location.href;
            OnPageUrlChanged({change: true});
        }
    },100);
    window.addEventListener('pageurlchanged', function (e) {
        changeUrlPageInHantanaFunction();
    });

    //work on url change and once on load page
    function changeUrlPageInHantanaFunction(){
        
        if(previewSurveyFlag != 1 && previewFeedbackFlag != 1 && externalSurvey != 1){
            //sitemap start
            if(checkAccountUserResultHantana != 0){
                if(window._hantanaSettings.log){
                    console.log('sitemap', {url: window.location.href});   
                }
                siteMapRequestHantana();
            }

            if(checkAccountUserResultHantana != 0){
                checkHeatmapsInPageHantana().then(function(res){
                    if(window._hantanaSettings.log){
                        console.log('heatmap', res);
                    }
                    if(res.arrWorks != undefined){
                        arrWorks = res.arrWorks;
                        arrWorks.forEach(function (item, i) {
                            arrWorks[i].pageUnique = (Math.random().toString(36).substr(2, 9));
                            setTimeout(function () {
                                if (userAgentHantana() == "desktop" && !item.flagSetElemsDesktop) {
                                    console.log('new screenShot desktop')
                                    createHeatmapHantana(item.mainId);
                                }
                                if (userAgentHantana() == "tablet" && !item.flagSetElemsTablet) {
                                    console.log('new screenShot tablet')
                                    createHeatmapHantana(item.mainId);
                                }
                                if (userAgentHantana() == "mobile" && !item.flagSetElemsMobile) {
                                    console.log('new screenShot mobile')
                                    createHeatmapHantana(item.mainId);
                                }
                            },4000);
                        });
                    }
                });
            }
        
            checkFeedbacksInPageHantana().then(function(res){
                if(window._hantanaSettings.log){
                    console.log('feedback', res);
                }
                var element = document.getElementById('div_all_items_feedback_hantana_id');
                if(element){
                    element.parentNode.removeChild(element);
                }
                if(res.status && !localStorage.showFeedbackHantanaAfterUseFlag){
                    createFeedbackHantana(res);
                }
            });
            
            // checkSurveysInPageHantana().then(function(res){
                // console.log('poll', res);
                // var element = document.getElementById('div_main_hantana_survey_id');
                // if(element){
                //     element.parentNode.removeChild(element);
                // }
                // if(res.status && !localStorage.showPollsHantanaAfterUseFlag){
                //     createPollsHantana(res);
                // }
            // });

            if(checkAccountUserResultHantana != 0 && checkAccountUserResultHantana != 1 && checkAccountUserResultHantana != 2){
        
                checkPopUpInPageHantana().then(function(res){
                    if(window._hantanaSettings.log){
                        console.log('popup', res);
                    }
                    document.querySelectorAll('.all_items_popup_hantana').forEach(function(a){
                        a.remove();
                    });

                    if(res.data.length > 0){
                        checkViewsCountHantana().then(function(data){
                            
                            if(data.status){
                                viewsDataHantana = data;
                            }
                            if(data.timeout){
                                viewsDataHantana = { todayCounter: 500, SiteViewlimite: 10000, status: true };
                            }
                            res.data.forEach(function(item){
                                createPopUpHantana(item);
                                eval("window.Hantana.showPopupHantana" + item._id + " = function (data) { createPopUpHantana("+JSON.stringify(item)+", true); };");
                            });

                            onEndRequesAndInjectHantana('beforeDispatchPopup');
                            if(window._hantanaSettings.loadDispatchEvent){
                                onEndRequesAndInjectHantana('popupRequest');
                            }

                        });
                    }
                    
                   
                });

            }
       
            //new
            checkSurveysNewInPageHantana().then(function(res){
                if(window._hantanaSettings.log){
                    console.log('survey', res);
                }

                var element = document.getElementById('div_main_hantana_survey_id');
                if(element){
                    element.parentNode.removeChild(element);
                }
                
                if(res.status && res.workSurvey.length > 0){

                    var dataSurvey = res.workSurvey[0];
                    if(dataSurvey.untilShow == 1 && !findUntilSurveyList(dataSurvey._id, '1')){
                        createSurveysHantana(dataSurvey);
                    }else if(dataSurvey.untilShow == 2 && !findUntilSurveyList(dataSurvey._id, '2')){
                        createSurveysHantana(dataSurvey);
                    }else if(dataSurvey.untilShow == 3){
                        createSurveysHantana(dataSurvey);
                    }
                    
                }

                if(res.status && res.workSurveyAlert.length > 0){
                    var dataSurveyPopup = res.workSurveyAlert[0];  
                    

                    
        
                    if(!findUntilSurveyList(dataSurveyPopup._id, '3')){
                        createSurveysPopupHantana(dataSurveyPopup);
                    }
                   
                }
                

            });

            checkSubscribesInPageHantana().then(function(res){
                if(window._hantanaSettings.log){
                    console.log('subscribe', res);
                }
                var element = document.getElementById('div_main_hantana_newsletter1_id');
                if(element){
                    element.parentNode.removeChild(element);
                }
                if(res.status && !localStorage.showSubscribeHantanaAfterUseFlag){
                    createSubscribeHantana(res);
                }
            });


        }
        
        
    }
    changeUrlPageInHantanaFunction();

    // setTimeout(() => {
    //     window.history.pushState('page2', 'Title', '/page2.php');
    // }, 5000);

 
    //default start
    // var style_hantana_font = '<style>@font-face{font-family:hantanaVazir;src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir.eot);src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir.eot?#iefix) format("embedded-opentype"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir.woff2) format("woff2"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir.woff) format("woff"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir.ttf) format("truetype");font-weight:400}@font-face{font-family:hantanaVazir;src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Bold.eot);src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Bold.eot?#iefix) format("embedded-opentype"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Bold.woff2) format("woff2"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Bold.woff) format("woff"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Bold.ttf) format("truetype");font-weight:700}@font-face{font-family:hantanaVazir;src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Light.eot);src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Light.eot?#iefix) format("embedded-opentype"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Light.woff2) format("woff2"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Light.woff) format("woff"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Light.ttf) format("truetype");font-weight:300}@font-face{font-family:hantanaVazir;src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Medium.eot);src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Medium.eot?#iefix) format("embedded-opentype"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Medium.woff2) format("woff2"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Medium.woff) format("woff"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Medium.ttf) format("truetype");font-weight:500}@font-face{font-family:hantanaVazir;src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Thin.eot);src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Thin.eot?#iefix) format("embedded-opentype"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Thin.woff2) format("woff2"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Thin.woff) format("woff"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Thin.ttf) format("truetype");font-weight:100}@font-face{font-family:hantanaVazir;src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Black.eot);src:url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Black.eot?#iefix) format("embedded-opentype"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Black.woff2) format("woff2"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Black.woff) format("woff"), url(https://hantanafonts.s3.ir-thr-at1.arvanstorage.com/Vazir-Black.ttf) format("truetype");font-weight:900}</style>';
    var style_hantana_font = '<style>/* feedback1 */.animated_hantana {    -webkit-animation-duration: 1s;    animation-duration: 1s;    -webkit-animation-fill-mode: both;    animation-fill-mode: both}@-webkit-keyframes fadeIn_hantana {    from {        opacity: 0    }    to {        opacity: 1    }}@keyframes fadeIn_hantana {    from {        opacity: 0    }    to {        opacity: 1    }}@-webkit-keyframes pulse_hantana {    from {        -webkit-transform: scale3d(1, 1, 1) translateX(-50%) translateY(-50%);        transform: scale3d(1, 1, 1) translateX(-50%) translateY(-50%)    }    50% {        -webkit-transform: scale3d(1.05, 1.05, 1.05) translateX(-50%) translateY(-50%);        transform: scale3d(1.05, 1.05, 1.05) translateX(-50%) translateY(-50%)    }    to {        -webkit-transform: scale3d(1, 1, 1) translateX(-50%) translateY(-50%);        transform: scale3d(1, 1, 1) translateX(-50%) translateY(-50%)    }}@keyframes pulse_hantana {    from {        -webkit-transform: scale3d(1, 1, 1) translateX(-50%) translateY(-50%);        transform: scale3d(1, 1, 1) translateX(-50%) translateY(-50%)    }    50% {        -webkit-transform: scale3d(1.05, 1.05, 1.05) translateX(-50%) translateY(-50%);        transform: scale3d(1.05, 1.05, 1.05) translateX(-50%) translateY(-50%)    }    to {        -webkit-transform: scale3d(1, 1, 1) translateX(-50%) translateY(-50%);        transform: scale3d(1, 1, 1) translateX(-50%) translateY(-50%)    }}@keyframes hingeFlipIn_hantana {    0% {        opacity: 0;        transform: perspective(600px) rotateX(0);        transform-origin: center top;        animation-timing-function: cubic-bezier(0, .59, .375, 1)    }    50% {        transform: perspective(600px) rotateX(-10deg);        transform-origin: center top;        animation-timing-function: ease-in    }    100% {        opacity: 1;        transform: perspective(600px) rotateX(0);        transform-origin: center top;        animation-timing-function: ease-out    }}.hingeFlipIn_hantana_animate {    animation-name: hingeFlipIn_hantana}.pulse_hantana_animate {    -webkit-animation-name: pulse_hantana;    animation-name: pulse_hantana}.fadeIn_hantana_animate {    -webkit-animation-name: fadeIn_hantana;    animation-name: fadeIn_hantana}.div_hantana_open_feedback_float_right {    position: fixed !important;    width: 60px;    height: 60px;    cursor: pointer;    border-radius: 20px;    transition: .1s;    z-index: 2147483647;    text-align: center;    right: 20px;    bottom: 20px;    padding: 17px 10px 17px 10px !important;    min-height: 60px;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    direction: ltr;}.div_hantana_open_feedback_float_right:hover {    transition: .1s;    box-sizing: border-box !important;}.div_hantana_open_feedback_float_left {    position: fixed !important;    width: 60px;    height: 60px;    cursor: pointer;    border-radius: 20px;    transition: .1s;    z-index: 2147483647;    text-align: center;    left: 20px;    bottom: 20px;    padding: 17px 10px 17px 10px !important;    min-height: 60px;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    direction: ltr;}.div_hantana_open_feedback_float_left:hover {    transition: .1s;    box-sizing: border-box !important;}.div_hantana_open_feedback_right {    position: fixed !important;    width: 40px;    height: 135px;    cursor: pointer;    border-radius: 3px;    transition: .1s;    z-index: 2147483647;    top: 50vh;    text-align: center;    transform: translateX(-50%) translateY(-50%);    right: -19px;    margin-right: -4px !important;    padding: 17px 10px 17px 10px !important;    min-height: 70px;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    direction: ltr;}.div_hantana_open_feedback_right:hover {    margin-right: -2px !important;    transition: .1s;    box-sizing: border-box !important;}.img_hantana_main_feedback_logo_power_fa {    width: 69px;    vertical-align: middle;    margin: -1px 2px 0 0px;}.img_hantana_main_feedback_logo_power_en {    width: 69px;    vertical-align: middle;    margin: -1px 0 0 2px;}.div_hantana_open_feedback_left {    position: fixed !important;    height: 135px !important;    width: 40px !important;    cursor: pointer;    border-radius: 3px;    transition: .1s;    z-index: 2147483647;    top: 50vh;    text-align: center;    transform: translateX(-50%) translateY(-50%);    left: 16px;    margin-right: -4px !important;    padding: 17px 10px 17px 10px !important;    min-height: 70px;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_open_feedback_left:hover {    margin-left: 2px !important;    transition: .1s;    box-sizing: border-box !important}.div_hantana_open_text_feedback {    font-family:  hantanaVazir !important;    padding: 5px 0 !important;    writing-mode: vertical-rl;    font-size: 16px;    text-align: center;    min-height: 70px;    max-height: 78px;    box-sizing: border-box !important;    -webkit-transform: rotate(180deg);    -moz-transform: rotate(180deg);    -ms-transform: rotate(180deg);    -o-transform: rotate(180deg);    transform: rotate(180deg);    font-weight: 400 !important;    letter-spacing: -1px !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    word-break: normal !important;    word-wrap: normal !important;    white-space: nowrap !important;}.div_hantana_main_feedback_float_right {    position: fixed !important;    background: #fff;    color: #4d4d4d;    width: 320px;    border-radius: 15px !important;    transition: .1s;    z-index: 2147483647;    bottom: 105px;    text-align: center;    box-shadow: 0 6px 100px 0 rgba(0, 0, 0, .35) !important;    display: none;    right: 23px;    /* margin-right: -4px; */    padding: 5px 0 5px 0 !important;    box-sizing: border-box !important;    min-height: 210px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_feedback_float_left {    position: fixed !important;    background: #fff;    color: #4d4d4d;    width: 320px;    border-radius: 15px !important;    transition: .1s;    z-index: 2147483647;    bottom: 105px;    text-align: center;    box-shadow: 0 6px 100px 0 rgba(0, 0, 0, .35) !important;    display: none;    left: 23px;    /* margin-right: -4px; */    padding: 5px 0 5px 0 !important;    box-sizing: border-box !important;    min-height: 210px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_feedback_right {    position: fixed !important;    background: #fff;    color: #4d4d4d;    width: 320px;    border-radius: 15px !important;    transition: .1s;    z-index: 2147483647;    top: 50vh;    text-align: center;    box-shadow: 0 6px 100px 0 rgba(0, 0, 0, .35) !important;    display: none;    right: -125px;    margin-right: -4px;    padding: 5px 0 5px 0 !important;    box-sizing: border-box !important;    min-height: 210px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_feedback_left {    position: fixed !important;    background: #fff;    color: #4d4d4d;    width: 320px;    border-radius: 15px !important;    transition: .1s;    z-index: 2147483647;    top: 50vh;    text-align: center;    box-shadow: 0 6px 100px 0 rgba(0, 0, 0, .35) !important;    display: none;    left: 190px;    margin-right: -4px;    padding: 5px 0 5px 0 !important;    box-sizing: border-box !important;    min-height: 210px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_close_feedback {    background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4IiB2aWV3Qm94PSIwIDAgMzQ4LjMzMyAzNDguMzM0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzNDguMzMzIDM0OC4zMzQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIiBjbGFzcz0iIj48Zz48Zz4KCTxwYXRoIGQ9Ik0zMzYuNTU5LDY4LjYxMUwyMzEuMDE2LDE3NC4xNjVsMTA1LjU0MywxMDUuNTQ5YzE1LjY5OSwxNS43MDUsMTUuNjk5LDQxLjE0NSwwLDU2Ljg1ICAgYy03Ljg0NCw3Ljg0NC0xOC4xMjgsMTEuNzY5LTI4LjQwNywxMS43NjljLTEwLjI5NiwwLTIwLjU4MS0zLjkxOS0yOC40MTktMTEuNzY5TDE3NC4xNjcsMjMxLjAwM0w2OC42MDksMzM2LjU2MyAgIGMtNy44NDMsNy44NDQtMTguMTI4LDExLjc2OS0yOC40MTYsMTEuNzY5Yy0xMC4yODUsMC0yMC41NjMtMy45MTktMjguNDEzLTExLjc2OWMtMTUuNjk5LTE1LjY5OC0xNS42OTktNDEuMTM5LDAtNTYuODUgICBsMTA1LjU0LTEwNS41NDlMMTEuNzc0LDY4LjYxMWMtMTUuNjk5LTE1LjY5OS0xNS42OTktNDEuMTQ1LDAtNTYuODQ0YzE1LjY5Ni0xNS42ODcsNDEuMTI3LTE1LjY4Nyw1Ni44MjksMGwxMDUuNTYzLDEwNS41NTQgICBMMjc5LjcyMSwxMS43NjdjMTUuNzA1LTE1LjY4Nyw0MS4xMzktMTUuNjg3LDU2LjgzMiwwQzM1Mi4yNTgsMjcuNDY2LDM1Mi4yNTgsNTIuOTEyLDMzNi41NTksNjguNjExeiIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgY2xhc3M9ImFjdGl2ZS1wYXRoIiBkYXRhLW9sZF9jb2xvcj0iIzAwMDAwMCIgZmlsbD0iI0ZGRkZGRiIvPgo8L2c+PC9nPiA8L3N2Zz4K") !important;    width: 27px;    height: 27px;    background-size: 11px;    background-position: center center;    background-repeat: no-repeat;    border-radius: 50px !important;    position: absolute;    right: 17px;    top: -14px;    cursor: pointer;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.img_hantana_open_icon_feedback {    width: 20px;    cursor: pointer;    position: relative;    box-sizing: border-box !important;    margin-top: 4px;    margin-bottom: -4px}.img_hantana_open_icon_feedback_float {    width: 28px;    cursor: pointer;    position: relative;    box-sizing: border-box !important;    margin: -1px 0 0 0;    user-select: none;    display: inline-block !important;}.div_hantana_main_100_feedback {    width: 100%;    text-align: center;    white-space: nowrap;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    direction: ltr !important;}.div_hantana_main_50_feedback {    width: 50%;    text-align: center;    white-space: nowrap;    display: block;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_power_btn_main_1{    display: flex !important;    padding: 0 0 5px 0px !important;    margin: 0 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    direction: ltr !important;}.img_hantana_main_feedback_1 {    width: 52px;    cursor: pointer !important;    padding: 8px 5px !important;    position: relative;    box-sizing: border-box !important;    margin: 0 auto !important;}.div_img_main_hantana {    display: inline-block;    width: 52px !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    height: auto;    overflow: auto;}.div_img_main_hantana:after {    content: "";    width: 0;    height: 0;    border-left: 7px solid transparent;    border-right: 7px solid transparent;    border-bottom: 9px solid #fff;    clear: both;    margin-right: auto;    margin-left: auto;    display: block;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_img_main_hantana.show-after:after {    border-bottom: 9px solid #eee;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_hantana_main_feedback_1 {    font-family: hantanaVazir !important;    letter-spacing: 0 !important;    margin: 16px 0 !important;    padding: 20px 15px 0 15px !important;    box-sizing: border-box !important;    font-size: 16px !important;    font-weight: 400;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    text-align: center !important;    transform-origin: initial !important;    color: #111 !important;}.p_hantana_main_feedback_2 {    font-family: hantanaVazir !important;    font-size: 12px!important;    font-weight: 100 !important;    text-align: left !important;    letter-spacing: 0 !important;    padding: 15px 20px 10px 30px !important;    margin: 8px 0px 6px 0px !important;    box-sizing: border-box!important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    display: flex;    direction: ltr;}.textArea_hantana_main_feedback_1 {    font-family: hantanaVazir !important;    width: 100% !important;    border: 0 !important;    background: #eee !important;    resize: none !important;    border-radius: 0;    padding: 10px 13px !important;    font-size: 13px !important;    height: 105px !important;    min-height: 105px !important;    margin: 0px !important;    color: #313131 !important;    margin-left: 0 !important;    box-sizing: border-box !important;    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1) !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    font-weight: 400 !important;    border-radius: 0 !important;}.textArea_hantana_main_feedback_1::-webkit-scrollbar {    width: 6px;}.textArea_hantana_main_feedback_1::-webkit-scrollbar-thumb:hover {    background: #555;    cursor: pointer;}.textArea_hantana_main_feedback_1::placeholder {    color: #888888;    opacity: 1;}.textArea_hantana_main_feedback_1:-ms-input-placeholder {    color: #888888;}.textArea_hantana_main_feedback_1::-ms-input-placeholder {    color: #888888;}#textArea_hantana_main_feedback_id {    display: none;    box-sizing: border-box !important;}.btn_hantana_main_feedback {    font-family: hantanaVazir !important;    background: #eee;    border: 0;    color: #4d4d4d;    padding: 3px 23px 0px 23px !important;    font-weight: 100 !important;    border-radius: 4px !important;    cursor: auto;    float: right;    display: none;    margin: 16px 25px 10px 0 !important;    box-shadow: none !important;    height: 34px !important;    font-size: 13px !important;    box-sizing: revert !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-decoration: none !important;}.text_right_hantana {    text-align: right;    box-sizing: border-box !important;    width: 40%;}.text_left_hantana {    text-align: right;    box-sizing: border-box !important;    width: 60%;}.span_main_hantana {    font-family: hantanaVazir !important;    text-decoration: underline !important;    font-weight: 400;    text-decoration-color: #969696 !important;    color: #4d4d4d}.after_send_hantana_main_feedback_float_right {    position: fixed !important;    width: 153px;    z-index: 2147483647;    bottom: 22px;    text-align: center;    /* transform: translateX(-50%) translateY(-50%); */    right: 99px;    padding: 10px !important;    box-sizing: border-box !important;    -webkit-box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    -moz-box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    color: #4d4d4d;    border-radius: 6px;    background: #fff;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.after_send_hantana_main_feedback_float_right:after {    content: "";    width: 0;    height: 0;    border-left: 9px solid #fff;    clear: both;    display: block;    box-sizing: border-box !important;    border-bottom: 7px solid transparent;    border-top: 7px solid transparent;    float: right;    position: absolute;    top: auto;    bottom: 21px;    margin: auto -19px auto 0;    right: 10px}.after_send_hantana_main_feedback_right {    position: fixed !important;    width: 153px;    z-index: 2147483647;    top: 50vh;    text-align: center;    transform: translateX(-50%) translateY(-50%);    right: -25px;    padding: 10px !important;    box-sizing: border-box !important;    -webkit-box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    -moz-box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    color: #4d4d4d;    border-radius: 6px;    background: #fff;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.after_send_hantana_main_feedback_right:after {    content: "";    width: 0;    height: 0;    border-left: 9px solid #fff;    clear: both;    display: block;    box-sizing: border-box !important;    border-bottom: 7px solid transparent;    border-top: 7px solid transparent;    float: right;    position: absolute;    top: 0;    bottom: 0;    margin: auto -19px auto 0;    right: 10px}.after_send_hantana_main_feedback_float_left {    position: fixed !important;    width: 153px !important;    z-index: 2147483647;    bottom: 22px;    text-align: center;    /* transform: translateX(-50%) translateY(-50%); */    left: 99px;    padding: 10px !important;    box-sizing: border-box !important;    -webkit-box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    -moz-box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    color: #4d4d4d;    border-radius: 6px;    background: #fff;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.after_send_hantana_main_feedback_float_left:after {    content: "";    width: 0;    height: 0;    border-right: 9px solid #fff;    clear: both;    display: block;    box-sizing: border-box !important;    border-bottom: 7px solid transparent;    border-top: 7px solid transparent;    float: left;    position: absolute;    top: auto;    bottom: 21px;    margin: auto -19px auto 0;    left: -9px}.after_send_hantana_main_feedback_left {    position: fixed !important;    width: 153px !important;    z-index: 2147483647;    top: 50vh;    text-align: center;    transform: translateX(-50%) translateY(-50%);    left: 130px;    padding: 10px !important;    box-sizing: border-box !important;    -webkit-box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    -moz-box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    color: #4d4d4d;    border-radius: 6px;    background: #fff;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.after_send_hantana_main_feedback_left:after {    content: "";    width: 0;    height: 0;    border-right: 9px solid #fff;    clear: both;    display: block;    box-sizing: border-box !important;    border-bottom: 7px solid transparent;    border-top: 7px solid transparent;    float: left;    position: absolute;    top: 0;    bottom: 0;    margin: auto -19px auto 0;    left: -9px}.after_text_hantana_main_feedback {    font-family: hantanaVazir !important;    font-size: 12px;    line-height: 17px;    font-weight: 500;    text-align: center;    position: relative;    margin: 1px 0 0 0 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    color: #111 !important;}.after_hantana_main_close_feedback {    background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB2aWV3Qm94PSIwIDAgMzQ4LjMzMyAzNDguMzM0IiB4bWxuczp2PSJodHRwczovL3ZlY3RhLmlvL25hbm8iPjxwYXRoIGQ9Ik0zMzYuNTYgNjguNjFMMjMxLjAxNiAxNzQuMTY1bDEwNS41NDMgMTA1LjU1YzE1LjcgMTUuNzA1IDE1LjcgNDEuMTQ1IDAgNTYuODUtNy44NDQgNy44NDQtMTguMTI4IDExLjc3LTI4LjQwNyAxMS43Ny0xMC4yOTYgMC0yMC41OC0zLjkyLTI4LjQyLTExLjc3bC0xMDUuNTY2LTEwNS41Nkw2OC42MSAzMzYuNTYzYy03Ljg0MyA3Ljg0NC0xOC4xMjggMTEuNzctMjguNDE2IDExLjc3cy0yMC41NjMtMy45Mi0yOC40MTMtMTEuNzdjLTE1LjctMTUuNjk4LTE1LjctNDEuMTQgMC01Ni44NWwxMDUuNTQtMTA1LjU1TDExLjc3NCA2OC42MWMtMTUuNy0xNS43LTE1LjctNDEuMTQ1IDAtNTYuODQ0QzI3LjQ3LTMuOTIgNTIuOS0zLjkyIDY4LjYwMyAxMS43NjdMMTc0LjE2NiAxMTcuMzIgMjc5LjcyIDExLjc2N2MxNS43MDUtMTUuNjg3IDQxLjE0LTE1LjY4NyA1Ni44MzIgMCAxNS43MDUgMTUuNyAxNS43MDUgNDEuMTQ1LjAwNiA1Ni44NDR6IiBmaWxsPSIjZmZmIi8+PC9zdmc+") !important;    /* background-image: url(https://hantana.org/widgets/img/delete.svg) !important; */    width: 20px;    height: 20px;    background-size: 8px;    background-position: center center;    background-repeat: no-repeat;    border-radius: 50px;    position: absolute;    right: -10px;    top: -10px;    cursor: pointer;    box-sizing: border-box !important;    display: none;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}#div_add_after_send_into_hantana {    box-sizing: border-box !important;    display: none;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_all_items_feedback_hantana {    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.label_under_images_hantana {    font-family: hantanaVazir !important;    font-weight: 500 !important;    font-size: 12px !important;    padding: 0 !important;    margin: 0 !important;    line-height: 5px !important;    text-align: center !important;    position: absolute !important;    width: 53px;    display: none;}.des_text_show_hantana{    font-family: hantanaVazir !important;    letter-spacing: 0 !important;    margin: 0px !important;    padding: 12px 15px 0 15px !important;    box-sizing: border-box !important;    font-size: 13px !important;    font-weight: 100;    white-space: normal;    text-align: center !important;    color: #111 !important;}.hantana_div_screenShot_feedback{    /* display: none; */    float: left !important;    margin-top: -47px !important;    margin-left: 13px !important;    position: absolute !important;}[data-hantana-cursor-pointer], [data-hantana-cursor-pointer] * {    cursor:pointer !important;    user-select: none;}.hantana_img_screenShot_feedback{    width: 25px;    opacity: 0.6;    margin-top: 10px;    cursor: pointer;    user-select: none;    user-drag: none;    user-select: none;    -moz-user-select: none;    -webkit-user-drag: none;    -webkit-user-select: none;    -ms-user-select: none;}.hantana_img_screenShot_feedback:hover{    opacity: 1 !important;}.hantana_tooltip_screenShot{    font-family: hantanaVazir;    font-size: 11px;    position: absolute;    background: #222;     border-radius: 5px;    color: #fff;    padding: 7px 8px;    left: 38px;    top: 6px;    display: none;}.hantana_tooltip_screenShot:after{    content: "";    border-top: 8px solid transparent;    border-right: 10px solid #222;    border-bottom: 10px solid transparent;    background-color: transparent;    position: absolute;    left: -9px;    top: 6px;}.darkDivScreenShotMainTop{    width: 320px !important;    margin: 0 auto !important;    color: #fff;    height: 44px;    border-radius: 0 0 40px 40px;    text-align: center;    padding-top: 2px !important;    position: fixed !important;    right: 0;    left: 0;    top: 3px;    z-index: 2147483647;}.darkDivScreenShotMain{    z-index: 2147483647;    position: fixed !important;    top: 0;    left: 0;    height: auto !important;    width: 100%;    background: transparent;}.divScreenShotTop{    display: inline-block;    vertical-align: middle;    height: 35px;    cursor: pointer;}.pScreenShotTop{    display: inline-block;    vertical-align: middle;    font-family: hantanaVazir !important;    font-size: 13px;    padding: 0 !important;    margin: 0 !important;} /* survey */.animated_hantana {    -webkit-animation-duration: 1s;    animation-duration: 1s;    -webkit-animation-fill-mode: both;    animation-fill-mode: both;}.hingeFlipIn_hantana_animate {    animation-name: hingeFlipIn_hantana;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.pulse_hantana_animate {    -webkit-animation-name: pulse_hantana;    animation-name: pulse_hantana;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.fadeIn_hantana_animate {    -webkit-animation-name: fadeIn_hantana;    animation-name: fadeIn_hantana;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_main_hantana_survey{    position: fixed !important;    border-bottom: 0;    width: 329px;    /*display: none;*/    /* box-shadow: 0 100px 100px 0 rgba(0,0,0,.35) !important; */    box-shadow: 0 25px 100px 0 rgba(0,0,0,.35) !important;    z-index: 2147483647;    padding: 0 !important;    border-radius: 4px 4px 0 0;    box-sizing: border-box !important;    white-space: nowrap;    margin: 0 auto !important;    color: #fff;    bottom: -560px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    direction: ltr !important;    /*overflow-y: scroll;*/    /*max-height: 450px;*/}.div_main_hantana_survey_1{    overflow-y: auto;    max-height: 450px;    padding: 8px 0 0 0 !important;    -webkit-overflow-scrolling: touch;    overscroll-behavior: contain;    scrollbar-width: thin;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_main_hantana_survey_1::-webkit-scrollbar-track{    background-color: #58626C;}.div_main_hantana_survey_1::-webkit-scrollbar {    width: 6px;    background-color: #58626C;}.div_main_hantana_survey_1::-webkit-scrollbar-thumb {    background-color: #707D8C;}.div_main_hantana_survey_open{    position: absolute !important;    height: 39px;    margin: 0 auto !important;    top: -38px;    font-size: 16px;    padding: 0 21px 0 21px !important;    border-radius: 4px 4px 0 0;    cursor: pointer;    min-width: 118px;    box-sizing: border-box !important;    text-align: center;    display: flex !important;    align-items: center !important;    justify-content: center !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    direction: ltr !important;}.div_main_hantana_survey_open_min{    font-family: hantanaVazir !important;    position: absolute !important;    height: 26px !important;    margin: 0 auto !important;    top: -26px;    font-size: 16px !important;    color: #fff;    padding: 2px 21px 0 21px !important;    border-radius: 4px 4px 0 0 !important;    cursor: pointer;    width: 65px !important;    text-align: center !important;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    display: flex !important;    flex-direction: column !important;    justify-content: center !important;    align-items: center !important;}.div_main_hantana_survey_open_min p{    display: none !important;}.div_main_hantana_survey_open_min img{    margin-left: 0px !important;}.img_hantana_main_survey_2{    width: 15px;    height: 15px;    box-sizing: border-box !important;    transition: all 0.3s ease;    vertical-align: middle;    margin-left: 7px !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    line-height: 0 !important;}.p_hantana_main_open_1{    font-family: hantanaVazir !important;    text-align: center;    color: #fff;    margin: 0 !important;    padding: 0 !important;    vertical-align: middle;    font-size: 14px;    display: inline-block;    font-weight: 400;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -webkit-transform-origin: initial !important;}.p_hantana_main_survey_1{    font-family: hantanaVazir !important;    text-align: center;    color: #fff;    font-size: 15px;    line-height: 24px;    box-sizing: border-box !important;    white-space: normal;    padding: 0 20px;    margin: 0 !important;    -webkit-text-size-adjust: none;    -ms-text-size-adjust: none;    -moz-text-size-adjust: none;    font-weight: 400;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_survey_1{    padding: 10px 0 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_100_survey{    width: 100%;    text-align: center;    white-space: nowrap;    box-sizing: border-box !important;    scrollbar-width: thin;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_100_survey_2{    width: 100%;    text-align: center;    white-space: nowrap;    box-sizing: border-box !important;    scrollbar-width: thin;    display: flex;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_100_survey_1{    width: 100%;    text-align: center;    box-sizing: border-box !important;    display: flex;    /* border-bottom: 1px solid #656E77; */    padding: 13px 5px !important;    cursor: pointer;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_hantana_main_survey_2{    font-family: hantanaVazir !important;    font-size: 12px !important;    font-weight: 100;    text-align: left;    box-sizing: border-box !important;    color: #FFFFFF;    padding: 22px 0px 0px 5px !important;    margin: 0 !important;    -webkit-text-size-adjust: none;    -ms-text-size-adjust: none;    -moz-text-size-adjust: none;    line-height: normal;    letter-spacing: 0.2px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    display: flex;    direction: ltr;}.span_main_hantana2{    text-decoration:underline !important;    text-decoration-color: #969696 !important;    color: #FFFFFF;    -webkit-text-size-adjust: none;    -ms-text-size-adjust: none;    -moz-text-size-adjust: none;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_50_survey{    width: 50%;    text-align: center;    white-space: nowrap;    display: block;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.text_right_hantana2{    text-align: right;    box-sizing: border-box !important;    -webkit-text-size-adjust: none;    -ms-text-size-adjust: none;    -moz-text-size-adjust: none;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    width: 50%;}.text_left_hantana2{    text-align: right;    box-sizing: border-box !important;    -webkit-text-size-adjust: none;    -ms-text-size-adjust: none;    -moz-text-size-adjust: none;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    width: 50%;}.btn_hantana_main_survey{    font-family: hantanaVazir !important;    font-size: 14px !important;    border: 0;    /* color: #000000; */    padding: 8px 16px !important;    font-weight: 100 !important;    border-radius: 4px;    cursor: auto;    float: right;    margin: 14px 7px 0 0 !important;    height: 34px !important;    line-height: 0 !important;    box-sizing: revert !important;    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.15);    opacity: 1 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-decoration: none !important;}.hantana_button_question_survey_skip{    font-family: hantanaVazir !important;    font-size: 14px !important;    border: 0;    color: #FFFFFF;    padding: 8px 2px !important;    font-weight: 100 !important;    border-radius: 0;    cursor: pointer;    float: right;    margin: 14px 12px 0 0 !important;    height: 34px !important;    line-height: 0 !important;    box-sizing: revert !important;    box-shadow: none;    opacity: 1 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-decoration: none !important;    background: transparent;}.div_hantana_main_after_send_survey{    position: absolute;    width: 100%;    height: 100%;    top: 0;    left: 0;    border-radius: 4px 4px 0 0;    display: flex;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_hantana_main_survey_3{    font-family: hantanaVazir !important;    white-space: normal;    text-align: center;    padding: 10px 20px;    color: #fff;    margin: 0 !important;    line-height: 25px;    align-self: center;    -webkit-text-size-adjust: none;    -ms-text-size-adjust: none;    -moz-text-size-adjust: none;    width: 100%;    font-weight: 500;    font-size: 15px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_padding_right_left_15_main_survey{    padding: 0 10px !important;    height: 60px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_20_survey{    width: 20%;    text-align: center;    display: flex;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_survey_inner_1{    align-self: center;    margin: 0 auto !important;    position: relative;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_survey_inner_2{    align-self: center;    position: relative;    width: 100%;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_80_survey{    width: 80%;    text-align: center;    white-space: nowrap;    /* display: flex; */    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.textarea_comment_survey_hantana{    font-family: hantanaVazir !important;    background: #fff !important;    color: #4d4d4d !important;    width: 100% !important;    border: 0;    font-size: 12px !important;    padding: 4px 6px 0px 6px !important;    box-sizing: border-box !important;    border-radius: 5px !important;    margin: 2px 0 4px 0 !important;    direction: ltr;    height: 51px !important;    font-weight: 500 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-align: left !important;    resize: none;    display: none;}.div_check_main_hantana_div_1{    height: 25px;    width: 25px;    border: 1px solid #c8c8c8;    border-radius: 25px;    margin: 0 auto !important;    text-align: center;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_check_box_main_hantana_div{    height: 25px;    width: 25px;    border: 1px solid #c8c8c8;    border-radius: 5px;    margin: 0 auto !important;    text-align: center;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_hantana_main_survey_4{    font-family: hantanaVazir !important;    white-space: normal;    text-align: left;    font-weight: 100;    font-size: 14px;    margin: 2px 10px 0 10px !important;    color: #DDE5EC;    line-height: normal;    letter-spacing: normal;    user-select: none;    -webkit-text-size-adjust: none;    -ms-text-size-adjust: none;    -moz-text-size-adjust: none;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.img_check_main_hantana_img_1{    width: 14px;    margin: 6px auto 0 auto !important;    display: none;    user-select: none;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_welcome_main_hantana_1{    font-family: hantanaVazir !important;    position: absolute !important;    background: #FFFFFF;    width: 153px;    margin: auto !important;    top: -40px;    left: 50%;    transform: translate(-50%, -50%);    white-space: normal;    font-size: 12px !important;    padding: 7px 14px !important;    font-weight: 500;    border-radius: 4px;    display: none;    box-shadow: 0 2px 18px 0 rgba(0, 0, 0, .3);    color: #4d4d4d;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    line-height: 18px !important;}.p_welcome_main_hantana_1::after{    content: "";    width: 0;    height: 0;    border-top: 9px solid #FFFFFF;    clear: both;    display: block;    box-sizing: border-box !important;    border-right: 9px solid transparent;    border-left: 9px solid transparent;    position: absolute;    right: 0;    left: 0;    margin: auto;    bottom: -8px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.img_hantana_main_survey_logo_power_fa {    width: 69px;    vertical-align: middle;    margin: -1px 2px 0 0px !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.img_hantana_main_survey_logo_power_en {    width: 69px;    vertical-align: middle;    margin: -1px 0 0 2px !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.hantana_email_inp_survey {    font-family: hantanaVazir !important;    background: #fff !important;    color: #4d4d4d !important;    width: 100% !important;    border: 0 !important;    font-size: 14px !important;    padding: 10px 10px 7px 10px !important;    box-sizing: border-box !important;    border-radius: 5px !important;    margin: 0 0 5px 0 !important;    direction: ltr;    height: 42px !important;    font-weight: 500 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-align: left !important;}.hantana_email_div_question_survey{    padding: 5px 15px !important;}.hantana_email_inp_survey::-webkit-input-placeholder {    text-align: right;}.hantana_email_inp_survey:-moz-placeholder {    text-align: right;}.hantana_email_inp_survey::-moz-placeholder {    text-align: right;}.hantana_email_inp_survey:-ms-input-placeholder {    text-align: right;}.hantana_email_inp_survey {    direction: rtl !important;}.hantana_email_inp_survey::placeholder {    text-align: right;}/* newsletter1 */.animated_hantana {    -webkit-animation-duration: 1s;    animation-duration: 1s;    -webkit-animation-fill-mode: both;    animation-fill-mode: both;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.hingeFlipIn_hantana_animate {    animation-name: hingeFlipIn_hantana;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.pulse_hantana_animate {    -webkit-animation-name: pulse_hantana;    animation-name: pulse_hantana;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.fadeIn_hantana_animate {    -webkit-animation-name: fadeIn_hantana;    animation-name: fadeIn_hantana;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_all_main_newsletter1{    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_main_hantana_newsletter1{    font-family: hantanaVazir !important;    position: fixed !important;    border-bottom: 0;    width: 360px;    bottom: -500px;    box-shadow: 0 100px 100px 0 rgba(0,0,0,.35) !important;    padding: 0 15px !important;    z-index: 2147483647;    border-radius: 4px 4px 0 0;    box-sizing: border-box !important;    white-space: nowrap;    margin: 0 auto;    /*max-height: 230px;*/    display: none;    justify-content:center;    align-items:center;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_main_hantana_newsletter1_open{    font-family: hantanaVazir !important;    position: absolute !important;    height: 26px !important;    margin: 0 auto !important;    top: -26px;    font-size: 16px !important;    color:#fff;    padding: 2px 21px 0 21px !important;    border-radius: 4px 4px 0 0 !important;    cursor: pointer;    width: 65px !important;    text-align: center !important;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    display: flex !important;    flex-direction: column !important;    justify-content: center !important;    align-items: center !important;}.img_hantana_main_newsletter_2{    width: 15px;    box-sizing: border-box !important;    transition: all 0.3s ease;    vertical-align: middle;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_hantana_main_newsletter1_1{    font-family: hantanaVazir !important;    text-align: center;    color: #fff;    font-size: 15px;    line-height: 24px;    white-space: normal;    margin: 15px 10px !important;    font-weight: 500;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.input_hantana_main_newsletter1_1{    font-family: hantanaVazir !important;    background: #fff !important;    color: #4d4d4d !important;    width: 100% !important;    border: 0 !important;    font-size: 14px !important;    padding: 10px 10px 7px 10px !important;    box-sizing: border-box !important;    border-radius: 5px !important;    margin: 0 0 5px 0 !important;    direction: ltr;    height: 42px !important;    font-weight: 500 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-align: left !important;}.input_hantana_main_newsletter1_1::placeholder {    color: #888888;    opacity: 1;}.input_hantana_main_newsletter1_1:-ms-input-placeholder {    color: #888888;}.input_hantana_main_newsletter1_1::-ms-input-placeholder {    color: #888888;}.input_hantana_main_newsletter1_1:focus{    text-align: left !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.img_hantana_main_newsletter1_logo_power_fa {    width: 69px;    vertical-align: middle;    margin: -1px 2px 0 0px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.img_hantana_main_newsletter1_logo_power_en {    width: 69px;    vertical-align: middle;    margin: -1px 0 0 2px;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_100_newsletter1{    width: 100%;    text-align: center;    white-space: nowrap;    box-sizing: border-box !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_hantana_main_newsletter1_2{    font-family: hantanaVazir !important;    font-size: 12px !important;    font-weight: 100;    text-align: left !important;    padding: 16px 20px 10px 8px !important;    box-sizing: border-box !important;    color: #FFFFFF !important;    margin: 8px 0 0 0 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    display: flex !important;    direction: ltr !important;    line-height: normal;    letter-spacing: 0.2px;}.span_main_hantana2{    text-decoration:underline !important;    text-decoration-color: #969696 !important;    color: #FFFFFF;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.div_hantana_main_flex_newsletter1{    display: flex !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    direction: ltr !important;}.div_hantana_main_50_newsletter1{    width: 50%;    text-align: center;    white-space: nowrap;    display: block;     -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.text_right_hantana2_newsletter1{    text-align: right;    box-sizing: border-box !important;     -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    width: 40%;}.text_left_hantana2_newsletter1{    text-align: right;    box-sizing: border-box !important;     -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    width: 60%;}.btn_hantana_main_newsletter1{    font-family: hantanaVazir !important;    background: #5E5E5E !important;    border: 0 !important;    color: #FFFFFF !important;    padding: 10px 23px 6px 23px !important;    font-weight: 100 !important;    border-radius: 4px;    float: right !important;    margin: 12px 14px 0 0 !important;    height: 38px !important;    box-sizing: revert !important;    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.15) !important;    font-size: 14px !important;    cursor: not-allowed;    opacity: 0.5;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-decoration: none !important;}.div_hantana_main_after_send_newsletter1{    position: absolute;    width: 100%;    height: 100%;    top: 0;    left: 0;    border-radius: 4px 4px 0 0;    display: none;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_hantana_main_newsletter1_3{    font-family: hantanaVazir !important;    white-space: normal;    text-align: center;    padding: 10px 20px;    color: #fff;    line-height: 25px;    margin: 15px 5px 15px 5px;    font-weight: bold;    font-size: 16px;    letter-spacing: normal;    align-self: center;    width: 100%;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.p_hantana_main_newsletter1_1{    font-family: hantanaVazir !important;    text-align: center;    color: #fff;    font-size: 15px;    line-height: 24px;    white-space: normal;    margin: 15px 10px !important;    font-weight: 500;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.input_hantana_main_text_survey{    font-family: hantanaVazir !important;    background: #fff !important;    color: #4d4d4d !important;    width: 100% !important;    border: 0;    font-size: 14px !important;    padding: 10px 10px 7px 10px !important;    box-sizing: border-box !important;    border-radius: 5px !important;    margin: 0 0 5px 0 !important;    direction: ltr;    height: 42px !important;    font-weight: 500 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-align: left !important;}.input_hantana_main_text_survey::placeholder {    color: #888888;    opacity: 1;}.input_hantana_main_text_survey:-ms-input-placeholder {    color: #888888;}.input_hantana_main_text_survey::-ms-input-placeholder {    color: #888888;}.input_hantana_main_text_survey:focus{    text-align: left !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.input_hantana_main_long_text_survey{    font-family: hantanaVazir !important;    background: #fff !important;    color: #4d4d4d !important;    width: 100% !important;    border: 0;    font-size: 14px !important;    padding: 10px 10px 7px 10px !important;    box-sizing: border-box !important;    border-radius: 5px !important;    margin: 0 0 5px 0 !important;    direction: ltr;    height: 115px !important;    font-weight: 500 !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;    text-align: left !important;    resize: none;}.input_hantana_main_long_text_survey::placeholder {    color: #888888;    opacity: 1;}.input_hantana_main_long_text_survey:-ms-input-placeholder {    color: #888888;}.input_hantana_main_long_text_survey::-ms-input-placeholder {    color: #888888;}.input_hantana_main_long_text_survey:focus{    text-align: left !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.row_main_100_rate_survey{    display: flex;    width: 100%;    text-align: center;    white-space: nowrap;    box-sizing: border-box !important;}.col_rate_survey_hantana{    font-family: hantanaVazir !important;    margin: 0 3px;    flex: 1;    color: #fff;    font-weight: normal;    font-size: 14px;    padding: 19px 0 17px 0 !important;    border-radius: 4px;    /* border-radius: 4px 4px 40px 40px; */    cursor: pointer;    -webkit-user-select: none;    -moz-user-select: none;    -ms-user-select: none;    user-select: none;    box-sizing: border-box;    line-height: 0 !important;    cursor: pointer;}.col_rate_survey_hantana:hover{    opacity: 0.7;}.text_rate_left_hantana{    flex: 1;    text-align: left;    padding: 5px 4px;    text-overflow: ellipsis;    white-space: nowrap;    overflow: hidden;    font-size: 13px !important;    font-family: hantanaVazir !important;    user-select: none;}.text_rate_right_hantana{    flex: 1;    text-align: right;    padding: 5px 4px;    text-overflow: ellipsis;    white-space: nowrap;    overflow: hidden;    font-size: 13px !important;    font-family: hantanaVazir !important;    user-select: none;}.message_tag_survey{    font-family: hantanaVazir !important;    font-size: 15px;    padding: 8px !important;    margin: 0 0 5px 0 !important;    white-space: normal !important;    text-align: center !important;    white-space: pre-wrap !important;}.thankYou_message_text{    font-family: hantanaVazir !important;    font-size: 12px;    padding: 8px !important;    margin: 0 0 5px 0 !important;    white-space: normal !important;    text-align: center !important;    font-weight: 100;}.accept_deny_btn_thankyou{    font-family: hantanaVazir !important;    border: 0;    border-radius: 5px;    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.15) !important;    padding: 4px 15px;    margin: 5px;    width: 60px;    text-align: center;    vertical-align: middle;    height: 38px;    cursor: pointer;}.deny_btn_thankyou{    width: 27px;height: 27px;margin: 0px auto;}.accept_btn_thankyou{    width: 31px;height: 31px;margin: 0 auto;}.hantana_main_thankyou_box_1{    margin: 0 auto;    /* background: #759185; */    /* background:rgba(223, 223, 223, 0.2); */    width: 85%;    border-radius: 3px;    display: inline-block;    margin-bottom: 12px;    padding-bottom: 20px;}.hantana_p_thankyou_box_1{    color: #333;    direction: rtl;    font-family: hantanaVazir !important;    font-size: 15px;    display: block;    margin: 18px 0 8px 0;    padding: 0 10px !important;}.hantana_btn_thankyou_box_1{    background: #3c3c3c !important;    box-shadow: 0 2px 3px 0 rgba(0,0,0,0.15);    border-radius: 3px;    border: 0;    color: #fff;    font-family: hantanaVazir !important;    font-size: 13px;    padding: 7px 35px;    cursor: pointer;    display: inline-block;    margin: 5px auto 3px auto !important;}.hantana_btn_thankyou_box_1:hover{    background: #000;}.hantana_img_thankyou_box_1{    user-select: none;    display: block;    margin: 7px auto 0 auto;}.hantana_a_thankyou_box_1{    text-decoration: none !important;    color: #fff !important;}.hantana_img_powred_external_1{    vertical-align: middle;    margin: -6px 2px 0 0px !important;    -moz-transform-origin: initial !important;    -webkit-transform-origin: initial !important;    -o-transform-origin: initial !important;    -ms-transform-origin: initial !important;    transform-origin: initial !important;}.hantana-animate-right {	position: relative;	animation: animaterighthantana 0.4s}/* popup */.hantana_main_div_survey_popup{    position: fixed !important;    z-index: 2147483648;    width: 100%;    height: 100%;    background: rgba(0, 0, 0, 0.8);    left: 0;    top: 0;    bottom: 0;    right: 0;    display: flex !important;    flex-direction: row !important;    flex-wrap: wrap !important;    justify-content: center !important;    align-items: center !important;    transition: opacity 0.5s;}.hantana_box_div_survey_popup{    width: 550px;    padding: 16px 20px 5px 20px !important;    text-align: center;    background: #fff;    border-radius: 6px;    -moz-border-radius: 6px;    -webkit-border-radius: 6px;    box-shadow: 0 3px 24px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.24);    max-height: 375px;    overflow: auto;}.hantana_box_close_img_div_survey_popup{    cursor: pointer;    user-select: none;}.hantana_box_100_div_survey_popup{    width: 100%;}.hantana_box_p1_div_survey_popup{    min-height: 45px;    width: 100%;    text-align: center;    padding: 5px 10px !important;    font-size: 24px;    color: #242424;    overflow: hidden;    direction: rtl;    margin-top: 58px !important;    font-family: hantanaVazir;}.hantana_box_p2_div_survey_popup{    min-height: 36px;    width: 100%;    text-align: center;    padding: 5px 10px !important;    font-size: 16px;    color: #666;    overflow: hidden;    direction: rtl;    margin-top: 17px !important;}.hantana_box_p3_div_survey_popup{    text-align: center;    margin-top: 3px !important;    direction: rtl;    font-size: 14px;    padding: 8px !important;    cursor: pointer;    user-select: none;}.hantana_box_p4_div_survey_popup{    text-align: center;    font-size: 11px;    padding: 8px !important;    direction: ltr;    float: left;    margin: 10px 0 13px 5px !important;}.hantana_box_btn_div_survey_popup{    box-shadow: rgba(0, 0, 0, 0.24) 0px 1px 2px, rgba(0, 0, 0, 0.12) 0px 1px 3px;    font-size: 18px;    font-weight: 700;    display: inline-block;    vertical-align: top;    background: rgb(66, 202, 73) none repeat scroll 0% 0%;    color: rgb(255, 255, 255);    border: 0px none;    text-align: center;    direction: rtl;    padding: 12px 65px !important;    margin-top: 24px !important;    cursor: pointer;    font-family: hantanaVazir !important;    border-radius: 4px;    user-select: none;    margin-bottom: 0 !important;}.hantana-survey-media-1{    width: 100%;    border-radius: 7px;    margin-top: 5px;}.hantana-linkify{    background: #337ab7;    color: #fff;    border-radius: 4px;    padding: 2px 7px 1px 7px;    font-size: 12px;    cursor: pointer !important;    font-family: hantanaVazir !important;}.hantana-linkify:hover{    background: #337ab7;    color: #fff;    text-decoration: none !important;}.mainIframeDiv{    width: 100%;    height: 100%;    position: fixed;    top: 0;    left: 0;    background: rgba(0,0,0,0.5);    z-index: 2147483647;}.iframeDiv{    position: fixed;    top: 0;    left: 0;    transform: translate(calc(50vw - 50%), calc(50vh - 50%));    width: 60%;    height: 70%;    border-radius: 10px;    z-index: 2147483648;    border: 0px;}.mainIframe{    border: 0;    width: 100%;    height: 100%;    border-radius: 10px;}.iframeLoadingDiv{    position: absolute;    left: 0;    top: 0;    height: 100%;    width: 100%;    z-index: 500000000;    text-align: center;    background: #eeeeef;    display: flex;    justify-content: center;    align-items: center;    border-radius: 10px;}.iframeClosePopUp{    width: 20px;    height: 20px;    z-index: 10000;    cursor: pointer;    border: 0 !important;    background-color: rgb(255, 255, 255);    position: absolute;    right: 18px;    top: 20px;    border-radius: 5px;}@keyframes animaterighthantana {	from {		right: -320px;		opacity: 0	}	to {		right: 26px;		opacity: 1	}}.hantana-animate-left {	position: relative;	animation: animatelefthantana 0.4s}@keyframes animatelefthantana {	from {		left: -320px;		opacity: 0	}	to {		left: 26px;		opacity: 1	}}@media only screen and (max-width: 450px) {    @keyframes animateright {        from {            right: -300px;            opacity: 0        }        to {            right: 0px;            opacity: 1        }    }    @keyframes animatelefthantana {        from {            left: -320px;            opacity: 0        }        to {            left: 0px;            opacity: 1        }    }    /* feedback1 */    .div_hantana_main_feedback_right {        width: 100%;        border-radius: 0    }    .div_hantana_main_feedback_left {        width: 100%;        border-radius: 0    }    .div_hantana_main_feedback_float_right {        width: 100%;        border-radius: 0    }    .div_hantana_main_feedback_float_left {        width: 100%;        border-radius: 0    }    .textArea_hantana_main_feedback_1 {        width: 100%;        margin-left: 0;        height: 110px    }    .p_hantana_main_feedback_1 {        font-size: 14px !important;    }    .div_hantana_main_close_feedback {        width: 35px;        height: 35px;        top: -18px;    }    /* survey */    .div_main_hantana_survey{        width: 100%;        right:0;    }    /* newsletter1 */    .div_main_hantana_newsletter1{        width: 100%;        right:0;    }    .iframeDiv{        width: 95%;        height: 95%;        margin-left: -7px;    }}@font-face{font-family:hantanaVazir;src:url(https://hantana.org/widgets/fonts/Vazir/Vazir.eot);src:url(https://hantana.org/widgets/fonts/Vazir/Vazir.eot?#iefix) format("embedded-opentype"), url(https://hantana.org/widgets/fonts/Vazir/Vazir.woff2) format("woff2"), url(https://hantana.org/widgets/fonts/Vazir/Vazir.woff) format("woff"), url(https://hantana.org/widgets/fonts/Vazir/Vazir.ttf) format("truetype");font-weight:400}@font-face{font-family:hantanaVazir;src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Bold.eot);src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Bold.eot?#iefix) format("embedded-opentype"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Bold.woff2) format("woff2"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Bold.woff) format("woff"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Bold.ttf) format("truetype");font-weight:700}@font-face{font-family:hantanaVazir;src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Light.eot);src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Light.eot?#iefix) format("embedded-opentype"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Light.woff2) format("woff2"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Light.woff) format("woff"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Light.ttf) format("truetype");font-weight:300}@font-face{font-family:hantanaVazir;src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Medium.eot);src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Medium.eot?#iefix) format("embedded-opentype"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Medium.woff2) format("woff2"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Medium.woff) format("woff"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Medium.ttf) format("truetype");font-weight:500}@font-face{font-family:hantanaVazir;src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Thin.eot);src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Thin.eot?#iefix) format("embedded-opentype"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Thin.woff2) format("woff2"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Thin.woff) format("woff"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Thin.ttf) format("truetype");font-weight:100}@font-face{font-family:hantanaVazir;src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Black.eot);src:url(https://hantana.org/widgets/fonts/Vazir/Vazir-Black.eot?#iefix) format("embedded-opentype"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Black.woff2) format("woff2"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Black.woff) format("woff"), url(https://hantana.org/widgets/fonts/Vazir/Vazir-Black.ttf) format("truetype");font-weight:900}</style>';
    document.head.insertAdjacentHTML('beforeend', style_hantana_font );

    function parseUrl(url) {
        var m = url.match(/^(([^:\/?#]+:)?(?:\/\/((?:([^\/?#:]*):([^\/?#:]*)@)?([^\/?#:]*)(?::([^\/?#:]*))?)))?([^?#]*)(\?[^#]*)?(#.*)?$/),
            r = {
                hash: m[10] || "",                   // #asd
                host: m[3] || "",                    // localhost:257
                hostname: m[6] || "",                // localhost
                href: m[0] || "",                    // http://username:password@localhost:257/deploy/?asd=asd#asd
                origin: m[1] || "",                  // http://username:password@localhost:257
                pathname: m[8] || (m[1] ? "/" : ""), // /deploy/
                port: m[7] || "",                    // 257
                protocol: m[2] || "",                // http:
                search: m[9] || "",                  // ?asd=asd
                username: m[4] || "",                // username
                password: m[5] || ""                 // password
            };
        if (r.protocol.length == 2) {
            r.protocol = "file:///" + r.protocol.toUpperCase();
            r.origin = r.protocol + "//" + r.host;
        }
        r.href = r.origin + r.pathname + r.search + r.hash;
        return m && r;
    }
    function doAjaxThingsHantana() {
        try {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("GET", 'https://iplocate.io/api/lookup/' , true);
            xmlhttp.timeout = 4000;
            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    if(isJson(xmlhttp.responseText)){
                        var geoIpDetail = JSON.parse(xmlhttp.response);
                        ipDetail = JSON.stringify({
                            "ip": geoIpDetail.ip,
                            "country_name": geoIpDetail.country,
                            "country_code": geoIpDetail.country_code,
                        });
                    }
                    return true;
                }
            }
            xmlhttp.ontimeout = function (e) {
                console.log("timeout lookup")
                return false;
            };
            xmlhttp.send();
        } catch (e) {
            console.log("err lookup", e)
            return false;
        } 
    }
    doAjaxThingsHantana();

    function fixInlineStylesHantana() {
        return new Promise(function(resolve, reject) {
            function getSheetsHantana(styleSheetData){
                var classes = (styleSheetData.cssRules || styleSheetData.rules), styles = '';
                for (var x = 0; x < classes.length; x++) {
                    if (classes[x].cssText) {
                        styles += classes[x].cssText;
                    } else {
                        styles += classes[x].style.cssText;
                    }
                }
                return styles.toString();
            }
            var styleSheets = document.styleSheets, arrDataStyles = [];
            for (var i = 0; i < styleSheets.length; i++) {
                if(styleSheets[i]['href'] == null){
                    var data = getSheetsHantana(styleSheets[i]);
                    arrDataStyles.push({index:i, style:'<style>' + data + '</style>'});        
                }
            }
            arrDataStyles.forEach(function(item){
                document.head.innerHTML += item.style;
                document.styleSheets[item.index].disabled = true;
            });

            resolve(true);
        });
    }
    

    function userAgentHantana(){
        if (navigator.userAgent.match(/Tablet|iPad/i)) {
            return 'tablet';
        } else if(navigator.userAgent.match(/Mobile|Windows Phone|Lumia|Android|webOS|iPhone|iPod|Blackberry|PlayBook|BB10|Opera Mini|\bCrMo\/|Opera Mobi/i) ) {
            return 'mobile';
        } else {
            return 'desktop';
        }
    }
    function hexToRgbAHantana(hex){
        var c;
        if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)){
            c= hex.substring(1).split('');
            if(c.length== 3){
                c= [c[0], c[0], c[1], c[1], c[2], c[2]];
            }
            c= '0x'+c.join('');
            return 'rgba('+[(c>>16)&255, (c>>8)&255, c&255].join(',')+',0.30)';
        }
        throw new Error('Bad Hex');
    }
    function hexToRgbHantana(hex) {
        var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
            r: parseInt(result[1], 16),
            g: parseInt(result[2], 16),
            b: parseInt(result[3], 16)
        } : null;
    }
    function getContrastColor(R, G, B, A) {
        const brightness = R * 0.299 + G * 0.587 + B * 0.114 + (1 - A) * 255;
        return brightness > 186 ? "#000000" : "#FFFFFF";
    }
    function toFarsiNumber(n) {
        var farsiDigits = ['۰', '۱', '۲', '۳', '۴', '۵', '۶', '۷', '۸', '۹'];
        return n.toString().replace(/\d/g, function (x) {
			return farsiDigits[x];
		});
    }
    function checkPersianCharacter(str){
        return /^[\u0600-\u06FF\s]+$/.test(str);
    }
    function countPersianCharacters(string){
        string = string.replace(/\s/g, "");
        var count = 0;
        for (var i = 0; i<string.length; i++){
            if (checkPersianCharacter(string.charAt(i)))
                count+=1;
        }
        return count;
    }
    function lightOrDark(color) {
        if (color.match(/^rgb/)) {
            color = color.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);
            r = color[1];
            g = color[2];
            b = color[3];
        } 
        else {
            color = +("0x" + color.slice(1).replace(color.length < 5 && /./g, '$&$&'));
            r = color >> 16;
            g = color >> 8 & 255;
            b = color & 255;
        }
        hsp = Math.sqrt(0.299 * (r * r) + 0.587 * (g * g) + 0.114 * (b * b));
        if (hsp>127.5) {
            return 'light';
        }else {
            return 'dark';
        }
    }
    function checkTextIsPersian(text) {
        if(Number(countPersianCharacters(text)) > (Number((text).length) - Number(countPersianCharacters(text)))){
            return true;
        }
        return false;
    }
    function isValidEmail(emailAddress) {
        var pattern = new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);
        return pattern.test(emailAddress);
    }
    function removeURLParametersHantana(removeParams) {
        var deleteRegex = new RegExp(removeParams.join('=|') + '=')
        var params = location.search.slice(1).split('&')
        var search = []
        for (var i = 0; i < params.length; i++) if (deleteRegex.test(params[i]) === false) search.push(params[i])
        window.history.replaceState({}, document.title, location.pathname + (search.length ? '?' + search.join('&') : '') + location.hash)
    }
    function fadeInHantana(el, time) {
        el.style.opacity = 0;
        var last = +new Date();
        var tick = function() {
            el.style.opacity = +el.style.opacity + (new Date() - last) / time;
            last = +new Date();

            if (+el.style.opacity < 1) {
                (window.requestAnimationFrame && requestAnimationFrame(tick)) || setTimeout(tick, 16);
            }
        };
        tick();
    }


    //heatmap start

    //start new function
    function positionInNodeListHantana(element, nodeList) {
        for (let i = 0; i < nodeList.length; i++) {
            if (element === nodeList[i]) {
            return i;
            }
        }
        return -1;
    }
    function findNodeAndContainerHantana(node) {
        const shadowRoot = node.containingShadowRoot;
        while ((_node = node) !== null && _node !== void 0 && _node.isNativeAnonymous) {
            var _node;
            node = node.parentNode;
        }
        if (shadowRoot) {
            return {
            containingDocOrShadow: shadowRoot,
            node
            };
        }
        return {
            containingDocOrShadow: node.ownerDocument,
            node
        };
    }

    function findCssSelectorHantana(ele) {
        const {
            node,
            containingDocOrShadow
        } = findNodeAndContainerHantana(ele);
        ele = node;

        if (!containingDocOrShadow || !containingDocOrShadow.contains(ele)) {
            return "";
        }

        if (ele.id) {
            var idData = (ele.id).replace(/"+$/,'').replace(/^"/, '').replace(/\./g, '');
            if (/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(idData)) {
                if(document.querySelectorAll("#" + idData)){
                    if(document.querySelectorAll("#" + idData).length === 1){
                        return "#" + idData;
                    }
                }
            }
        }
        // if (ele.id && document.querySelectorAll("#" + ele.id).length === 1) {
        //     return "#" + ele.id;
        // }

        var eleTagName = ele.tagName.toLowerCase();

        if (eleTagName === "html" || eleTagName === "head" || eleTagName === "body") {
            return eleTagName;
        }

        let selector, index, matches;

        for (let i = 0; i < ele.classList.length; i++) {

            var classNameData = ele.classList.item(i).replace(/"+$/,'').replace(/^"/, '');
            if (/^[a-z_-][a-z\d_-]*$/i.test(classNameData)) {

                selector = "." + classNameData;
                matches = document.querySelectorAll(selector);
                if (matches.length === 1) {
                    return selector;
                }

                selector = eleTagName + selector;
                matches = document.querySelectorAll(selector);
                if (matches.length === 1) {
                    return selector;
                }

                index = positionInNodeListHantana(ele, ele.parentNode.children) + 1;
                selector = selector + ":nth-child(" + index + ")";
                matches = document.querySelectorAll(selector);
                if (matches.length === 1) {
                    return selector;
                }

            }

        }

        index = positionInNodeListHantana(ele, ele.parentNode.children) + 1;
        selector = eleTagName + ":nth-child(" + index + ")";

        if (ele.parentNode !== containingDocOrShadow) {
            selector = findCssSelectorHantana(ele.parentNode) + ">" + selector;
        }

        return selector;
    }
    //end new function

    function getDomPathHantana(el) {
        if (!el) {
            return;
        }
        var stack = [];
        var isShadow = false;
        while (el.parentNode != null) {
            // console.log(el.nodeName);
            var sibCount = 0;
            var sibIndex = 0;
            // get sibling indexes
            for ( var i = 0; i < el.parentNode.childNodes.length; i++ ) {
                var sib = el.parentNode.childNodes[i];
                
                if ( sib.nodeName == el.nodeName ) {
                    if ( sib === el ) {
                    sibIndex = sibCount;
                    }
                    sibCount++;
                }
            }
            // if ( el.hasAttribute('id') && el.id != '' ) { no id shortcuts, ids are not unique in shadowDom
            //   stack.unshift(el.nodeName.toLowerCase() + '#' + el.id);
            // } else
            var nodeName = el.nodeName.toLowerCase();
            if (isShadow) {
            nodeName += "::shadow";
                isShadow = false;
            }
            if ( sibCount > 1 ) {
                stack.unshift(nodeName + '(' + (sibIndex + 1) + ')');
            } else {
                stack.unshift(nodeName + '(1)');
            }
            el = el.parentNode;
            if (el.nodeType === 11) { // for shadow dom, we
                isShadow = true;
                el = el.host;
            }
        }
        stack.splice(0,1); // removes the html element
        return stack.join('>');
    }

    function getParentDataHantana(event){
        var path = event.path || (event.composedPath && event.composedPath());
        var arr = [], str = '';
        path.forEach(function (element) {
            arr.push(element)
        });
        arr.pop();
        arr.pop();
        arr.forEach(function (element) {
            if (element.classList != undefined && element.classList.length > 0 && element.className != null && element.className.split) {
                var classname = "";
                var countSpace = element.className.split(" ");
                countSpace.forEach(function (element) {
                    classname = classname + element + ".";
                });
                classname = classname.substring(".", classname.length - 1);
                str = element.localName + "." + classname + " " + str;
            } else if (element.id) {
                var idname = "";
                var countSpace = element.id.split(" ");
                countSpace.forEach(function (element) {
                    idname = idname + element + ".";
                });
                idname = idname.substring(".", idname.length - 1);
                str = element.localName + "#" + idname + " " + str;
            } else {
                if(element.localName){
                    str = element.localName + " " + str;
                }

            }
        });
        return str;
    }


    var getXPathForElement = function getXPathForElement(element) {
        var idx = function idx(sib, name) {
            return sib ? idx(sib.previousElementSibling, name || sib.localName) + (sib.localName == name) : 1;
        };
        var segs = function segs(elm) {
            return !elm || elm.nodeType !== 1 ? [''] : elm.id && document.getElementById(elm.id) === elm ? [].concat(segs(elm.parentNode), [elm.localName.toLowerCase() + "[" + idx(elm) + "]"]) : [].concat(segs(elm.parentNode), [elm.localName.toLowerCase() + "[" + idx(elm) + "]"]);
        }
        return segs(element).join('/');
    };
 
    var prevNumberFromAllHantana = function prevNumberFromAllHantana(element) {
        var result = 0, flagSet = true;
        var body = window.document.getElementsByTagName('*');
        var blockTags = ["symbol","head","meta","title","link","base","script","style","noscript","g","path","rect","polygon","circle","line","ellipse","polyline","clippath","defs","br"];
        for (var i=0, max=body.length; i < max; i++) {
            if(body[i] != element && flagSet == true && blockTags.indexOf(body[i].tagName.toLowerCase()) == -1){
                result++;
            }
            if(body[i] == element){
                flagSet = false;
            }
        }
        return result;
    }

    
    var getDataClickMoveToServerHantana = async (e, getParentHanatanRes) =>{
        var target = e.target || e.srcElement;
        var positionInfo = await target.getBoundingClientRect();
    
        //new
        var newGetUniqueSelectorHantanaRes = await findCssSelectorHantana(target);
        //old
        var getUniqueSelectorHantanaRes = await getDomPathHantana(target);
        

        var type = "";
        if (userAgentHantana() == "desktop") {
            type = "1";
        } else if (userAgentHantana() == "tablet") {
            type = "2";
        } else {
            type = "3";
        }
        if(getUniqueSelectorHantanaRes != '' && newGetUniqueSelectorHantanaRes != ''){
            var x = e.clientX - positionInfo.left;
            var y = e.clientY - positionInfo.top;
            if(x > 0 && y > 0 && positionInfo.width > 0 && positionInfo.height > 0){
            // if(positionInfo.left != 0 && positionInfo.top != 0){
        
                // return { status:true, stringCheckUniq: getUniqueSelectorHantanaRes, data: "siteToken="+window._hantanaSettings.tId+"&pageUrl="+window.location.href+"&elementParent="+getParentHanatanRes+"&xPath="+getXPathForElement(target)+"&clientWidth="+positionInfo.width+"&clientHeight="+positionInfo.height+"&classList="+classListData+"&idElem="+idData+"&stringCheckUniq="+getUniqueSelectorHantanaRes+"&posClickOnElemX="+x+"&posClickOnElemY="+y+"&type="+type+"&prevNumber="+Math.ceil(prevNumberFromAllHantana(target) / 100)+"&status="+true };

                return {
                    siteToken: window._hantanaSettings.tId,
                    pageUrl: window.location.href,
                    elementParent: getParentHanatanRes,
                    xPath: getXPathForElement(target),
                    clientWidth: positionInfo.width,
                    clientHeight: positionInfo.height,
                    // classList: target.className,
                    //classList: getElementSevInPage.class,
                    classList: (target.getAttribute("class") != null) ? target.getAttribute("class") : '',
                    // idElem: target.id,
                    idElem: (target.id) ? target.id : '',
                    //numCountElemInPage: getElementSevInPage.count,
                    stringCheckUniq: getUniqueSelectorHantanaRes,
                    newStringCheckUniq: newGetUniqueSelectorHantanaRes,
                    posClickOnElemX: x,
                    posClickOnElemY: y,
                    type: type,
                    prevNumber: Math.ceil(prevNumberFromAllHantana(target) / 100),
                    status:true
                };
            }else{
                return {
                    status:false,
                };
            }
            // }else{
            //     return {
            //         status:false,
            //     };
            // }
        }
    }

    function createHeatmapHantana(mainId) {

        fixInlineStylesHantana().then(function(){
        
            var typeDevice;
            if (userAgentHantana() == "desktop") {
                typeDevice = 1;
            } else if (userAgentHantana() == "tablet") {
                typeDevice = 2;
            } else {
                typeDevice = 3;
            }
            var generatedSource = new XMLSerializer().serializeToString(document);
            var data = new Blob([generatedSource], {type: 'text/html'});
            var fd = new FormData;
            fd.append('textDoc', data);
            fd.append('device', typeDevice);
            fd.append('pageUrlSource', window.location.href);
            fd.append('mainId', mainId);
            var xhr = new XMLHttpRequest();
            xhr.file = data;
            xhr.addEventListener('progress', function(e) {
                //var done = e.position || e.loaded, total = e.totalSize || e.total;
                //console.log('xhr progress: ' + (Math.floor(done/total*1000)/10) + '%');
            }, false);
            if ( xhr.upload ) {
                xhr.upload.onprogress = function(e) {
                    //var done = e.position || e.loaded, total = e.totalSize || e.total;
                    //console.log('xhr.upload progress: ' + done + ' / ' + total + ' = ' + (Math.floor(done/total*1000)/10) + '%');
                };
            }
            xhr.onreadystatechange = function(e) {
                if (4 == this.readyState ) {
                    var response = JSON.parse(xhr.responseText);
                    // console.log(response)
                }
            };
            xhr.open('POST', heatmapPrefixHantana + 'getDocChunk', true);
            xhr.send(fd);

        });

    }


    var docHeightHantana = Math.max(document.body.scrollHeight, document.body.offsetHeight, document.documentElement.clientHeight, document.documentElement.scrollHeight, document.documentElement.offsetHeight);
    var startSavedData = (window._hantanaSettings.i > 100) ? window._hantanaSettings.i : 0,
    startPoint = startSavedData,
    // startPointData = startSavedData,
    endPoint = startSavedData + window.innerHeight,
    // endPointData = startSavedData + window.innerHeight,
    foldData = startSavedData + window.innerHeight,
    lastStartPoint = -1,
    lastEndPoint = -1,
    lastKnownScrollPosition = 0,
    ticking = false;
    // function capitalizeFirstLetter(string) {
    //     return string.charAt(0).toUpperCase() + string.slice(1);
    // }
    // function getValueScrollHantana(screenShotHeight){
    //     startPointData = startPoint;
    //     endPointData = endPoint;
    //     // startPointData = Math.round((startPoint * screenShotHeight) / docHeightHantana);
    //     // endPointData = Math.round((endPoint * screenShotHeight) / docHeightHantana);
    //     return {startPointData: startPointData, endPointData: endPointData};
    // }
    function doScrollHantana(scrollPos) {
        if(scrollPos < startPoint){ // start
            startPoint = scrollPos;
        }
        if((scrollPos + window.innerHeight) > endPoint){ // end
            endPoint = scrollPos + window.innerHeight;
        } 
    }
    doScrollHantana(startSavedData);
    document.addEventListener('scroll', function(e) {
        lastKnownScrollPosition = window.scrollY;
        if (!ticking) {
            window.requestAnimationFrame(function() {
                doScrollHantana(lastKnownScrollPosition);
                ticking = false;
            });
            ticking = true;
        }
    });
   
    function sendScrollMapDataHantana(){
        if(arrWorks.length > 0 && (lastStartPoint != startPoint || lastEndPoint != endPoint)){
            if(window._hantanaSettings.log){
                console.log('scroll')
            }
            var userDevice = userAgentHantana();
            arrWorks.forEach(function (item) {
                if((userDevice == "desktop" && item.flagSetElemsDesktop) || (userDevice == "tablet" && item.flagSetElemsTablet) || (userDevice == "mobile" && item.flagSetElemsMobile)){
                    // var getData = getValueScrollHantana(item['frameViewHeight' + capitalizeFirstLetter(userDevice)]);
                    if(window._hantanaSettings.log){
                        console.log('scroll send')
                    }
                    var xmlhttp = new XMLHttpRequest();
                    xmlhttp.open("POST", heatmapPrefixHantana + 'scrollNew', true);
                    xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                    xmlhttp.send(JSON.stringify({ 
                        "siteToken": window._hantanaSettings.tId,
                        "mainId": item.mainId,
                        "userDocHeight": docHeightHantana,
                        "device": (userDevice == "desktop") ? 1 : (userDevice == "tablet") ? 2 : 3,
                        "pageUnique": item.pageUnique,
                        // "startPoint": getData.startPointData,
                        // "endPoint": getData.endPointData,
                        "startPoint": startPoint,
                        "endPoint": endPoint,
                        "fold": foldData
                    })); 
                } 
            });
            lastStartPoint = startPoint;
            lastEndPoint = endPoint;
        }
    }
    if(checkAccountUserResultHantana != 0){
        setInterval(function(){
            sendScrollMapDataHantana();
        },5000);
    }
    window.addEventListener("beforeunload", function (e) {
        if(checkAccountUserResultHantana != 0){
            sendScrollMapDataHantana();
        }
    });




    var lastClickElemHantana = '';
    document.addEventListener('click', async (e) => {
        if(arrWorks.length > 0){
            var getParentHanatanRes = getParentDataHantana(e);
            var getData = await getDataClickMoveToServerHantana(e, getParentHanatanRes);
            if(window._hantanaSettings.log){
                console.log(getData)
            }
            if (getData && getData.status) {
                if(lastClickElemHantana != getData.stringCheckUniq){
                    lastClickElemHantana = getData.stringCheckUniq;
                    arrWorks.forEach(function (item, index) {
                        if(((userAgentHantana() == "desktop" && item.flagSetElemsDesktop) || (userAgentHantana() == "tablet" && item.flagSetElemsTablet) || (userAgentHantana() == "mobile" && item.flagSetElemsMobile)) && checkAccountUserResultHantana != 0 && (item.totalClicks + item.totalClicksMobile + item.totalClicksTablet) < item.clicks){
                            if(window._hantanaSettings.log){
                                console.log('click')
                            }
                            var xmlhttp = new XMLHttpRequest();
                            xmlhttp.open("POST", heatmapPrefixHantana + 'clicksNew', true);
                            // xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                            xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                            getData.mainId = item.mainId;
                            if(Number(item.typeClicksFunc) == 2){
                                getData.stringCheckUniq = getData.newStringCheckUniq;
                            }
                            arrWorks[index]['totalClicks'] = item.totalClicks + 1;
                            xmlhttp.send(JSON.stringify(getData));
                        }
                    });
                } 
            } 
        }
    }, true);

    if(userAgentHantana() == "desktop"){
        var arrMainDataSendHantanaMove = [];
        var arrDataSendHantanaMove = [];
        document.addEventListener("mousemove", async (e) => {
            if(arrWorks.length > 0){
                var getParentHanatanRes = getParentDataHantana(e);
                var getData = await getDataClickMoveToServerHantana(e, getParentHanatanRes);
                if(getData && getData.status){
                    arrDataSendHantanaMove.push(getData);
                }
            }
        });
        setInterval(async ()=>{
            if(arrDataSendHantanaMove.length > 0){
                arrMainDataSendHantanaMove.push(arrDataSendHantanaMove.pop());
            }
        },5000)
        setInterval(async ()=>{
            arrWorks.forEach(function (item) {
                if (arrDataSendHantanaMove.length > 0 && arrMainDataSendHantanaMove.length > 0 && arrWorks.length > 0 && item.flagSetElemsDesktop && checkAccountUserResultHantana != 0) {
                    if(window._hantanaSettings.log){
                        console.log('move')
                    }
                    arrMainDataSendHantanaMove.map(data => data.mainId = item.mainId);
                    arrMainDataSendHantanaMove.map(data => {
                        if(Number(item.typeClicksFunc) == 2){
                            data.stringCheckUniq = data.newStringCheckUniq;
                        }
                    });                    
                    var xmlhttp = new XMLHttpRequest();
                    xmlhttp.open("POST", heatmapPrefixHantana + 'movesNew', true);
                    // xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                    xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                    xmlhttp.send(JSON.stringify(arrMainDataSendHantanaMove));
                }
            });
            arrMainDataSendHantanaMove = []
            arrDataSendHantanaMove = []
        },10000);
    }
    

    //feedback start
    function createFeedbackHantana(data){

        // console.log("start feedback")
        var lastSelectionPos = {};
        
        var iconsElementType = 'div';
        if(previewFeedbackFlag == 1){
            var element = document.getElementById('div_all_items_feedback_hantana_id');
            if(element){
                element.parentNode.removeChild(element);
            }
            data.iconPack = data.data.iconPack;
            iconsElementType = 'img';
        }

        var feedbackIndex = data.index,
        iconPack = data.iconPack,
        dataFeedback1Hantana = data.data,
        c1 = dataFeedback1Hantana.backgroundColor,
        c2 = 'EEEEEE',
        c3 = '4d4d4d',
        c4 = dataFeedback1Hantana.foregroundColor,
        selectedStatus = 0,
        flagClick = false;

        if(checkAccountUserResultHantana == 0){
            c1 = 'F43B45';
            c4 = 'f4f4f4';
        }

        if(window.localStorage.openTheWidgetOnlyOnceFeedbackFlagHantana != feedbackIndex){
            window.localStorage.removeItem('openTheWidgetOnlyOnceFeedbackHantana');
        }
       

       

        if(dataFeedback1Hantana.welcomeMessageFlag && window.localStorage.openTheWidgetOnlyOnceFeedbackHantana != feedbackIndex){
            showWelcomeHantanaMainFeedBack();
            hideWelcomeHantanaMainFeedBack();
        }

        if(dataFeedback1Hantana.openAutoMainBoxFlag){
            if (localStorage.viewCheckInAutoOpenFeedback) {
                localStorage.viewCheckInAutoOpenFeedback = dataFeedback1Hantana.openAutoOnce;
                if(localStorage.viewCheckInAutoOpenFeedback == 'false'){
                    openAutoMainBox(dataFeedback1Hantana.openAutoMainBoxSecond);
                }
            }else{
                localStorage.viewCheckInAutoOpenFeedback = dataFeedback1Hantana.openAutoOnce;
                openAutoMainBox(dataFeedback1Hantana.openAutoMainBoxSecond);
            }
        }

        //set style 
        var changesCssFeedback1Hantana = '.textArea_hantana_main_feedback_1::-webkit-scrollbar-thumb {background: #'+c1+'}';
        var style_hantana_font = '<style>'+changesCssFeedback1Hantana+'</style>';
        document.head.insertAdjacentHTML('beforeend', style_hantana_font );

        //create hantana_btn
        var hantana_all_divs_data = document.createElement('div');
        hantana_all_divs_data.className = "div_all_items_feedback_hantana";
        hantana_all_divs_data.id = "div_all_items_feedback_hantana_id";
        hantana_all_divs_data.setAttribute("data-html2canvas-ignore", "true");

        // add style into all div
        // hantana_all_divs_data.insertAdjacentHTML('beforeend', style_hantana_feedback );

        //create hantana_btn
        var hantana_btn = document.createElement('div');

        if(dataFeedback1Hantana.position == 'right'){
            hantana_btn.className = "div_hantana_open_feedback_right animated_hantana fadeIn_hantana_animate";
        }else if(dataFeedback1Hantana.position == 'left'){
            hantana_btn.className = "div_hantana_open_feedback_left animated_hantana fadeIn_hantana_animate";
        }else if(dataFeedback1Hantana.position == "float-right"){
            hantana_btn.className = "div_hantana_open_feedback_float_right animated_hantana fadeIn_hantana_animate";
        }else if(dataFeedback1Hantana.position == "float-left"){
            hantana_btn.className = "div_hantana_open_feedback_float_left animated_hantana fadeIn_hantana_animate";
        }
        
        hantana_btn.id = "div_hantana_open_feedback";
        hantana_btn.style.backgroundColor = '#' + c1;
        hantana_btn.onclick = function() {
            openHantanaDivMainFeedback();
        }
        hantana_btn.onmouseover = function() {
            hantana_btn.style.boxShadow = '0 0 18px 2px '+hexToRgbAHantana('#'+c1+'')+'';
        }
        hantana_btn.onmouseout = function() {
            hantana_btn.style.boxShadow = 'none';
        }

        //create hantana_btn_open_1 and append in to hantana_btn
        var hantana_btn_open_1 = document.createElement('div');
        hantana_btn_open_1.className = "div_hantana_open_text_feedback";
        if(dataFeedback1Hantana.language == 'fa'){
            hantana_btn_open_1.style.cssText = 'line-height: 1.2 !important;';
        }else{
            hantana_btn_open_1.style.cssText = 'line-height: 1.6 !important;';
        }
        hantana_btn_open_1.innerHTML = dataFeedback1Hantana.openBtnText;
        hantana_btn_open_1.style.color = '#' + c4;
        if(dataFeedback1Hantana.position == 'right' || dataFeedback1Hantana.position == 'left'){
            hantana_btn.appendChild(hantana_btn_open_1);
        }
        

        //create hantana_btn_img and append in to hantana_btn
        var hantana_btn_img = document.createElement('img');
        hantana_btn_img.alt = "hantana";

        if(dataFeedback1Hantana.position == 'right' || dataFeedback1Hantana.position == 'left'){
            hantana_btn_img.className = "img_hantana_open_icon_feedback";
        }else{
            hantana_btn_img.className = "img_hantana_open_icon_feedback_float";
        }
        if(checkAccountUserResultHantana == 0){
            hantana_btn_img.style.cssText = 'filter:invert(0%) sepia(0%) saturate(0%) hue-rotate(341deg) brightness(103%) contrast(103%)'
        }else if(dataFeedback1Hantana.foregroundColor == '4d4d4d'){
            hantana_btn_img.style.cssText = 'filter:invert(100%) sepia(0%) saturate(5832%) hue-rotate(216deg) brightness(111%) contrast(45%)'
        }else if(dataFeedback1Hantana.foregroundColor == 'f4f4f4'){
            hantana_btn_img.style.cssText = 'filter:invert(0%) sepia(0%) saturate(0%) hue-rotate(341deg) brightness(103%) contrast(103%)'
        }else{
            hantana_btn_img.style.cssText = 'filter:invert(0%) sepia(0%) saturate(0%) hue-rotate(341deg) brightness(103%) contrast(103%)'
        }
        hantana_btn_img.onmousedown = function() {return false}
        // hantana_btn_img.src = 'https://hantana.org/widgets/img/icons/' + dataFeedback1Hantana.logoOnOpenBtn + '.svg';
        hantana_btn_img.src = imageOnBtnFeedbackHantana;
        hantana_btn.appendChild(hantana_btn_img);


        //create welcome and after send message box
        var hantana_message_show = document.createElement('div');
        hantana_message_show.id = "div_add_after_send_into_hantana";

        var hantana_message_show_1 = document.createElement('div');

        if(dataFeedback1Hantana.position == 'right'){
            hantana_message_show_1.className = "after_send_hantana_main_feedback_right animated_hantana fadeIn_hantana_animate";
        }else if(dataFeedback1Hantana.position == 'left'){
            hantana_message_show_1.className = "after_send_hantana_main_feedback_left animated_hantana fadeIn_hantana_animate";
        }else if(dataFeedback1Hantana.position == "float-right"){
            hantana_message_show_1.className = "after_send_hantana_main_feedback_float_right animated_hantana fadeIn_hantana_animate";
        }else if(dataFeedback1Hantana.position == "float-left"){
            hantana_message_show_1.className = "after_send_hantana_main_feedback_float_left animated_hantana fadeIn_hantana_animate";
        }
        
        hantana_message_show_1.id = "after_send_hantana_main_feedback_id";
        hantana_message_show_1.onmouseover = function() {
            onHoverInAfterBackBoxHantana()
        }
        hantana_message_show_1.onmouseout = function() {
            uHoverInAfterBackBoxHantana()
        };
        hantana_message_show.appendChild(hantana_message_show_1);

        var hantana_message_show_close = document.createElement('div');
        hantana_message_show_close.className = "after_hantana_main_close_feedback animated_hantana fadeIn_hantana_animat";
        hantana_message_show_close.id = "after_hantana_main_close_feedback_id";
        hantana_message_show_close.style.backgroundColor = '#' + c1;
        hantana_message_show_close.onclick = function() {
            closeAfterHantanaMainFeedBack()
        }
        hantana_message_show_1.appendChild(hantana_message_show_close);



        var hantana_message_show_text = document.createElement('p');
        hantana_message_show_text.className = "after_text_hantana_main_feedback";
        hantana_message_show_text.id = "after_text_hantana_main_feedback_id";
        hantana_message_show_text.innerHTML = dataFeedback1Hantana.welcomeMessage;
        hantana_message_show_1.appendChild(hantana_message_show_text);


        //create main
        var hantana_div_main_feedback = document.createElement('div');
        if(dataFeedback1Hantana.position == 'right'){
            hantana_div_main_feedback.className = "div_hantana_main_feedback_right animated_hantana pulse_hantana_animate";
        }else if(dataFeedback1Hantana.position == 'left'){
            hantana_div_main_feedback.className = "div_hantana_main_feedback_left animated_hantana pulse_hantana_animate";
        }else if(dataFeedback1Hantana.position == "float-right"){
            hantana_div_main_feedback.className = "div_hantana_main_feedback_float_right hantana-animate-right";
            // animated_hantana pulse_hantana_animate
        }else if(dataFeedback1Hantana.position == "float-left"){
            hantana_div_main_feedback.className = "div_hantana_main_feedback_float_left hantana-animate-left";
            // animated_hantana pulse_hantana_animate
        }
        hantana_div_main_feedback.id = "div_hantana_main_feedback";



        var hantana_div_main_close_feedback = document.createElement('div');
        hantana_div_main_close_feedback.className = "div_hantana_main_close_feedback";
        hantana_div_main_close_feedback.id = "div_hantana_main_close_feedback_id";
        hantana_div_main_close_feedback.style.backgroundColor = '#' + c1;
        hantana_div_main_close_feedback.onclick = function() {
            closeHantanaMainFeedBack();
            goToSelectPartOfPageInHantana(2);
            lastSelectionPos = {};
        }
        if(dataFeedback1Hantana.position == 'right' || dataFeedback1Hantana.position == 'left'){
            hantana_div_main_feedback.appendChild(hantana_div_main_close_feedback);
        }
       



        var hantana_p_main_close_feedback = document.createElement('p');
        hantana_p_main_close_feedback.className = "p_hantana_main_feedback_1";
        hantana_p_main_close_feedback.id = "p_hantana_main_feedback_1_id";
        if(dataFeedback1Hantana.showHantanaBrand == false){
            hantana_p_main_close_feedback.style.cssText = 'padding: 36px 15px 0 15px !important';
        }
        hantana_p_main_close_feedback.innerHTML = dataFeedback1Hantana.titleText;
        hantana_div_main_feedback.appendChild(hantana_p_main_close_feedback);



        var hantana_div_icons_main_feedback = document.createElement('div');
        hantana_div_icons_main_feedback.className = "div_hantana_main_100_feedback animated_hantana fadeIn_hantana_animate";
        hantana_div_icons_main_feedback.style.cssText = "line-height: 0;";
        hantana_div_main_feedback.appendChild(hantana_div_icons_main_feedback);


        //hate icon
        var hantana_div_iconImage_main_feedback_hate = document.createElement('div');
        hantana_div_iconImage_main_feedback_hate.className = "div_img_main_hantana";
        hantana_div_iconImage_main_feedback_hate.id = "thisArrowHantana1";
        var hantana_hate_icon = document.createElement(iconsElementType);
        hantana_hate_icon.alt = "hate";
        hantana_hate_icon.className = "img_hantana_main_feedback_1";
        hantana_hate_icon.id = "img_hantana_main_feedback_id_1";
        hantana_hate_icon.setAttribute("valueArrowHantana", "1");
        if(previewFeedbackFlag == 1){
            hantana_hate_icon.src = 'https://hantana.org/widgets/img/emoji/' + iconPack + '/Hate.svg';
        }else{
            hantana_hate_icon.innerHTML = iconPack[4];
        }
        
        hantana_hate_icon.onmousedown = function() {return false}
        hantana_hate_icon.onclick = function() {
            openFeedBackAreaHantana(this)
        }
        hantana_hate_icon.onmouseover = function() {
            hoverOnIconTypesHantana(this)
        }
        hantana_hate_icon.onmouseout = function() {
            hoverOnIconTypesLeaveHantana()
        }
        var hantana_hate_p = document.createElement('p');
        hantana_hate_p.className = "animated_hantana fadeIn_hantana_animate label_under_images_hantana";
        hantana_hate_p.id = "label_under_images_hantana_id_1";
        if(dataFeedback1Hantana.language == 'fa'){
            hantana_hate_p.innerText = "بد";
        }else{
            hantana_hate_p.innerText = "Hate";
        }

        hantana_div_iconImage_main_feedback_hate.appendChild(hantana_hate_icon);
        hantana_div_iconImage_main_feedback_hate.appendChild(hantana_hate_p);
        hantana_div_icons_main_feedback.appendChild(hantana_div_iconImage_main_feedback_hate);




        //dislike icon
        var hantana_div_iconImage_main_feedback_dislike = document.createElement('div');
        hantana_div_iconImage_main_feedback_dislike.className = "div_img_main_hantana";
        hantana_div_iconImage_main_feedback_dislike.id = "thisArrowHantana2";
        var hantana_dislike_icon = document.createElement(iconsElementType);
        hantana_dislike_icon.alt = "dislike";
        hantana_dislike_icon.className = "img_hantana_main_feedback_1";
        hantana_dislike_icon.id = "img_hantana_main_feedback_id_2";
        hantana_dislike_icon.setAttribute("valueArrowHantana", "2");
        if(previewFeedbackFlag == 1){
            hantana_dislike_icon.src = 'https://hantana.org/widgets/img/emoji/' + iconPack + '/Dislike.svg';
        }else{
            hantana_dislike_icon.innerHTML = iconPack[3];
        }
        hantana_dislike_icon.onmousedown = function() {return false}
        hantana_dislike_icon.onclick = function() {
            openFeedBackAreaHantana(this)
        }
        hantana_dislike_icon.onmouseover = function() {
            hoverOnIconTypesHantana(this)
        }
        hantana_dislike_icon.onmouseout = function() {
            hoverOnIconTypesLeaveHantana()
        }

        var hantana_dislike_p = document.createElement('p');
        hantana_dislike_p.className = "animated_hantana fadeIn_hantana_animate label_under_images_hantana";
        hantana_dislike_p.id = "label_under_images_hantana_id_2";
        if(dataFeedback1Hantana.language == 'fa'){
            hantana_dislike_p.innerText = "ضعیف";
        }else{
            hantana_dislike_p.innerText = "Dislike";
        }
        hantana_div_iconImage_main_feedback_dislike.appendChild(hantana_dislike_icon);
        hantana_div_iconImage_main_feedback_dislike.appendChild(hantana_dislike_p);
        hantana_div_icons_main_feedback.appendChild(hantana_div_iconImage_main_feedback_dislike);




        //neutral icon
        var hantana_div_iconImage_main_feedback_neutral = document.createElement('div');
        hantana_div_iconImage_main_feedback_neutral.className = "div_img_main_hantana";
        hantana_div_iconImage_main_feedback_neutral.id = "thisArrowHantana3";
        var hantana_neutral_icon = document.createElement(iconsElementType);
        hantana_neutral_icon.alt = "neutral";
        hantana_neutral_icon.className = "img_hantana_main_feedback_1";
        hantana_neutral_icon.id = "img_hantana_main_feedback_id_3";
        hantana_neutral_icon.setAttribute("valueArrowHantana", "3");
        if(previewFeedbackFlag == 1){
            hantana_neutral_icon.src = 'https://hantana.org/widgets/img/emoji/' + iconPack + '/Neutral.svg';
        }else{
            hantana_neutral_icon.innerHTML = iconPack[2];
        }
        hantana_neutral_icon.onmousedown = function() {return false}
        hantana_neutral_icon.onclick = function() {
            openFeedBackAreaHantana(this)
        }
        hantana_neutral_icon.onmouseover = function() {
            hoverOnIconTypesHantana(this)
        }
        hantana_neutral_icon.onmouseout = function() {
            hoverOnIconTypesLeaveHantana()
        }

        var hantana_neutral_p = document.createElement('p');
        hantana_neutral_p.className = "animated_hantana fadeIn_hantana_animate label_under_images_hantana";
        hantana_neutral_p.id = "label_under_images_hantana_id_3";
        if(dataFeedback1Hantana.language == 'fa'){
            hantana_neutral_p.innerText = "متوسط";
        }else{
            hantana_neutral_p.innerText = "Neutral";
        }

        hantana_div_iconImage_main_feedback_neutral.appendChild(hantana_neutral_icon);
        hantana_div_iconImage_main_feedback_neutral.appendChild(hantana_neutral_p);
        hantana_div_icons_main_feedback.appendChild(hantana_div_iconImage_main_feedback_neutral);




        //like icon
        var hantana_div_iconImage_main_feedback_like = document.createElement('div');
        hantana_div_iconImage_main_feedback_like.className = "div_img_main_hantana";
        hantana_div_iconImage_main_feedback_like.id = "thisArrowHantana4";
        var hantana_like_icon = document.createElement(iconsElementType);
        hantana_like_icon.alt = "like";
        hantana_like_icon.className = "img_hantana_main_feedback_1";
        hantana_like_icon.id = "img_hantana_main_feedback_id_4";
        hantana_like_icon.setAttribute("valueArrowHantana", "4");
        if(previewFeedbackFlag == 1){
            hantana_like_icon.src = 'https://hantana.org/widgets/img/emoji/' + iconPack + '/Like.svg';
        }else{
            hantana_like_icon.innerHTML = iconPack[1];
        }
        hantana_like_icon.onmousedown = function() {return false}
        hantana_like_icon.onclick = function() {
            openFeedBackAreaHantana(this)
        }
        hantana_like_icon.onmouseover = function() {
            hoverOnIconTypesHantana(this)
        }
        hantana_like_icon.onmouseout = function() {
            hoverOnIconTypesLeaveHantana()
        }

        var hantana_like_p = document.createElement('p');
        hantana_like_p.className = "animated_hantana fadeIn_hantana_animate label_under_images_hantana";
        hantana_like_p.id = "label_under_images_hantana_id_4";
        if(dataFeedback1Hantana.language == 'fa'){
            hantana_like_p.innerText = "خوب";
        }else{
            hantana_like_p.innerText = "Like";
        }

        hantana_div_iconImage_main_feedback_like.appendChild(hantana_like_icon);
        hantana_div_iconImage_main_feedback_like.appendChild(hantana_like_p);
        hantana_div_icons_main_feedback.appendChild(hantana_div_iconImage_main_feedback_like);




        //love icon
        var hantana_div_iconImage_main_feedback_love = document.createElement('div');
        hantana_div_iconImage_main_feedback_love.className = "div_img_main_hantana";
        hantana_div_iconImage_main_feedback_love.id = "thisArrowHantana5";
        var hantana_love_icon = document.createElement(iconsElementType);
        hantana_love_icon.alt = "love";
        hantana_love_icon.className = "img_hantana_main_feedback_1";
        hantana_love_icon.id = "img_hantana_main_feedback_id_5";
        hantana_love_icon.setAttribute("valueArrowHantana", "5");
        if(previewFeedbackFlag == 1){
            hantana_love_icon.src = 'https://hantana.org/widgets/img/emoji/' + iconPack + '/Love.svg';
        }else{
            hantana_love_icon.innerHTML = iconPack[0];
        }
        hantana_love_icon.onmousedown = function() {return false}
        hantana_love_icon.onclick = function() {
            openFeedBackAreaHantana(this)
        }
        hantana_love_icon.onmouseover = function() {
            hoverOnIconTypesHantana(this)
        }
        hantana_love_icon.onmouseout = function() {
            hoverOnIconTypesLeaveHantana()
        }

        var hantana_love_p = document.createElement('p');
        hantana_love_p.className = "animated_hantana fadeIn_hantana_animate label_under_images_hantana";
        hantana_love_p.id = "label_under_images_hantana_id_5";
        if(dataFeedback1Hantana.language == 'fa'){
            hantana_love_p.innerText = "عالی";
        }else{
            hantana_love_p.innerText = "Love";
        }


        hantana_div_iconImage_main_feedback_love.appendChild(hantana_love_icon);
        hantana_div_iconImage_main_feedback_love.appendChild(hantana_love_p);
        hantana_div_icons_main_feedback.appendChild(hantana_div_iconImage_main_feedback_love);




        //text area div
        var hantana_div_textArea_feedback = document.createElement('div');
        hantana_div_textArea_feedback.className = "div_hantana_main_100_feedback animated_hantana fadeIn_hantana_animate";
        hantana_div_textArea_feedback.id = "textArea_hantana_main_feedback_id";
        hantana_div_main_feedback.appendChild(hantana_div_textArea_feedback);

        //text area into hantana_div_textArea_feedback
        var hantana_textArea_feedback = document.createElement('textarea');
        hantana_textArea_feedback.className = "textArea_hantana_main_feedback_1 animated_hantana hingeFlipIn_hantana_animate";
        hantana_textArea_feedback.id = "textArea_hantana_main_feedback_id_this";
        hantana_textArea_feedback.style.cssText = 'scrollbar-color: #'+c1+' transparent;scrollbar-width: thin;';
        hantana_textArea_feedback.placeholder = dataFeedback1Hantana.textAreaPlaceholder;
        hantana_textArea_feedback.onkeyup = function() {
            onChangeMainTextAreaHantana(this.value)
        }
        hantana_div_textArea_feedback.appendChild(hantana_textArea_feedback);


        // vars
        var selectAreaFlag = false;
        
        if(dataFeedback1Hantana.screenShotType){

            var darkDivScreenShot = document.createElement('div');
            var topSection = document.createElement('div');
            var bttomSection = document.createElement('div');
            var leftSection = document.createElement('div');
            var rightSection = document.createElement('div');
            var closeSelection = document.createElement('div');
            var reSelect = document.createElement('div');
            var hoverSelectedArea = document.createElement('div');
            hoverSelectedArea.id = "hoverSelectedArea_id";
            var borderArea = document.createElement('div');
            var mainSelectAreaDiv = document.createElement('div');
            mainSelectAreaDiv.id = "mainSelectAreaDiv";
            var winX = null, winY = null;

            window.addEventListener('scroll', function () {
                if (winX !== null && winY !== null) {
                    window.scrollTo(winX, winY);
                }
            });
            function disableWindowScroll() {
                winX = window.scrollX;
                winY = window.scrollY;
            }
            function enableWindowScroll() {
                winX = null;
                winY = null;
            }


            //screenshot div
            var hantana_div_screenShot_feedback = document.createElement('div');
            hantana_div_screenShot_feedback.className = "hantana_div_screenShot_feedback";
            hantana_div_screenShot_feedback.id = "hantana_div_screenShot_feedback_id";
            hantana_div_textArea_feedback.appendChild(hantana_div_screenShot_feedback);

            //tooltip screenshot
            var hantana_tooltip_screenShot_feedback = document.createElement('div');
            hantana_tooltip_screenShot_feedback.className = "hantana_tooltip_screenShot";
            if(dataFeedback1Hantana.language == 'fa'){
                if(window._hantanaSettings.tId == '6173e-18e26-02b75-216a4'){//rtlTheme
                    hantana_tooltip_screenShot_feedback.innerText = "می‌توانید یک قسمت از صفحه را انتخاب کنید";
                }else{
                    hantana_tooltip_screenShot_feedback.innerText = "لطفا یک قسمت از صفحه را انتخاب کنید";
                }
            }else{
                hantana_tooltip_screenShot_feedback.innerText = "Select an element on the page";
            }
            hantana_div_screenShot_feedback.appendChild(hantana_tooltip_screenShot_feedback);

            //img screenshot
            var hantana_img_screenShot_feedback = document.createElement('img');
            hantana_img_screenShot_feedback.className = "hantana_img_screenShot_feedback";
            hantana_img_screenShot_feedback.id = "hantana_img_screenShot_feedback_id";
            hantana_img_screenShot_feedback.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABXFBMVEUAAAB5fYZ6foZ6foV3fYh6foZ4fYd6foV6foZtbZJ6fod6foZ5foZ6foV6foZ6foZ3gIh6foZ6foZ5foZ4gId5foZ6foZ6foZ4gId6foV6f4VVVap5fYZ7foh7gIR6foZ6foZ8gId7foZ7gIh6foV6f4dxcY54eId8gId6foZ5f4Z6foZ6f4d7foZ8fIOAgIx8gId6eoV6foV5gIZ7fYZ7fYZ4gIcAAP97foZ3d4h6foZ8fIN6fod6foV0dIt5fYZ6foZ5f4Z4gId7foZ7fYaAgIB6fYV8fIl6foV7foZ7fYeAgIB6foZ6foV7e4R6foZ6foZ6foZ5f4Z7foZ6foZ6fYZ6foZ6f4d5fYZ4gId6foZ6foZ6gIWAgIB5foZ6foZ6fod6f4V6foZ6foZ7f4Z9fYh5fYZ4fYd2gIl6foZ5foZ7gIR5fYZ6foZ7gIh6fYV6foZmZpl6foYAAAB41iAJAAAAcnRSTlMAv/2GL+81gMQH2PppSfXmHvvbZyTU3c0ibZ0DvU862fJAnj5BowkRQtWP35/OIxREGXUmbrVGAaIP3iXabws/8ZEgnLMIYCnW0GYK6ogd1+38i8zLrfmhu0jP8ywCYZiMmZbogys3MRrupjR4yDxa+AWPjrZNAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB+QLGxIlAqiW1G4AAAF0SURBVDjLjZJXU8JQEIXXQOgCCgalKAoIVq4oTVEUCSrYsGADwd7b/v8HAyEmkJDxPO09+83Onp0LfUhpQEsjrQM9hQYwmtBsgX4r2uzQEg4MOsA5xLiGYYRh3ODxMiYfjI75cZwHKAYUNYEBvtA4lIFgaBL+J61T2Q9H2gU9pQxMo66dYkYZmBVS0HO9Jmj5QjevDESJzFqILSqR+iWhiiEVTySFVyCVbl9yWbBWKETMrK4Jl8zKUsSxqfWNXPOxKaQwuP+ABPKi8iQJbGFLtk5yGwXtFEuCa/SIhAVF7e7t8+aBVwRKhxICy3kiO/URduq4yII5IwFy5S4CT8Dik+552tWvnHUFyUqa/nM94X7VxWgHcck3r1KOao13rJkO4JoHJJPRXw9CuHHTiEKgfssa71pAUQRsiCGIcB6BFGIB7lvAgwjYSZDb5JE8AaQjpArPFa7/UoPeeuWAvEof3jjgXQ2AD8RPVeALv1lV4Mclve8v2L9vuKKSulcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMTEtMjdUMTg6Mzc6MDIrMDA6MDC8cesUAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTExLTI3VDE4OjM3OjAyKzAwOjAwzSxTqAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=";
            hantana_img_screenShot_feedback.onclick = function() {
                goToSelectPartOfPageInHantana(1);
            }
            if(window._hantanaSettings.tId == '6173e-18e26-02b75-216a4'){//rtlTheme
                hantana_tooltip_screenShot_feedback.style.display = 'block';
            }else{
                hantana_img_screenShot_feedback.onmouseover = function() {
                    hantana_tooltip_screenShot_feedback.style.display = 'block';
                }
                hantana_img_screenShot_feedback.onmouseout = function() {
                    hantana_tooltip_screenShot_feedback.style.display = 'none';
                }
            }
            hantana_div_screenShot_feedback.appendChild(hantana_img_screenShot_feedback);

       
            document.addEventListener("click",(e)=>{
                var evClassList = event.target.classList;
                if(selectAreaFlag && (!evClassList.contains('svgCloseScreenShotTop') && !evClassList.contains('divScreenShotTop') && !evClassList.contains('pScreenShotTop') && !evClassList.contains('darkDivScreenShotMain') && !evClassList.contains('darkDivScreenShotMainTop'))){
                    e.stopPropagation();
                    e.preventDefault();
                    goToSelectPartOfPageInHantana(3);
                }
            },true);

            document.addEventListener("mouseover", function(event){ 
                var evClassList = event.target.classList;
                if(selectAreaFlag && !evClassList.contains('svgCloseScreenShotTop') && !evClassList.contains('divScreenShotTop') && !evClassList.contains('pScreenShotTop') && !evClassList.contains('darkDivScreenShotMain') && !evClassList.contains('darkDivScreenShotMainTop')){
                    var positionInfo = event.target.getBoundingClientRect();
                    lastSelectionPos = positionInfo;
                    var x = event.clientX;
                    var y = event.clientY;
                    if(hoverSelectedArea.parentNode){ hoverSelectedArea.parentNode.removeChild(hoverSelectedArea); }                
                    if(topSection.parentNode){ topSection.parentNode.removeChild(topSection); }
                    if(bttomSection.parentNode){ bttomSection.parentNode.removeChild(bttomSection); }
                    if(leftSection.parentNode){ leftSection.parentNode.removeChild(leftSection); }
                    if(rightSection.parentNode){ rightSection.parentNode.removeChild(rightSection); }

                    topSection.style.cssText = 'top: 0; right: 0; width: ' + (document.documentElement.clientWidth || document.body.clientWidth) + 'px; left: 0; bottom: auto; background: rgba(0, 0, 0, 0.45); position: fixed; z-index: 2147483500;height:' + (positionInfo.y + 2) + 'px';
                    mainSelectAreaDiv.appendChild(topSection);

                    bttomSection.style.cssText = 'top: ' + ((positionInfo.y + positionInfo.height) - 2) + 'px; right: 0; width: ' + (document.documentElement.clientWidth || document.body.clientWidth) + 'px; left: 0; bottom: 0; background: rgba(0, 0, 0, 0.45); position: fixed; z-index: 2147483500;height:' + (((document.documentElement.clientHeight || document.body.clientHeight) - (positionInfo.y + positionInfo.height)) + 2) + 'px';
                    mainSelectAreaDiv.appendChild(bttomSection);

                    leftSection.style.cssText = 'top: ' + (positionInfo.y + 2) + 'px; right: auto; width: ' + (positionInfo.x + 2) + 'px; left: 0; bottom: auto; background: rgba(0, 0, 0, 0.45); position: fixed; z-index: 2147483500;height:' + (positionInfo.height - 4) + 'px';
                    mainSelectAreaDiv.appendChild(leftSection);

                    rightSection.style.cssText = 'top: ' + (positionInfo.y + 2) + 'px; right: 0; width: ' + (((document.documentElement.clientWidth || document.body.clientWidth) - (positionInfo.x + positionInfo.width)) + 2) + 'px; left: ' + ((positionInfo.x + positionInfo.width) - 2) + 'px; bottom: auto; background: rgba(0, 0, 0, 0.45); position: fixed; z-index: 2147483500;height:' + (positionInfo.height - 4) + 'px';
                    mainSelectAreaDiv.appendChild(rightSection);

                    hoverSelectedArea.style.cssText = "top:0px; left:0; margin-left: "+positionInfo.left+"px; margin-top: "+positionInfo.top+"px; width: "+positionInfo.width+"px; height: "+positionInfo.height+"px;cursor: pointer !important;z-index: 2147483600;pointer-events: none;position: fixed !important;border: 4px dashed #" + c1;
                    document.body.appendChild(hoverSelectedArea);
                }
            }, false);

       
        
            function goToSelectPartOfPageInHantana(run){

                
                if(reSelect.parentNode){ reSelect.parentNode.removeChild(reSelect); }                
                if(closeSelection.parentNode){ closeSelection.parentNode.removeChild(closeSelection); }                
                enableWindowScroll();

                if(run == 1){

                    selectAreaFlag = true;
                    document.getElementsByTagName('html')[0].setAttribute('data-hantana-cursor-pointer','true');


                    document.body.appendChild(mainSelectAreaDiv);


                    darkDivScreenShot.className = "darkDivScreenShotMain";
                    darkDivScreenShot.id = "darkDivScreenShot_id";
                    darkDivScreenShot.style.borderColor = '#' + c1;
                    document.body.appendChild(darkDivScreenShot);

                    var darkDivScreenShotTop = document.createElement('div');
                    darkDivScreenShotTop.className = "darkDivScreenShotMainTop";
                    darkDivScreenShotTop.style.backgroundColor = '#' + c1;
                    darkDivScreenShot.appendChild(darkDivScreenShotTop);

                    var pScreenShotTop = document.createElement('p');
                    pScreenShotTop.className = "pScreenShotTop";
                    if(dataFeedback1Hantana.language == 'fa'){
                        pScreenShotTop.innerText = "یک عنصر بر روی صفحه را انتخاب نمایید";
                    }else{
                        pScreenShotTop.innerText = "Select an element on the page";
                    }
                    darkDivScreenShotTop.appendChild(pScreenShotTop);

                    var divScreenShotTop = document.createElement('div');
                    divScreenShotTop.className = "divScreenShotTop";
                    divScreenShotTop.id = "divCloseScreenShotTop";
                    divScreenShotTop.innerHTML = '<svg class="svgCloseScreenShotTop" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 61 61"><g class="svgCloseScreenShotTop"><line class="svgCloseScreenShotTop" id="Line_1" data-name="Line 1" x2="23.4" y2="23.4" transform="translate(18.8 18.8)" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" stroke-width="2"></line><line class="svgCloseScreenShotTop" x1="23.4" y2="23.4" transform="translate(18.8 18.8)" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" stroke-width="2"></line></g></svg>';
                    divScreenShotTop.onclick = function() {
                        goToSelectPartOfPageInHantana(2);
                        lastSelectionPos = {};
                    }
                    darkDivScreenShotTop.appendChild(divScreenShotTop);
                
                    borderArea.style.cssText = 'top:0px; left:0; width: 100%; height: 100%; position: fixed !important; z-index: 2147483647; border: 4px solid #' + c1 + ' !important; pointer-events: none;';
                    document.body.appendChild(borderArea);
                    
                    hantana_all_divs_data.style.display = 'none';
                    

                }else if(run == 2){
                    selectAreaFlag = false;
                    document.getElementsByTagName('html')[0].removeAttribute('data-hantana-cursor-pointer');
                    hantana_all_divs_data.style.display = 'block';
                    if(darkDivScreenShot.parentNode){ darkDivScreenShot.parentNode.removeChild(darkDivScreenShot); }                
                    if(hoverSelectedArea.parentNode){ hoverSelectedArea.parentNode.removeChild(hoverSelectedArea); }                
                    if(mainSelectAreaDiv.parentNode){ mainSelectAreaDiv.parentNode.removeChild(mainSelectAreaDiv); }
                    if(borderArea.parentNode){ borderArea.parentNode.removeChild(borderArea); }
                    hantana_img_screenShot_feedback.style.opacity = '0.6';

                }else if(run == 3){
                    selectAreaFlag = false;
                    document.getElementsByTagName('html')[0].removeAttribute('data-hantana-cursor-pointer');
                    hantana_all_divs_data.style.display = 'block';
                    if(darkDivScreenShot.parentNode){ darkDivScreenShot.parentNode.removeChild(darkDivScreenShot); }
                    if(borderArea.parentNode){ borderArea.parentNode.removeChild(borderArea); }
                    hoverSelectedArea.style.borderStyle = 'solid';
                    hantana_img_screenShot_feedback.style.opacity = '1';

                    closeSelection.innerHTML = '<svg class="svgCloseScreenShotTop" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 61 61"><g class="svgCloseScreenShotTop"><line class="svgCloseScreenShotTop" id="Line_1" data-name="Line 1" x2="23.4" y2="23.4" transform="translate(18.8 18.8)" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" stroke-width="2"></line><line class="svgCloseScreenShotTop" x1="23.4" y2="23.4" transform="translate(18.8 18.8)" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" stroke-width="2"></line></g></svg>';
                    closeSelection.style.cssText = 'background: #'+c1+'; position: fixed !important; left: '+((lastSelectionPos.x + lastSelectionPos.width) - 14)+'px; top: '+((lastSelectionPos.y) - 10)+'px; width: 23px; height: 23px; border-radius: 50px; z-index: 2147483600; pointer-events: auto;';
                    closeSelection.onclick = function() {
                        goToSelectPartOfPageInHantana(2);
                        lastSelectionPos = {};
                    }
                    hoverSelectedArea.appendChild(closeSelection);
                    if(dataFeedback1Hantana.language == 'fa'){
                        reSelect.innerText = "تغییر";
                    }else{
                        reSelect.innerText = "change";
                    }
                    reSelect.style.cssText = 'background: #'+c1+';  position: fixed !important; left: '+((lastSelectionPos.x + lastSelectionPos.width) - 64)+'px; top: '+((lastSelectionPos.y + lastSelectionPos.height) - 4)+'px; width: 64px; height: 29px; border-radius: 0 0 5px 5px; z-index: 2147483600; pointer-events: auto; text-align: center; color: #fff; font-family: hantanaVazir;font-size: 14px;padding-top: 4px !important;';
                    reSelect.onclick = function() {
                        goToSelectPartOfPageInHantana(1);
                    }
                    hoverSelectedArea.appendChild(reSelect);

                    disableWindowScroll();


                }

            }

        }

        //description text after textarea
        var hantana_des_text_feedback = document.createElement('p');
        if(dataFeedback1Hantana.descriptionTextFlag){
            hantana_des_text_feedback.className = "des_text_show_hantana";
            hantana_des_text_feedback.innerText = dataFeedback1Hantana.descriptionText;
        }
        hantana_div_textArea_feedback.appendChild(hantana_des_text_feedback);



        //div all button and powerd
        var hantana_div_btn_powerd_feedback = document.createElement('div');
        hantana_div_btn_powerd_feedback.className = "div_hantana_main_100_feedback div_hantana_power_btn_main_1";
        hantana_div_main_feedback.appendChild(hantana_div_btn_powerd_feedback);


        //div powerd
        var hantana_div_powerd_feedback = document.createElement('div');
        hantana_div_powerd_feedback.className = "div_hantana_main_50_feedback text_left_hantana";
        hantana_div_btn_powerd_feedback.appendChild(hantana_div_powerd_feedback);

        //div button
        var hantana_div_btn_feedback = document.createElement('div');
        hantana_div_btn_feedback.className = "div_hantana_main_50_feedback text_right_hantana";
        hantana_div_btn_powerd_feedback.appendChild(hantana_div_btn_feedback);


        // text p into powerd
        var hantana_p_powerd_feedback = document.createElement('p');
        hantana_p_powerd_feedback.className = "p_hantana_main_feedback_2";
        hantana_p_powerd_feedback.id = 'p_hantana_main_feedback_2_id';
        if(dataFeedback1Hantana.showHantanaBrand == true || checkAccountUserResultHantana == 0 || checkAccountUserResultHantana == 1){
            var urlDataSourceHantana = 'https://hantana.org/?utm_source='+window.location.href+'&utm_medium=widget&utm_campaign=referral-poweredBy&device='+userAgentHantana()+'&widgetCode=1';
            if(dataFeedback1Hantana.language == 'fa'){
                hantana_p_powerd_feedback.innerHTML = '<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_feedback_logo_power_fa" onmousedown="return false;" src="'+poweredByImgDark+'" alt="سرویس تحلیل رفتار کاربران وب سایت" /></a>قدرت گرفته از <a href="https://hantana.org/" target="_blank"></a>';
            }else{
                hantana_p_powerd_feedback.innerHTML = 'powered by<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_feedback_logo_power_en" onmousedown="return false;" src="'+poweredByImgDark+'" alt="سرویس تحلیل رفتار کاربران وب سایت" /></a>';
            }
        }
        hantana_div_powerd_feedback.appendChild(hantana_p_powerd_feedback);



        // button into powerd
        var hantana_btn_feedback = document.createElement('button');
        hantana_btn_feedback.className = "btn_hantana_main_feedback";
        hantana_btn_feedback.id = 'btn_hantana_main_feedback_id';
        hantana_btn_feedback.innerText = dataFeedback1Hantana.buttonSendText;
        hantana_btn_feedback.disabled = true;
        hantana_btn_feedback.onclick = function() {
            if(previewFeedbackFlag == undefined){
                sendFeedBackBtnHantana()
            }
         
        }
        hantana_div_btn_feedback.appendChild(hantana_btn_feedback);



        //set rtl ltr
        if(dataFeedback1Hantana.language == 'fa'){
            hantana_textArea_feedback.style.direction = 'rtl';
            hantana_message_show_1.style.direction = 'rtl';
            hantana_message_show_text.style.direction = 'rtl';
            hantana_des_text_feedback.style.direction = 'rtl';
            hantana_btn_feedback.style.direction = 'rtl';
        }else if(dataFeedback1Hantana.language == 'en'){
            hantana_textArea_feedback.style.direction = 'ltr';
            hantana_message_show_1.style.direction = 'ltr';
            hantana_message_show_text.style.direction = 'ltr';
            hantana_des_text_feedback.style.direction = 'ltr';
            hantana_btn_feedback.style.direction = 'ltr';
        }




        //append hantana_btn in to body
        hantana_all_divs_data.appendChild(hantana_btn);
        hantana_all_divs_data.appendChild(hantana_message_show);
        hantana_all_divs_data.appendChild(hantana_div_main_feedback);

        if(((dataFeedback1Hantana.showInDesktop && userAgentHantana() == 'desktop') || (dataFeedback1Hantana.showInTablet && userAgentHantana() == 'tablet') || (dataFeedback1Hantana.showInMobile && userAgentHantana() == 'mobile')) || flagRequireRunHantana == 'true'){
            document.body.appendChild(hantana_all_divs_data);
        }



        document.onkeydown = function(evt) {
            evt = evt || window.event;
            var isEscape = false;
            if ("key" in evt) {
                isEscape = (evt.key === "Escape" || evt.key === "Esc");
            } else {
                isEscape = (evt.keyCode === 27);
            }
            if (isEscape) {
                closeHantanaMainFeedBack();
            }
        };




        function openAutoMainBox(second) {
            setTimeout(function () {
                openHantanaDivMainFeedback();
            },(second * 1000));
        }

        function showWelcomeHantanaMainFeedBack() {
            setTimeout(function () {
                var hasDisplayNone = (hantana_div_main_feedback.offsetHeight === 0 && hantana_div_main_feedback.offsetWidth === 0);
                if(hasDisplayNone == true){
                    hantana_message_show.style.display = 'block';
                }
            },1500);
        }
        function hideWelcomeHantanaMainFeedBack() {
            setTimeout(function () {
                hantana_message_show.style.display = 'none';
            },10000);
        }
        function closeAfterHantanaMainFeedBack() {
            hantana_message_show.style.display = 'none';
        }
        function onHoverInAfterBackBoxHantana() {
            hantana_message_show_close.style.display = 'inline-block';
        }
        function uHoverInAfterBackBoxHantana() {
            hantana_message_show_close.style.display = 'none';
        }
        
        function openHantanaDivMainFeedback(){
            if(dataFeedback1Hantana.position == 'right' || dataFeedback1Hantana.position == 'left'){
                hantana_btn.style.display = 'none';
                hantana_div_main_feedback.style.display = "inline-block";
            }else{
                var displayMain = hantana_div_main_feedback.style.display;
                if (displayMain === "" || displayMain === "none") {
                    hantana_div_main_feedback.style.display = "inline-block";
                    hantana_btn_img.style.width = '18px';
                    hantana_btn_img.style.margin = '4px 0 0 0';
                    hantana_btn_img.src = closeImageHantana;
                } else {
                    closeHantanaMainFeedBack();
                    hantana_btn_img.style.width = '28px';
                    hantana_btn_img.style.margin = '-1px 0 0 0';
                    hantana_btn_img.src = imageOnBtnFeedbackHantana;
                }
            }
            
            hantana_message_show.style.display = 'none';

            
           
            if (document.documentElement.clientWidth < 450) {
                if(dataFeedback1Hantana.position == 'right'){
                    var offsetWidthRight = (hantana_div_main_feedback.offsetWidth / 2) - 4;
                    hantana_div_main_feedback.style.right  = '-'+offsetWidthRight+'px';
                }else if(dataFeedback1Hantana.position == 'left'){
                    var offsetWidthRight = (hantana_div_main_feedback.offsetWidth / 2) ;                
                    hantana_div_main_feedback.style.left  = offsetWidthRight + 'px';
                }else if(dataFeedback1Hantana.position == 'float-right'){
                    hantana_div_main_feedback.style.right = '0px';
                }else if(dataFeedback1Hantana.position == 'float-left'){             
                    hantana_div_main_feedback.style.left  = '0px';
                }
            }
        }
        function hoverOnIconTypesHantana(thisItem) {
            if(!flagClick) {
                var elements = document.getElementsByClassName('label_under_images_hantana');
                for(var i=0; i<elements.length; i++) {
                    elements[i].style.display = 'none';
                }
                var valueArrowHantana = thisItem.getAttribute("valueArrowHantana");
                document.getElementById('label_under_images_hantana_id_'+valueArrowHantana+'').style.display = 'block';
                hantana_hate_icon.style.opacity = "0.4";
                hantana_dislike_icon.style.opacity = "0.4";
                hantana_neutral_icon.style.opacity = "0.4";
                hantana_like_icon.style.opacity = "0.4";
                hantana_love_icon.style.opacity = "0.4";
                thisItem.style.opacity = "1";
            }
        }
        function hoverOnIconTypesLeaveHantana() {
            if(!flagClick){
                hantana_hate_p.style.display = 'none';
                hantana_dislike_p.style.display = 'none';
                hantana_neutral_p.style.display = 'none';
                hantana_like_p.style.display = 'none';
                hantana_love_p.style.display = 'none';
                hantana_hate_icon.style.opacity = "1";
                hantana_dislike_icon.style.opacity = "1";
                hantana_neutral_icon.style.opacity = "1";
                hantana_like_icon.style.opacity = "1";
                hantana_love_icon.style.opacity = "1";
            }
        }


        function openFeedBackAreaHantana(thisItem) {
            if (!hantana_textArea_feedback.disabled){


                flagClick = true;
                var elements = document.getElementsByClassName('img_hantana_main_feedback_1');
                for(var i=0; i<elements.length; i++) {
                    elements[i].style.width = '46px';
                    elements[i].style.marginRight = '0px';
                    elements[i].style.marginLeft = '0px';
                }
                var valueTextAreaHantana = hantana_textArea_feedback.value;
                var valueArrowHantana = thisItem.getAttribute("valueArrowHantana");
                var elements = document.getElementsByClassName('div_img_main_hantana');
                for(var i=0; i<elements.length; i++) {
                    elements[i].classList.remove("show-after");
                }
                var elements = document.getElementsByClassName('label_under_images_hantana');
                for(var i=0; i<elements.length; i++) {
                    elements[i].style.display = 'none';
                }
                document.getElementById('thisArrowHantana'+valueArrowHantana+'').classList.add("show-after");
                document.getElementById('textArea_hantana_main_feedback_id').style.display = 'inline-block';
                hantana_btn_feedback.style.display = 'inline-block';
                var elements = document.getElementsByClassName('img_hantana_main_feedback_1');
                for(var i=0; i<elements.length; i++) {
                    elements[i].style.opacity = "0.4";
                }
                thisItem.style.opacity = "1";
                selectedStatus = valueArrowHantana;

                if(valueArrowHantana == 5 || valueArrowHantana == 4 || valueTextAreaHantana.length > 3){
                    enableButtonFeedback1SendInHantana();
                }else{
                    enableButtonFeedback1SendInHantana();
                }
            }
        }
        function onChangeMainTextAreaHantana(text) {
            if(text.length > 3 || selectedStatus == 5 || selectedStatus == 4){
                enableButtonFeedback1SendInHantana();
            }else{
                enableButtonFeedback1SendInHantana();
                // disableButtonFeedback1SendInHantana();
            }
        }
        function enableButtonFeedback1SendInHantana() {
            hantana_btn_feedback.style.background = '#'+c1+'';
            hantana_btn_feedback.style.color = '#'+c4+'';
            hantana_btn_feedback.style.boxShadow = "0 2px 3px 0 rgba(0, 0, 0, 0.15)";
            hantana_btn_feedback.style.cursor = "pointer";
            hantana_btn_feedback.disabled = false;
        }
        function disableButtonFeedback1SendInHantana() {
            hantana_btn_feedback.style.background = '#'+c2+'';
            hantana_btn_feedback.style.color = '#'+c3+'';
            hantana_btn_feedback.style.boxShadow = "none";
            hantana_btn_feedback.style.cursor = "auto";
            hantana_btn_feedback.disabled = true;
        }

        function closeHantanaMainFeedBack() {
            flagClick = false;
            hantana_btn_feedback.innerText = dataFeedback1Hantana.buttonSendText;
            hantana_div_main_feedback.style.display = 'none';
            hantana_div_textArea_feedback.style.display = 'none';
            hantana_btn.style.display = 'inline-block';
            hantana_btn_feedback.style.display = 'none';
            hantana_textArea_feedback.value = '';
            var elements = document.getElementsByClassName('img_hantana_main_feedback_1');
            for(var i=0; i<elements.length; i++) {
                elements[i].style.opacity = "1";
            }
            var elements = document.getElementsByClassName('div_img_main_hantana');
            for(var i=0; i<elements.length; i++) {
                elements[i].classList.remove("show-after");
            }
            var elements = document.getElementsByClassName('img_hantana_main_feedback_1');
            for(var i=0; i<elements.length; i++) {
                elements[i].style.width = '52px';
                // elements[i].style.marginRight = '-3px';
                // elements[i].style.marginLeft = '-3px';
            }

        }







        function saveDataHantanaFeedback(canvas, ipDetail, text, selectedStatus, indexData, screenShotType) {
            var setUserData = getDataUserApi();
            // console.log(screenShotType)
            // window.open(canvas.toDataURL("image/png", 1.0));
            var request = new XMLHttpRequest();
            // POST to httpbin which returns the POST data as JSON
            // request.open('POST', 'http://localhost:5000/widget/newFeedback', /* async = */ false);
            request.open('POST', 'https://hantana.org/widget/newFeedback', true);
            var formData = new FormData();
            formData.append('ipDetail', ipDetail);
            formData.append('text', text);
            formData.append('selectedStatus', selectedStatus);
            formData.append('urlData', window.location.href);
            formData.append('siteToken', window._hantanaSettings.tId);
            formData.append('userAgent', navigator.userAgent);
            if(screenShotType == 1){
                var canvasData = canvas.toDataURL("image/png", 1.0);
                formData.append('base64image', canvasData);
            }else{
                formData.append('base64image', '');
            }
            formData.append('screenHeight', window.screen.height);
            formData.append('screenWidth', window.screen.width);
            formData.append('indexData', indexData);
            formData.append('device',  userAgentHantana());
            formData.append('setUserData', JSON.stringify(setUserData));
            request.send(formData);
            // if(window._hantanaSettings.log){
            //     console.log('send feedback', request.responseText)
            // }
        }
        

        function sendFeedBackBtnHantana() {
            var text = hantana_textArea_feedback.value;
            if(text.length >= 0){
            // if(text.length > 3 || selectedStatus == 5 || selectedStatus == 4){

                disableButtonFeedback1SendInHantana();
                hantana_btn_feedback.innerText = dataFeedback1Hantana.buttonSendWaitText;
                hantana_textArea_feedback.disabled = true;

                hantana_textArea_feedback.disabled = false;
                hantana_textArea_feedback.value = '';
                setAfterSendIntoFeedbackEmpty();
                closeHantanaMainFeedBack();

                if(dataFeedback1Hantana.position == "float-right" || dataFeedback1Hantana.position == "float-left"){
                    hantana_btn_img.style.width = '28px';
                    hantana_btn_img.style.margin = '-1px 0 0 0';
                    hantana_btn_img.src = imageOnBtnFeedbackHantana;
                }
                

                if(window.Hantana.hideFeedbackAfterSend){
                    if(window.Hantana.hideFeedbackAfterSendFlag){
                        localStorage.showFeedbackHantanaAfterUseFlag = 'false';
                    }
                    // != undefined
                    var second = window.Hantana.hideFeedbackAfterSend;
                    if(isNaN(second) || Number(second) == 0){
                        hantana_all_divs_data.style.display = 'none';
                    }else{
                        showAfterSendIntoFeedback(dataFeedback1Hantana.thankYouText);
                        setTimeout(function(){
                            hantana_all_divs_data.style.display = 'none';
                        },second * 1000);
                    }
                }else{
                    showAfterSendIntoFeedback(dataFeedback1Hantana.thankYouText);
                }


                if(dataFeedback1Hantana.screenShotType){

                  

                    if(lastSelectionPos.x && lastSelectionPos.y && lastSelectionPos.width && lastSelectionPos.height){
                        goToSelectPartOfPageInHantana(2);
                    }

                    html2canvas(document.getElementsByTagName('body')[0],{height:window.innerHeight, y: window.pageYOffset, logging: false,background: '#FFFFFF'}).then(function(canvas) {

                        if(lastSelectionPos.x && lastSelectionPos.y && lastSelectionPos.width && lastSelectionPos.height){
                            const ctxDarker = canvas.getContext('2d');
                            ctxDarker.beginPath();
                            ctxDarker.rect(0, 0, canvas.width, lastSelectionPos.y);
                            ctxDarker.rect(0, (lastSelectionPos.y + lastSelectionPos.height), canvas.width, ((canvas.width) - (lastSelectionPos.y + lastSelectionPos.height)));
                            ctxDarker.rect(0, lastSelectionPos.y, lastSelectionPos.x, lastSelectionPos.height);
                            ctxDarker.rect((lastSelectionPos.x + lastSelectionPos.width), (lastSelectionPos.y),  ((canvas.width) - (lastSelectionPos.x + lastSelectionPos.width)), lastSelectionPos.height);
                            ctxDarker.fillStyle = "rgb(0,0,0,0.45)";
                            ctxDarker.fill();
                            lastSelectionPos = {};
                        }

                        saveDataHantanaFeedback(canvas, ipDetail, text, selectedStatus, feedbackIndex, 1);
                    });
                }else{
                    saveDataHantanaFeedback('', ipDetail, text, selectedStatus, feedbackIndex, 0);
                }
                

            }
        }

        function setAfterSendIntoFeedbackEmpty() {
            setTimeout(function () {
                hantana_message_show.style.display = 'none';
            },2500);
        }
        function showAfterSendIntoFeedback(after_text_hantana_main_feedback_id) {
            hantana_message_show_text.innerText = after_text_hantana_main_feedback_id;
            hantana_message_show.style.display = 'block';
        }



        //feedback1 client apis
        window.Hantana.openFeedback = function (second) {
            setTimeout(function(){
                openHantanaDivMainFeedback();
            },second * 1000);
        };
        window.Hantana.closeFeedback  = function (second) {
            setTimeout(function(){
                closeHantanaMainFeedBack();
            },second * 1000);
        };
        window.Hantana.toggleFeedback = function (second) {
            setTimeout(function(){
                var hasDisplayNone = (hantana_div_main_feedback.offsetHeight === 0 && hantana_div_main_feedback.offsetWidth === 0);
                if(hasDisplayNone == true){
                    openHantanaDivMainFeedback();
                }else{
                    closeHantanaMainFeedBack();
                }
            },second * 1000);
        };
        // window.Hantana.setButtonTextFeedback = function (text) {
        //     hantana_btn_open_1.innerText = text;
        // }
        window.Hantana.setTitleFeedback = function (title) {
            hantana_p_main_close_feedback.innerText = title;
        }

        window.Hantana.setWelcomeMessageFeedback = function (message, timeOpen, timeClose) {
            if(!dataFeedback1Hantana.welcomeMessageFlag){
                setTimeout(function () {
                    showAfterSendIntoFeedback(message);
                    setTimeout(function () {
                        hantana_message_show.style.display = 'none';
                    },timeClose);
                },timeOpen);
            }
        }

        window.Hantana.setDescriptionTextFeedback = function (title) {
            hantana_des_text_feedback.className = "des_text_show_hantana";
            hantana_des_text_feedback.innerText = title;
        }
        

        window.Hantana.setPlaceholderTextBoxFeedback = function (placeholder) {
            hantana_textArea_feedback.placeholder = placeholder;
        }
        window.Hantana.hideAfterSendFeedback = function (second, flag = false) {
            window.Hantana.hideFeedbackAfterSend = second.toString();
            window.Hantana.hideFeedbackAfterSendFlag = flag;
        }


        window.Hantana.openWidgetWelcomeMessageOnlyOnceFeedback = function (forAllTime = false) {
            if(forAllTime){
                window.localStorage.setItem('openTheWidgetOnlyOnceFeedbackFlagHantana', feedbackIndex.toString());
            }else{
                if(window.localStorage.openTheWidgetOnlyOnceFeedbackFlagHantana){
                    window.localStorage.removeItem('openTheWidgetOnlyOnceFeedbackFlagHantana');
                }
            }
            window.localStorage.setItem('openTheWidgetOnlyOnceFeedbackHantana', feedbackIndex.toString());
        }

        
        onEndRequesAndInjectHantana('feedback');

    }


    //survey popup
    function createSurveysPopupHantana(data){


      

        var hantana_main_div_survey_popup = document.createElement('div');
        hantana_main_div_survey_popup.className = "hantana_main_div_survey_popup";
        hantana_main_div_survey_popup.id = "hantana_main_div_survey_popup_id";
        
       

        var hantana_box_div_survey_popup = document.createElement('div');
        hantana_box_div_survey_popup.className = "hantana_box_div_survey_popup";
        hantana_box_div_survey_popup.id = "hantana_box_div_survey_popup_id";
        hantana_main_div_survey_popup.appendChild(hantana_box_div_survey_popup)


        //close btn
        var hantana_box_100_div_survey_popup = document.createElement('div');
        hantana_box_100_div_survey_popup.className = "hantana_box_100_div_survey_popup";
        hantana_box_div_survey_popup.appendChild(hantana_box_100_div_survey_popup);

        var hantana_box_close_div_survey_popup = document.createElement('img');
        hantana_box_close_div_survey_popup.className = "hantana_box_close_img_div_survey_popup";
        hantana_box_close_div_survey_popup.src = " data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAVCAYAAACg/AXsAAAABHNCSVQICAgIfAhkiAAAABl0RVh0U29mdHdhcmUAZ25vbWUtc2NyZWVuc2hvdO8Dvz4AAAHRSURBVDiN3dTfS1NhGMDx77uNbYdlGsSKXZSoSfaDgqCLGCRBkKUolRhOXYKX/gl1EwR122VX5WgbRs2kH5dpJKeL4c0C54VdabKzOpPc2snOOW8XhZhnp4t2Iz53L+/Dh+fhed5XSCkldYanXmBXI8Yimfu3uPNwhuUNZ6JZUHl09zb3nucxto1iE5HSpFqtsrb4isT0ApUtidJY4k0iQ06v8tMSCOGCCOUYvTfOEfbaFNU0k1kdG0B+I/csyeyqhS/SyWBPOwHXdhCEjvZy80orCut8zDzh7YqBNpfi6XwJGeqgb6SL1uC2MgDhWDa5Ti79gImsDo37aax8oSTDRMfG6WsP4SRqTUc0cPJanIuH/NhrRXQzQMvlOD0uQG0EkD9KfC2bf04b6CsFvv/jcTgRc5V3iTRZXdLQdpzDQUlpfpLEzGfMGoATkRXyU495uWTgDUeJjY4Sv36KJmHw6fUEU/kKtQraglhoapKkqmEHmrk03M0RxUPT6X4Gowfw2hpqMsWHouWO2IVZUtN5yuzlxNUhOiO+3xdCoa17iK6WIJQXeJF+j2a7VWKBx7+H5gsxBs7s+7tPX4TzsQHOHlQI+L2OSpx78h+xE7+COuIXcn2uCiQpS/MAAAAASUVORK5CYII=";
        hantana_box_close_div_survey_popup.style.cssText = "float: right;cursor: pointer;";
        hantana_box_close_div_survey_popup.onclick = function() {
            closeSurveyPopup();
        }
        hantana_box_100_div_survey_popup.appendChild(hantana_box_close_div_survey_popup);
        

        //p1
        var hantana_box_100_div_survey_popup = document.createElement('div');
        hantana_box_100_div_survey_popup.className = "hantana_box_100_div_survey_popup";
        hantana_box_div_survey_popup.appendChild(hantana_box_100_div_survey_popup);

        var hantana_box_p_div_survey_popup = document.createElement('p');
        hantana_box_p_div_survey_popup.className = "hantana_box_p1_div_survey_popup";
        hantana_box_p_div_survey_popup.innerText = data.invitation.title;
        hantana_box_100_div_survey_popup.appendChild(hantana_box_p_div_survey_popup);
        

        //p2
        var hantana_box_100_div_survey_popup = document.createElement('div');
        hantana_box_100_div_survey_popup.className = "hantana_box_100_div_survey_popup";
        hantana_box_div_survey_popup.appendChild(hantana_box_100_div_survey_popup);

        var hantana_box_p2_div_survey_popup = document.createElement('p');
        hantana_box_p2_div_survey_popup.className = "hantana_box_p2_div_survey_popup";
        hantana_box_p2_div_survey_popup.innerText = data.invitation.des;
        hantana_box_100_div_survey_popup.appendChild(hantana_box_p2_div_survey_popup);
        

        //btn open
        var hantana_box_100_div_survey_popup = document.createElement('div');
        hantana_box_100_div_survey_popup.className = "hantana_box_100_div_survey_popup";
        hantana_box_div_survey_popup.appendChild(hantana_box_100_div_survey_popup);

        var hantana_box_btn_div_survey_popup = document.createElement('p');
        hantana_box_btn_div_survey_popup.className = "hantana_box_btn_div_survey_popup";
        hantana_box_btn_div_survey_popup.innerText = data.invitation.btnText;
        hantana_box_btn_div_survey_popup.onclick = function() {
            // window.open(primaryPrefixHantana + 'survey/' + data._id, '_blank');
            window.open(surveyPrefixHantana + data._id, '_blank');
            closeSurveyPopup();
        }
        hantana_box_100_div_survey_popup.appendChild(hantana_box_btn_div_survey_popup);
        

        //p3
        var hantana_box_100_div_survey_popup = document.createElement('div');
        hantana_box_100_div_survey_popup.className = "hantana_box_100_div_survey_popup";
        hantana_box_div_survey_popup.appendChild(hantana_box_100_div_survey_popup);

        var hantana_box_p3_div_survey_popup = document.createElement('p');
        hantana_box_p3_div_survey_popup.className = "hantana_box_p3_div_survey_popup";
        hantana_box_p3_div_survey_popup.innerText = data.invitation.otherText;
        hantana_box_p3_div_survey_popup.onclick = function() {
            closeSurveyPopup();
        }
        hantana_box_100_div_survey_popup.appendChild(hantana_box_p3_div_survey_popup);
        

        //powred
        var hantana_box_100_div_survey_popup = document.createElement('div');
        hantana_box_100_div_survey_popup.className = "hantana_box_100_div_survey_popup";
        hantana_box_div_survey_popup.appendChild(hantana_box_100_div_survey_popup);
        
        var urlDataSourceHantana = 'https://hantana.org/?utm_source='+window.location.href+'&utm_medium=widget&utm_campaign=referral-poweredBy&device='+userAgentHantana()+'&widgetCode=2';

        var hantana_box_p4_div_survey_popup = document.createElement('p');
        hantana_box_p4_div_survey_popup.className = "hantana_box_p4_div_survey_popup";
        hantana_box_p4_div_survey_popup.innerHTML = '<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_survey_logo_power_fa" onmousedown="return false;" src="'+poweredByImgDark+'" /></a>قدرت گرفته از';
        hantana_box_100_div_survey_popup.appendChild(hantana_box_p4_div_survey_popup);
        

        function closeSurveyPopup(){
            hantana_main_div_survey_popup.style.opacity = '0'
            hantana_main_div_survey_popup.addEventListener('transitionend', function(){
                hantana_main_div_survey_popup.style.setProperty("display", "none", "important");
            });
        }

        
       
       
        var fadeInSurveyAlert = function fadeIn(element, duration) {
            (function increment() {
                var value = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];
                element.style.opacity = String(value);
                if (element.style.opacity !== '1') {
                    setTimeout(function () {
                        increment(value + 0.1);
                    }, duration / 10);
                }
            })();
        };
         // var fadeOutSurveyAlert = function fadeOut(element, duration) {
        //     (function decrement() {
        //         (element.style.opacity -= 0.1) < 0 ? element.style.display = 'none' : setTimeout(function () {
        //             decrement();
        //         }, duration / 10);
        //     })();
        // };

       


        if(((data.showInDesktop && userAgentHantana() == 'desktop') || (data.showInTablet && userAgentHantana() == 'tablet') || (data.showInMobile && userAgentHantana() == 'mobile')) || flagRequireRunHantana == 'true'){
            if(data.whenShowType == 1){

                addToUntilSurveyList(data._id, '3');

                document.body.appendChild(hantana_main_div_survey_popup);
                fadeInSurveyAlert(hantana_main_div_survey_popup, 50);

            }else if(data.whenShowType == 2){
                setTimeout(function(){

                    addToUntilSurveyList(data._id, '3');

                    document.body.appendChild(hantana_main_div_survey_popup);
                    fadeInSurveyAlert(hantana_main_div_survey_popup, 50);

                }, data.whenShowData * 1000);
            }else if(data.whenShowType == 3){
                if(userAgentHantana() == 'desktop'){
                    var flagOpen = false;
                    var addEvent = function(obj, evt, fn) {
                        if (obj.addEventListener) {
                            obj.addEventListener(evt, fn, false);
                        }
                        else if (obj.attachEvent) {
                            obj.attachEvent("on" + evt, fn);
                        }
                    };
                    addEvent(document, "mouseout", function(event) {
                        event = event ? event : window.event;
                        var from = event.relatedTarget || event.toElement;
                        if ((!from || from.nodeName == "HTML") && event.clientY <= 100 && !flagOpen) {
                            
                            addToUntilSurveyList(data._id, '3');

                            document.body.appendChild(hantana_main_div_survey_popup);
                            fadeInSurveyAlert(hantana_main_div_survey_popup, 50);

                            flagOpen = true;                   
                        }
                    });
                }else{
                    addToUntilSurveyList(data._id, '3');

                    document.body.appendChild(hantana_main_div_survey_popup);
                    fadeInSurveyAlert(hantana_main_div_survey_popup, 50);

                }
            }else if(data.whenShowType == 4){
                var docHeight = Math.max(document.body.scrollHeight, document.body.offsetHeight, document.documentElement.clientHeight, document.documentElement.scrollHeight, document.documentElement.offsetHeight ) / 2, flagOpen = false;
                document.addEventListener('scroll', function(e) {
                    if((window.scrollY > docHeight) && !flagOpen){
                        
                        addToUntilSurveyList(data._id, '3');

                        document.body.appendChild(hantana_main_div_survey_popup);
                        fadeInSurveyAlert(hantana_main_div_survey_popup, 50);

                        flagOpen = true; 
                    }
                });
            }
        }


    }


    
    

    //popup start
    function createPopUpHantana(data, force = false){

        // console.log(data)

        var flagPopUp = true;
        var popupType = data.conditions.popupType;
        

        function checkJustOnceView(behaviorType){
            var flagOnceView = false;
            behaviorType.forEach(function(item){
                if(item.type == 9){
                    flagOnceView = true;
                }
            });
            return flagOnceView;
        }

        function checkPopupHasInLocalStorage(_id){
            var getStorage = window.localStorage.getItem("hantana_popup_view"), flagHas = false;
            if(getStorage){
                getStorage = JSON.parse(getStorage);
                getStorage.forEach(function(item){
                    if((item).toString() == (_id).toString()){
                        flagHas = true;
                    }
                });
            }
            return flagHas;
        }

        function addPopupInLocalStorage(_id){
            var getStorage = window.localStorage.getItem("hantana_popup_view");
            if(getStorage){
                getStorage = JSON.parse(getStorage);
                getStorage.push(_id);
                localStorage.hantana_popup_view = JSON.stringify(getStorage);
            }else{
                localStorage.hantana_popup_view = JSON.stringify([_id]);
            }
            return true;
        }

        function getClosest( elem, selector ) {
            while (elem !== document.body) {
                elem = elem.parentElement;
                if (elem.matches(selector)) return elem;
            }
        }
        
        function addTopageSurveyPopUp(){
            
            var mainIframeDiv = document.createElement('div');
            mainIframeDiv.className = "mainIframeDiv animated_hantana fadeIn_hantana_animate";
            document.body.appendChild(mainIframeDiv);

            var iframeDiv = document.createElement('div');
            iframeDiv.className = "iframeDiv animated_hantana fadeIn_hantana_animate";
            document.body.appendChild(iframeDiv);

            mainIframeDiv.onclick = function() {
                mainIframeDiv.style.display = 'none';
                iframeDiv.style.display = 'none';
            }

            var iframeLoadingDiv = document.createElement('div');
            iframeLoadingDiv.className = "iframeLoadingDiv";
            iframeLoadingDiv.innerHTML = '<svg width="120" height="30" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg" fill="#fff" style=""><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle></svg>';
            iframeDiv.appendChild(iframeLoadingDiv);

            var iframeClosePopUp = document.createElement('div');
            iframeClosePopUp.className = "iframeClosePopUp";
            iframeClosePopUp.innerHTML = '<svg style="width: 10px;height: 10px;margin: 5px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="rgba(38,44,49,1)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M1.458 1.458l21.084 21.084m0-21.084L1.458 22.542" ></path></svg>';
            iframeClosePopUp.onclick = function() {
                mainIframeDiv.style.display = 'none';
                iframeDiv.style.display = 'none';
            }
            iframeDiv.appendChild(iframeClosePopUp);

            var mainIframe = document.createElement('iframe');
            mainIframe.className = "mainIframe";
            mainIframe.src = "https://survey.hantana.org/" + popupType.value;
            mainIframe.onload = function() {
                iframeLoadingDiv.style.display = 'none';
            }
            iframeDiv.appendChild(mainIframe);
            
        }

        function addTopagePopUp(){

            var hantanaId = data.html[0]['_id'];  

            var hantanaHtml = data.html[0]['data'];
            hantanaHtml = hantanaHtml.replaceAll("closeHantana_id", "close_items_popup_hantana closeHantana_" + hantanaId)
            hantanaHtml = hantanaHtml.replace("poweredHantana_id", "poweredHantana_" + hantanaId)
            hantanaHtml = hantanaHtml.replace("popUpHantana_id", "all_items_popup_hantana popUpHantana_" + hantanaId + " showPopUpHantana" + data._id)
            hantanaHtml = hantanaHtml.replace("submitBtnHantana_id", "submitBtnHantana sbh_" + hantanaId)

            var hantanaCss = data.css[0]['data'];
            hantanaCss = hantanaCss.replace("closeHantana_id", "closeHantana_" + hantanaId)
            hantanaCss = hantanaCss.replace("poweredHantana_id", "poweredHantana_" + hantanaId)
            hantanaCss = hantanaCss.replace("popUpHantana_id", "popUpHantana_" + hantanaId)
            hantanaCss = hantanaCss.replaceAll("vazir", "hantanaVazir");
            
            // hantanaCss = hantanaCss.replaceAll("!important;", ";");
            // hantanaCss = hantanaCss.replaceAll(";", " !important;");
            // hantanaCss = hantanaCss.replaceAll("image/png !important;", "image/png;");
            // hantanaCss = hantanaCss.replaceAll("image/svg+xml !important;", "image/svg+xml;");
            // hantanaCss = hantanaCss.replaceAll("image/svg !important;", "image/svg;");

            document.head.insertAdjacentHTML('beforeend', '<style>@media only screen and (max-width: 450px) { .popupHantanaMainResponsiv{width: 94% !important; right: auto !important; left: 50% !important; transform: translate(-50%,-50%) !important; top: 50% !important;} } .close_items_popup_hantana{cursor: pointer !important;padding: 0 !important;} .all_items_popup_hantana{direction: ltr !important;z-index: 2147483647 !important;} '+hantanaCss+'</style>');
            document.body.insertAdjacentHTML('beforeend', hantanaHtml);

            if(document.getElementsByClassName("sbh_" + hantanaId)){
                var sbhThis = document.getElementsByClassName("sbh_" + hantanaId)[0];

                var getTextInputs = getClosest(sbhThis, 'div').querySelectorAll('input[type=text]');
                getTextInputs.forEach(function(inp){
                    inp.onkeyup = function(){
                        inp.style.borderBottom = '1px solid #eee';
                    };
                });

                sbhThis.onclick = function() {
                    var isEmptyForm = false;
                 
                    popUpDataSetHantana(data._id, 2);

                    var dataFormConditions = data.conditions.formConditions;
                    if(dataFormConditions && dataFormConditions.hasForm){
                        var dataToFunc = {
                            popupId: data._id,        
                        };
                        var sendDataEndPoint = '', jsonDataEndPoint = {data: {}};
                        getTextInputs.forEach(function(inp){
                            dataToFunc[inp.getAttribute('name')] = inp.value;
                            sendDataEndPoint += "&" + inp.getAttribute('name') + "=" + inp.value;
                            if(inp.value == ''){
                                isEmptyForm = true;
                                inp.style.borderBottom = '1px solid #d77474';
                            }else{
                                if(inp.name == 'nationalCode'){
                                    if(!isValidIranianNationalCodeHantana(ArabicAndPersianToEnglishHantana(inp.value))){
                                        isEmptyForm = true;
                                        inp.style.borderBottom = '1px solid #d77474';
                                    }
                                }   
                            }
                            jsonDataEndPoint.data[inp.getAttribute('name')] = ArabicAndPersianToEnglishHantana(inp.value);
                        });

                        jsonDataEndPoint['popupId'] = data._id;
                        
                        if(!isEmptyForm){
                            var closePopUp = true;
                            if(dataFormConditions.type == 1){
                                sendDataToEndPointAddress(dataFormConditions.value, jsonDataEndPoint, getTextInputs);
                            }else if(dataFormConditions.type == 2){
                                eval(dataFormConditions.value + "("+JSON.stringify(jsonDataEndPoint)+");");
                            }else if(dataFormConditions.type == 3){
                                jsonDataEndPoint['siteToken'] = window._hantanaSettings.tId;
                                sendDataToEndPointAddress(popUpPrefixHantana + "api/popup/form", jsonDataEndPoint, getTextInputs);
                            }else if(dataFormConditions.type == 4){
                                var email = jsonDataEndPoint.data.email;         
                                if(email && validateEmailHantana(email)){
                                    sendDataToPakatAddress(dataFormConditions.value, jsonDataEndPoint, getTextInputs, dataFormConditions.listId);
                                }else{
                                    closePopUp = false;
                                }
                            }

                            if(closePopUp){
                                //close popup
                                var mainElems = document.getElementsByClassName("popUpHantana_" + hantanaId);
                                for(var i=0; i<mainElems.length; i++) {
                                    mainElems[i].parentNode.removeChild(mainElems[i]);
                                }
                            }
                            

                        }else{
                            // var btnText = sbhThis.innerText;
                        }  
                        

                    }

                }
            }
            

            var elementToHideList = document.getElementsByClassName("closeHantana_" + hantanaId);
            // var indexOne = elementToHideList[0];
            for(var cl=0; cl<elementToHideList.length; cl++) {
                elementToHideList[cl].onclick = function(e) {
                    e.preventDefault();
                    var mainElems = document.getElementsByClassName("popUpHantana_" + hantanaId);
                    for(var i=0; i<mainElems.length; i++) {
                        mainElems[i].parentNode.removeChild(mainElems[i]);
                    }
                }
            }


            if(document.getElementsByClassName("poweredHantana_" + hantanaId).length){
                var urlDataSourceHantana = 'https://hantana.org/?utm_source='+window.location.href+'&utm_medium=widget&utm_campaign=referral-poweredBy&device='+userAgentHantana()+'&widgetCode=5';
                if(data.popupTheme == 0){
                    var pwt = poweredByImg, poweredByColor = 'color:#fff;';
                }else{
                    var pwt = poweredByImgDark, poweredByColor = 'color:#4d4d4d;';
                }
                if(!data.hidePoweredBy){
                    if(data.language == 'en'){
                        document.getElementsByClassName("poweredHantana_" + hantanaId)[0].style.cssText = poweredByColor + "width: 80%; margin: 0 auto !important; text-align: left !important; font-size: 12px !important; padding-bottom: 18px !important; font-family: hantanaVazir !important;";
                        document.getElementsByClassName("poweredHantana_" + hantanaId)[0].insertAdjacentHTML('beforeend', 'powered by<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_feedback_logo_power_en" onmousedown="return false;" src="'+pwt+'" alt="سرویس تحلیل رفتار کاربران وب سایت" /></a>');
                    }else{
                        document.getElementsByClassName("poweredHantana_" + hantanaId)[0].style.cssText = poweredByColor + "width: 80%; margin: 0 auto !important; text-align: right !important; font-size: 12px !important; padding-bottom: 18px !important; font-family: hantanaVazir !important;";
                        document.getElementsByClassName("poweredHantana_" + hantanaId)[0].insertAdjacentHTML('beforeend', '<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_feedback_logo_power_fa" onmousedown="return false;" src="'+pwt+'" alt="سرویس تحلیل رفتار کاربران وب سایت" /></a>قدرت گرفته از <a href="https://hantana.org/" target="_blank"></a>');
                    }
                }else{
                    document.getElementsByClassName("poweredHantana_" + hantanaId)[0].style.cssText = poweredByColor + "width: 80%; margin: 0 auto !important; text-align: right !important; font-size: 12px !important; padding-bottom: 18px !important; font-family: hantanaVazir !important;height: 20px;";
                }
            }

            popUpDataSetHantana(data._id, 1);

        }

        function runPopUp(){

            var checkJustOnceViewResult = checkJustOnceView(data.conditions.behaviorType);

            if(!checkPopupHasInLocalStorage(data._id)){
                if(popupType && popupType.type == 1){
                    addTopageSurveyPopUp();
                }else{
                    addTopagePopUp();
                }
                
            }

            if(checkJustOnceViewResult && !checkPopupHasInLocalStorage(data._id)){
                addPopupInLocalStorage(data._id);
            }

        }

        
        function onLoadHantanaReady(){
            onEndRequesAndInjectHantana('popup');
        }

        function checkOs(){
            var getOSResult = getOSHantana(), flagOsWork = true;
            if(getOSResult >= 1 && getOSResult <= 5){
                if(data.conditions.os.indexOf(getOSResult) == -1){
                    flagOsWork = false;
                }
            }
            return flagOsWork;
        }


        function checkCookieTargeting(data){
            var flagWork = 0;
            data.forEach(function(item){
                var getValueByName = getCookie(item.name);
                if(getValueByName && item.query == 1 && item.value == getValueByName){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(getValueByName && item.query == 2 && item.value != getValueByName){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(getValueByName && item.query == 3 && getValueByName.search(item.value) != -1){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(getValueByName && item.query == 4 && getValueByName.search(item.value) == -1){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(item.query == 5 && getValueByName){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(item.query == 6 && !getValueByName){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }
            });
            return flagWork;
        }

        function checkLocalStorageTargeting(data){
            var flagWork = 0;
            data.forEach(function(item){
                var getValueByName = window.localStorage.getItem(item.key);
                if(getValueByName && item.query == 1 && item.value == getValueByName){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(getValueByName && item.query == 2 && item.value != getValueByName){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(getValueByName && item.query == 3 && getValueByName.search(item.value) != -1){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(getValueByName && item.query == 4 && getValueByName.search(item.value) == -1){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(item.query == 5 && getValueByName){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }else if(item.query == 6 && !getValueByName){
                    (item.status) ? flagWork = 1 : flagWork = 2;
                }
            });
            return flagWork;
        }

        

        function checkBehavior(){
            var behaviorType = data.conditions.behaviorType;

            if(behaviorType.length){

                behaviorType.forEach(function(item){
                    if(item.type == 7){
                        var cookieTargetingData = data.conditions.cookieTargeting;
                        var checkCookieTargetingRes = checkCookieTargeting(cookieTargetingData);
                        if(checkCookieTargetingRes == 1 && flagPopUp){
                            runPopUp();
                            onLoadHantanaReady();
                            flagPopUp = false;
                        }else if(checkCookieTargetingRes == 2){
                            flagPopUp = false;
                        }
                    }
                    if(item.type == 8){
                        var localStorageTargetingData = data.conditions.localStorageTargeting;
                        var checkLocalStorageTargetingRes = checkLocalStorageTargeting(localStorageTargetingData);
                        if(checkLocalStorageTargetingRes == 1 && flagPopUp){
                            runPopUp();
                            onLoadHantanaReady();
                            flagPopUp = false;
                        }else if(checkLocalStorageTargetingRes == 2){
                            flagPopUp = false;
                        }
                    }       
                });
                
                behaviorType.forEach(function(item){

                    // console.log('type', item.type)
                    // console.log('value', item.value)

                    if(item.type == 2){
                        var timeout;
                        document.onmousemove = function(){
                            clearTimeout(timeout);
                            timeout = setTimeout(function(){
                                if(flagPopUp){
                                    runPopUp();
                                    onLoadHantanaReady();
                                    flagPopUp = false;
                                }
                            }, Number(item.value) * 1000);
                        }
                    }
                    if(item.type == 3){
                        setTimeout(function(){
                            if(flagPopUp){
                                runPopUp();
                                onLoadHantanaReady();
                                flagPopUp = false;
                            }
                        }, Number(item.value) * 1000);
                    }
                    if(item.type == 4){
                        if(userAgentHantana() == 'desktop'){
                            var addEvent = function(obj, evt, fn) {
                                if (obj.addEventListener) {
                                    obj.addEventListener(evt, fn, false);
                                }
                                else if (obj.attachEvent) {
                                    obj.attachEvent("on" + evt, fn);
                                }
                            };
                            addEvent(document, "mouseout", function(event) {
                                event = event ? event : window.event;
                                var from = event.relatedTarget || event.toElement;
                                if ((!from || from.nodeName == "HTML") && event.clientY <= 100 && flagPopUp) {
                                    runPopUp();   
                                    onLoadHantanaReady();  
                                    flagPopUp = false;            
                                }
                            });
                        }else{
                            if(flagPopUp){
                                runPopUp();
                                onLoadHantanaReady();
                                flagPopUp = false;
                            }
                        }
                    }
                    if(item.type == 5){
                        var docHeight = Math.max(document.body.scrollHeight, document.body.offsetHeight, document.documentElement.clientHeight, document.documentElement.scrollHeight, document.documentElement.offsetHeight ) / 2, flagOpen = false;
                        document.addEventListener('scroll', function(e) {
                            if((window.scrollY > docHeight) && flagPopUp){
                                runPopUp();
                                onLoadHantanaReady();
                                flagPopUp = false;
                            }
                        });
                    }
                    if(item.type == 6){
                        
                        var referralTragetingData = data.conditions.referralTrageting, referrerUrl = document.referrer;
                        if(referrerUrl){
                            referralTragetingData.forEach(function(referral){
                                var checkMatchUrlResult = checkMatchUrl(referral.type, referral.value, referrerUrl);
                                if(checkMatchUrlResult && flagPopUp){
                                    runPopUp();
                                    onLoadHantanaReady();
                                    flagPopUp = false;
                                }
                            });
                        }
                        
                    }
                        

                    

                });


            }else{
                if(flagPopUp){
                    runPopUp();
                    onLoadHantanaReady();
                    flagPopUp = false;
                }
            }



        }


        function checkForceOrNormalRun(){
            //if popup not show go to show
            if(!document.getElementsByClassName("showPopUpHantana" + data._id).length){
                if(force){
                    //wihtout check ifs
                    if(popupType && popupType.type == 1){
                        addTopageSurveyPopUp();
                    }else{
                        addTopagePopUp();
                    }
                    onLoadHantanaReady();
                }else{
                    //check ifs
                    if(checkOs()){
                        checkBehavior();
                    }
                }
            }
        }

        function initPopupHantana(check){
            if(check){
                if(viewsDataHantana.todayCounter <= viewsDataHantana.SiteViewlimite){
                    checkForceOrNormalRun();
                }
            }else{
                checkForceOrNormalRun();
            }   
        }

        if(viewsDataHantana){
            initPopupHantana(true);
        }
        // else{
        //     checkViewsCountHantana().then(function(data){
        //         console.log('2 data', data)
        //         viewsDataHantana = data;
        //         if(data.status){
        //             initPopupHantana(true);
        //         }else{
        //             initPopupHantana(false);
        //         }                
        //     });
        // }  
        

    }



    //surveys start
    function createSurveysHantana(data){

        var mainColorBackgroundColor = data.backgroundColor;
        var mainColorFontColor = data.fontColor;

        if(data.externalSurvey == 1){
            externalSurvey = 1;
            setExternalSurveyStyleHantana(mainColorBackgroundColor);
        }

        if(previewSurveyFlag == 1){
            //for preview survey
            setInterval(function(){
                var getElemsSurvey = document.getElementsByClassName('div_main_hantana_survey');
                if(getElemsSurvey.length > 1){
                    for(var i=0; i<getElemsSurvey.length; i++) {
                        getElemsSurvey[i].parentNode.removeChild(getElemsSurvey[i]);
                    }
                }
            },100)
        }

       
        if(externalSurvey == 1){
            data.backgroundColor = 'FFFFFF';
            data.fontColor = '242424';
        }
   

        if(data.externalSurveyJustQuestionReview == 1){
            // externalSurvey = 0;
            setExternalSurveyJustQuestionsReviewStyleHantana();
            // data.backgroundColor = 'FFFFFF';
            // data.fontColor = '242424';
        }


        if(data.externalSurvey == 0 && data.externalSurveyJustQuestionReview == 0){
            data.backgroundColor = mainColorBackgroundColor;
            data.fontColor = mainColorFontColor;
            externalSurvey = 0;
        }
      

        if(checkAccountUserResultHantana == 0){

            if(data.location == 1){
                data.backgroundColor = '58626C';
                data.fontColor = 'FFFFFF';
            }else if(data.location == 2){
                data.backgroundColor = 'FFFFFF';
                data.fontColor = '242424';
            }

            data.nextButtonColor = '3CBA43';
            data.position = 'bottom-left';
            data.openBtnType = 1;
        }
        if(checkAccountUserResultHantana == 0 || checkAccountUserResultHantana == 1){
            data.hantanaBrand = false;
        }
        
        var backgroundColor = data.backgroundColor;
        var fontColor = data.fontColor;
        var nextButtonColor = data.nextButtonColor;
        var questions = data.questions;
        var flagClickOpenServey = false;
        var thankYouText = 'test';
        var hexToRgbA = hexToRgbAHantana('#' + backgroundColor);
        var answersData = [];
        var resultWhiteColor = (data.backgroundColor.startsWith("f") || data.backgroundColor.startsWith("e") || data.backgroundColor.startsWith("d") || data.backgroundColor.startsWith("c"));
        var resultTooWhiteButton = (data.nextButtonColor.startsWith("f") || data.nextButtonColor.startsWith("e") || data.nextButtonColor.startsWith("d") || data.nextButtonColor.startsWith("c"));


        var hantana_main_div_question_survey = document.createElement('div');
        hantana_main_div_question_survey.className = "div_main_hantana_survey";
        hantana_main_div_question_survey.id = "div_main_hantana_survey_id";
        hantana_main_div_question_survey.style.background = '#' + data.backgroundColor;
        if(externalSurvey == 1){
            hantana_main_div_question_survey.style.setProperty("box-shadow", "rgba(0, 0, 0, 0.1) 0px 0px 15px 0px", "important");
            // hantana_main_div_question_survey.style.setProperty("box-shadow", "0 0 7px 0 rgba(0,0,0,0.3)", "important");
        }else if(previewSurveyFlag == 1){
            hantana_main_div_question_survey.style.setProperty("box-shadow", "none", "important");
        }
        


        //open btn
        var hantana_open_div_question_survey = document.createElement('div');
        if(data.openBtnType == 1){
            hantana_open_div_question_survey.className = "div_main_hantana_survey_open_min";
        }else{
            hantana_open_div_question_survey.className = "div_main_hantana_survey_open";
        }
        hantana_open_div_question_survey.id = "div_main_hantana_survey_open_id";

        if(resultWhiteColor){
            hantana_open_div_question_survey.style.border = "1px solid #f4f1f1";
            hantana_open_div_question_survey.style.borderBottom = "none";
        }
        hantana_open_div_question_survey.style.background = '#' + data.backgroundColor;

        // if(lightOrDark('#' + data.nextButtonColor) == 'light'){
        //     hantana_open_div_question_survey.style.border = "1px solid #f4f1f1";
        //     hantana_open_div_question_survey.style.borderBottom = "none"
        // }
        // hantana_open_div_question_survey.style.background = '#' + data.nextButtonColor;

        hantana_open_div_question_survey.style.color = '#' + data.fontColor;
        hantana_open_div_question_survey.onclick = function() {
            openHantanaMainSurvey();
        };
        hantana_open_div_question_survey.onmouseover = function() {
            openHantanaMainSurveyMouseOver(this);
        };
        hantana_open_div_question_survey.onmouseout = function() {
            openHantanaMainSurveyMouseOut(this);
        };
        hantana_main_div_question_survey.appendChild(hantana_open_div_question_survey);



        //welcome text
        var hantana_message_welcome_div_question_survey = document.createElement('div');
        hantana_message_welcome_div_question_survey.className = "p_welcome_main_hantana_1 animated_hantana fadeIn_hantana_animate";
        hantana_message_welcome_div_question_survey.id = "p_welcome_main_hantana_1_id";
        hantana_message_welcome_div_question_survey.innerText = data.welcomeMessage;
        if(data.language == 'fa'){
            hantana_message_welcome_div_question_survey.style.direction = 'rtl';
        }else{
            hantana_message_welcome_div_question_survey.style.direction = 'ltr';
        }
        hantana_open_div_question_survey.appendChild(hantana_message_welcome_div_question_survey);
        // var setTimeoutHantanaShowWelcomeMessage;
        // if(data.welcomeMessageFlag){
        //     setTimeoutHantanaShowWelcomeMessage = setTimeout(function () {
        //         if(flagClickOpenServey == false){
        //             hantana_message_welcome_div_question_survey.style.display = 'block';
        //             setTimeout(function () {
        //                 hantana_message_welcome_div_question_survey.style.display = 'none';
        //             },5000)
        //         }
        //     },2000)
        // }


        var hantana_open_p_div_question_survey = document.createElement('p');
        hantana_open_p_div_question_survey.className = "p_hantana_main_open_1";
        hantana_open_p_div_question_survey.style.color = '#' + data.fontColor;

        // if(lightOrDark('#' + data.nextButtonColor) == 'light'){
        //     hantana_open_p_div_question_survey.style.color = '#000';
        // }
        hantana_open_p_div_question_survey.id = "p_hantana_main_open_1_id";
        hantana_open_p_div_question_survey.innerText = data.openBtnText;
        hantana_open_div_question_survey.appendChild(hantana_open_p_div_question_survey);


        var hantana_open_img_question_survey = document.createElement('div');
        hantana_open_img_question_survey.alt = "hantana";
        
        hantana_open_img_question_survey.className = "img_hantana_main_survey_2";
        hantana_open_img_question_survey.id = "img_hantana_main_survey_2_id";
        if(data.openBtnType == 1){
            hantana_open_img_question_survey.style.setProperty("margin-left", "0px", "important");
        }
        hantana_open_img_question_survey.innerHTML = '<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 1280 1280" preserveAspectRatio="xMidYMid meet"><g id="layer101" fill="#'+data.fontColor+'" stroke="none"><path d="M53 990 c-31 -13 -56 -55 -49 -82 3 -13 142 -159 309 -325 232 -232 308 -303 327 -303 33 0 640 604 640 637 0 12 -11 35 -24 50 l-24 28 -579 2 c-324 1 -588 -2 -600 -7z"/></g></svg>';
        hantana_open_img_question_survey.onmousedown = function() {return false};
        hantana_open_div_question_survey.appendChild(hantana_open_img_question_survey);


        var hantana_main_survey_all_data = document.createElement('div');
        hantana_main_survey_all_data.id = "hantana_main_survey_all_data_id";

        var hantana_open_1_div_question_survey = document.createElement('div');
        hantana_open_1_div_question_survey.className = "div_main_hantana_survey_1";
        hantana_open_1_div_question_survey.id = "div_main_hantana_survey_1_id";
        hantana_open_1_div_question_survey.setAttribute("style", "scrollbar-color: #707D8C #58626C;");
        hantana_main_survey_all_data.appendChild(hantana_open_1_div_question_survey);



        //footer box
        var hantana_footer_box_div_survey = document.createElement('div');
        hantana_footer_box_div_survey.className = "footer_hantana_box_div_survey_1";
        hantana_footer_box_div_survey.id = "footer_hantana_box_div_survey_1_id";
        hantana_main_survey_all_data.appendChild(hantana_footer_box_div_survey);

        hantana_main_div_question_survey.appendChild(hantana_main_survey_all_data);


        var hantana_title_div_question_survey = document.createElement('div');
        hantana_title_div_question_survey.className = "div_hantana_main_100_survey div_hantana_main_survey_1";
        hantana_title_div_question_survey.id = "div_hantana_main_survey_1_id";
        hantana_open_1_div_question_survey.appendChild(hantana_title_div_question_survey);


        var hantana_title_p_div_question_survey = document.createElement('p');
        hantana_title_p_div_question_survey.className = "p_hantana_main_survey_1";
        hantana_title_p_div_question_survey.id = "p_hantana_main_survey_1_id";
        hantana_title_p_div_question_survey.style.color = '#' + data.fontColor;
        hantana_title_div_question_survey.appendChild(hantana_title_p_div_question_survey);



        var hantana_items_div_question_survey = document.createElement('div');
        hantana_items_div_question_survey.className = "div_hantana_main_100_survey";
        hantana_items_div_question_survey.id = "hantana_items_list";
        hantana_open_1_div_question_survey.appendChild(hantana_items_div_question_survey);


        var hantana_footer_div_question_survey = document.createElement('div');
        hantana_footer_div_question_survey.className = "div_hantana_main_100_survey_2 div_padding_right_left_15_main_survey";
        hantana_footer_box_div_survey.appendChild(hantana_footer_div_question_survey);


        var hantana_power_div_question_survey = document.createElement('div');
        hantana_power_div_question_survey.className = "div_hantana_main_50_survey text_left_hantana2";
        hantana_footer_div_question_survey.appendChild(hantana_power_div_question_survey);



        var hantana_power_p_div_question_survey = document.createElement('p');
        hantana_power_p_div_question_survey.className = "p_hantana_main_survey_2";
        hantana_power_p_div_question_survey.id = "p_hantana_main_survey_2_id";
        hantana_power_p_div_question_survey.style.color = '#' + data.fontColor;
        
       
        if(data.hantanaBrand == false || checkAccountUserResultHantana == 0 || checkAccountUserResultHantana == 1){
            var urlDataSourceHantana = 'https://hantana.org/?utm_source='+window.location.href+'&utm_medium=widget&utm_campaign=referral-poweredBy&device='+userAgentHantana()+'&widgetCode=2';
            if(lightOrDark('#' + data.fontColor) == 'dark'){
                var pwt = poweredByImgDark;
            }else{
                var pwt = poweredByImg;
            }
            // if(externalSurvey == 1){
            //     hantana_power_p_div_question_survey.innerHTML = '<a href="'+urlDataSourceHantana+'" target="_blank"><img class="hantana_img_powred_external_1" onmousedown="return false;" src="'+pwt+'" /></a>';
            // }else{
                if(data.language == 'fa'){
                    hantana_power_p_div_question_survey.innerHTML = '<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_survey_logo_power_fa" onmousedown="return false;" src="'+pwt+'" /></a>قدرت گرفته از';
                }else{
                    hantana_power_p_div_question_survey.innerHTML = 'powered by<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_survey_logo_power_en" onmousedown="return false;" src="'+pwt+'" /></a>';
                }
            // }
           
        }
        hantana_power_div_question_survey.appendChild(hantana_power_p_div_question_survey);



        var hantana_button_div_question_survey = document.createElement('div');
        hantana_button_div_question_survey.className = "div_hantana_main_50_survey text_right_hantana2";
        hantana_footer_div_question_survey.appendChild(hantana_button_div_question_survey);


        var hantana_button_question_survey = document.createElement('button');
        hantana_button_question_survey.className = "btn_hantana_main_survey";
        hantana_button_question_survey.id = "btn_hantana_main_survey_id";

        var hexToRgbValue = hexToRgbHantana('#' + data.nextButtonColor);
        if(hexToRgbValue){
            var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
            hantana_button_question_survey.style.color = colorText;
        }
        
        // hantana_button_question_survey.style.background = '#' + data.nextButtonColor;
        // hantana_button_question_survey.disabled = true;
        hantana_button_question_survey.onclick = function() {
            addQuestion();
        }
        hantana_button_div_question_survey.appendChild(hantana_button_question_survey);

        var hantana_button_question_survey_skip = document.createElement('button');
        hantana_button_question_survey_skip.className = "hantana_button_question_survey_skip";
        hantana_button_question_survey_skip.id = "hantana_button_question_survey_skip_id";
        hantana_button_question_survey_skip.style.color = '#' + data.fontColor;
        hantana_button_question_survey_skip.innerText = langDataHantana['skipQuestionTextSurvey'][data.language]['text'];
        hantana_button_question_survey_skip.onclick = function() {
            addQuestion(-1, 1);
        }
        hantana_button_div_question_survey.appendChild(hantana_button_question_survey_skip);



        // var hantana_ta_you_div_question_survey = document.createElement('div');
        // hantana_ta_you_div_question_survey.className = "div_hantana_main_after_send_survey animated_hantana fadeIn_hantana_animate";
        // hantana_ta_you_div_question_survey.id = "div_hantana_main_after_send_survey_id";
        // hantana_ta_you_div_question_survey.style.background = '#' + backgroundColor;
        // hantana_main_div_question_survey.appendChild(hantana_ta_you_div_question_survey);

        // var hantana_you_p_div_question_survey = document.createElement('p');
        // hantana_you_p_div_question_survey.className = "p_hantana_main_survey_3";
        // hantana_you_p_div_question_survey.id = "p_hantana_main_survey_3_id";
        // hantana_you_p_div_question_survey.style.display = 'none';
        // if(data.language == 'fa'){
        //     hantana_you_p_div_question_survey.style.direction = 'rtl';
        // }else{
        //     hantana_you_p_div_question_survey.style.direction = 'ltr';
        // }
        // hantana_you_p_div_question_survey.innerText = thankYouText;
        // hantana_ta_you_div_question_survey.appendChild(hantana_you_p_div_question_survey);


        function openHantanaMainSurveyMouseOver(thisItem) {
            thisItem.style.boxShadow = '0 0 18px 2px '+hexToRgbA+'';
        }
        function openHantanaMainSurveyMouseOut(thisItem) {
            thisItem.style.boxShadow = 'none';
        }
        function openHantanaMainSurvey() {
            if(flagClickOpenServey){
                var questions = data.questions;

                var lastId = Number(hantana_button_question_survey.getAttribute('name'));
                if(lastId && (lastId == (questions.length - 1))){
                    hantana_main_div_question_survey.parentNode.removeChild(hantana_main_div_question_survey);
                }else{
                    closeMainSurvey();
                }

            }else{
                openMainSurvey();
            }
        }




        async function saveDataSurveyHantana(ipDetail, survetId) {
            if(data.untilShow == 1){
                addToUntilSurveyList(data._id, '1');
            }
            var request = new XMLHttpRequest();
            var setUserData = getDataUserApi();

  
            if(externalSurvey == 1){
                if(setUserData.name == '' && setUserData.email == '' && setUserData.phone == '' && setUserData.description == '' && setUserData.avatar == ''){
                    var urlParams = new URLSearchParams(window.location.search);
                    if(urlParams.has('hantana_name') || urlParams.has('hantana_email') || urlParams.has('hantana_phone') || urlParams.has('hantana_description') || urlParams.has('hantana_avatar')){
                        window.Hantana.setUserData({
                            name : urlParams.get('hantana_name'),
                            email : urlParams.get('hantana_email'),
                            phone : urlParams.get('hantana_phone'),
                            avatar: urlParams.get('hantana_description'),
                            description : urlParams.get('hantana_avatar'),  
                        });
                        setUserData = getDataUserApi();
                    }
                   
                }
            }

            // request.open('POST', 'https://api.hantana.org/api/newResponse', false);
            request.open('POST', surveyPrefixHantana + 'api/newResponse', true);
            request.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
            var deviceData = 1;
            if(userAgentHantana() == 'tablet'){
                deviceData = 2;
            }else if(userAgentHantana() == 'mobile'){
                deviceData = 3;
            }       
            var hantanaUser = getCookie('_hantanaUser');
            request.send(JSON.stringify(
                {
                    "siteToken": window._hantanaSettings.tId,
                    "siteId":data.siteId,
                    "userId":data.userId,
                    "surveyId":survetId,
                    "response" : answersData,
                    "screenHeight":window.screen.height,
                    "screenWidth":window.screen.width,
                    "patchUrl":window.location.href,
                    "setUserData":setUserData,
                    "device":deviceData,
                    "codeUser":hantanaUser,
                    "userAgent": navigator.userAgent,
                    "receive": data.receive,
                    "ipDetail":JSON.parse(ipDetail)
                }
            ));
            // console.log(request.responseText)
            return true;
        }

        if(externalSurvey == 1){
            document.body.appendChild(hantana_main_div_question_survey);
            setTimeout(function(){ openMainSurvey(); },1);
        }else{
            if(((data.showInDesktop && userAgentHantana() == 'desktop') || (data.showInTablet && userAgentHantana() == 'tablet') || (data.showInMobile && userAgentHantana() == 'mobile')) || flagRequireRunHantana == 'true'){
                if(data.whenShowType == 1){
                    if(data.untilShow == 2){
                        addToUntilSurveyList(data._id, '2');
                    }
                    document.body.appendChild(hantana_main_div_question_survey);
                }else if(data.whenShowType == 2){
                    if(data.untilShow == 2){
                        addToUntilSurveyList(data._id, '2');
                    }
                    document.body.appendChild(hantana_main_div_question_survey);
                    setTimeout(function(){ openHantanaMainSurvey(); },50);
                }else if(data.whenShowType == 3){
                    setTimeout(function(){
                        var element = document.getElementById('div_main_hantana_survey_id');
                        if(element){
                            element.parentNode.removeChild(element);
                        }
                        if(data.untilShow == 2){
                            addToUntilSurveyList(data._id, '2');
                        }
                        document.body.appendChild(hantana_main_div_question_survey);
                        openHantanaMainSurvey();
                    }, data.whenShowData * 1000);
                }else if(data.whenShowType == 4){
                    if(userAgentHantana() == 'desktop'){
                        var flagOpen = false;
                        var addEvent = function(obj, evt, fn) {
                            if (obj.addEventListener) {
                                obj.addEventListener(evt, fn, false);
                            }
                            else if (obj.attachEvent) {
                                obj.attachEvent("on" + evt, fn);
                            }
                        };
                        addEvent(document, "mouseout", function(event) {
                            event = event ? event : window.event;
                            var from = event.relatedTarget || event.toElement;
                            if ((!from || from.nodeName == "HTML") && event.clientY <= 100 && !flagOpen) {
                                var element = document.getElementById('div_main_hantana_survey_id');
                                if(element){
                                    element.parentNode.removeChild(element);
                                }
                                if(data.untilShow == 2){
                                    addToUntilSurveyList(data._id, '2');
                                }
                                document.body.appendChild(hantana_main_div_question_survey);
                                openHantanaMainSurvey(); 
                                flagOpen = true;                   
                            }
                        });
                    }else{
                        if(data.untilShow == 2){
                            addToUntilSurveyList(data._id, '2');
                        }
                        document.body.appendChild(hantana_main_div_question_survey);
                    }
                }else if(data.whenShowType == 5){
                    var docHeight = Math.max(document.body.scrollHeight, document.body.offsetHeight, document.documentElement.clientHeight, document.documentElement.scrollHeight, document.documentElement.offsetHeight ) / 2, flagOpen = false;
                    document.addEventListener('scroll', function(e) {
                        if((window.scrollY > docHeight) && !flagOpen){
                            var element = document.getElementById('div_main_hantana_survey_id');
                            if(element){
                                element.parentNode.removeChild(element);
                            }
                            if(data.untilShow == 2){
                                addToUntilSurveyList(data._id, '2');
                            }
                            document.body.appendChild(hantana_main_div_question_survey);
                            openHantanaMainSurvey(); 
                            flagOpen = true; 
                        }
                    });
                }
            }
        }

        if (document.documentElement.clientWidth < 450) {

            if(data.position == 'bottom-right'){
                hantana_open_div_question_survey.style.left = 'auto';
                hantana_open_div_question_survey.style.right = '35px';
            }else if(data.position == 'bottom-center'){
                hantana_open_div_question_survey.style.left = '0';
                hantana_open_div_question_survey.style.right = '0';
                hantana_main_div_question_survey.style.left = '0';
                hantana_main_div_question_survey.style.right = '0';
            }else if(data.position == 'bottom-left'){
                hantana_open_div_question_survey.style.left = '35px';
                hantana_open_div_question_survey.style.right = 'auto';
            }

        }else{

            if(data.position == 'bottom-right'){
                hantana_main_div_question_survey.style.right = '35px';
                hantana_open_div_question_survey.style.right = '35px';
            }else if(data.position == 'bottom-center'){
                hantana_open_div_question_survey.style.setProperty('left', 'calc(50% - '+hantana_open_div_question_survey.getBoundingClientRect().width+'px/2)');
                hantana_open_div_question_survey.style.right = 'auto';
                // hantana_open_div_question_survey.style.right = '0';
                // hantana_open_div_question_survey.style.left = '0';
                hantana_main_div_question_survey.style.left = '0';
                hantana_main_div_question_survey.style.right = '0';
            }else if(data.position == 'bottom-left'){
                hantana_main_div_question_survey.style.left = '35px';
                hantana_open_div_question_survey.style.left = '35px';
            }

        }


        if(!localStorage.showPollsHantanaAfterUseFlag) {

            if(data.questionNumber != undefined){
                addQuestion(Number(data.questionNumber));
            }else{
                addQuestion(0);
            }
          
            hantana_main_div_question_survey.style.bottom = '0px';
            hantana_main_survey_all_data.style.height = '0px';
            if(data.externalSurveyJustQuestionReview != 1){
                hantana_main_div_question_survey.style.transition = 'all 0.3s ease';
            }
        }
        function emptyAnswersCache(){
            window.localStorage.removeItem('hantana_data_answer');
        }

        
        function createNormalInputSurveyHantana(question){
            var normalInput = document.createElement('input');
            normalInput.className = "input_hantana_main_text_survey";
            var hexToRgbValue = hexToRgbHantana('#' + data.backgroundColor);
            if(hexToRgbValue){
                var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                if(colorText == "#000000"){
                    normalInput.style.border = "1px solid #eeeeee"; 
                }
            }
            normalInput.id = "input_hantana_text_survey_id";
            normalInput.type = "text";
            normalInput.placeholder = langDataHantana['placeholderInputsSurvey'][data.language]['text'];
            normalInput.style.setProperty("direction", langDataHantana['placeholderInputsSurvey'][data.language]['direction'], "important");
            normalInput.style.setProperty("text-align", langDataHantana['placeholderInputsSurvey'][data.language]['align'], "important");
            normalInput.onkeyup = function() {
                onChangeInputSurvey(this, this.value, question.type, question.require)
            }
            hantana_items_div_question_survey.appendChild(normalInput);
        }
        function createLongTestInputSurveyHantana(question){
            var longTextInput = document.createElement('textarea');
            longTextInput.className = "input_hantana_main_long_text_survey";
            longTextInput.id = "input_hantana_text_survey_id";
            longTextInput.type = "text";

            var hexToRgbValue = hexToRgbHantana('#' + data.backgroundColor);
            if(hexToRgbValue){
                var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                if(colorText == "#000000"){
                    longTextInput.style.border = "1px solid #eeeeee"; 
                }
            }
            

            longTextInput.placeholder = langDataHantana['placeholderInputsSurvey'][data.language]['text'];
            longTextInput.style.setProperty("direction", langDataHantana['placeholderInputsSurvey'][data.language]['direction'], "important");
            longTextInput.style.setProperty("text-align", langDataHantana['placeholderInputsSurvey'][data.language]['align'], "important");
            longTextInput.onkeyup = function() {
                onChangeInputSurvey(this, this.value, question.type, question.require)
            }
            hantana_items_div_question_survey.appendChild(longTextInput);
        }
        function createEmailInputSurveyHantana(question){
            var emailInput = document.createElement('input');
            emailInput.className = "input_hantana_main_text_survey";
            emailInput.id = "input_hantana_text_survey_id";
            emailInput.type = "text";

            var hexToRgbValue = hexToRgbHantana('#' + data.backgroundColor);
            if(hexToRgbValue){
                var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                if(colorText == "#000000"){
                    emailInput.style.border = "1px solid #eeeeee"; 
                }
            }

            emailInput.placeholder = langDataHantana['placeholderInputsSurvey'][data.language]['text'];
            emailInput.style.setProperty("direction", langDataHantana['placeholderInputsSurvey'][data.language]['direction'], "important");
            emailInput.style.setProperty("text-align", langDataHantana['placeholderInputsSurvey'][data.language]['align'], "important");
            emailInput.onkeyup = function() {
                onChangeInputSurvey(this, this.value, question.type, question.require)
            }
            hantana_items_div_question_survey.appendChild(emailInput);
        }
        function shuffle(array) {
            var currentIndex = array.length, temporaryValue, randomIndex;
            // While there remain elements to shuffle...
            while (0 !== currentIndex) {
                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;
                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }
            return array;
        }

        function selectRightOrLeftDir(items){
            var countRight = 0;
            var countLeft = 0;
            items.forEach(function(radioItem, index) {
                if(Number(countPersianCharacters(radioItem.title)) >= (Number((radioItem.title).length) - Number(countPersianCharacters(radioItem.title)))){
                    countRight++;
                }else{
                    countLeft++;
                }
            });
            if(countRight > countLeft){
                return true;
            }else if(countRight < countLeft){
                return false;
            }else{
                return true;
            }
        }

        function createRadioButtonsSurveyHantana(question){
            hantana_items_div_question_survey.style.setProperty("padding", "5px 0 0 0", "important");
            // hantana_items_div_question_survey.style.padding = "5px 0 0 0";
            var lastItem = question.items[question.items.length - 1];
            if(question.randomOrder){
                if(question.pinLastAnswer){
                    question.items.splice((question.items.length - 1), 1);
                    shuffle(question.items);
                    question.items.push(lastItem);
                }else{
                    shuffle(question.items);
                }  
            }

            var dirItems = selectRightOrLeftDir(question.items);
            
            question.items.forEach(function(radioItem, index) {

                var mainRadio = document.createElement('div');
                mainRadio.className = "div_hantana_main_100_survey_1";

                if(index != (question.items.length - 1)){
                    var hexToRgbValue = hexToRgbHantana('#' + data.backgroundColor);
                    if(hexToRgbValue){
                        var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                        if(colorText == "#000000"){
                            mainRadio.style.borderBottom = '1px solid #eee';
                        }else{
                            mainRadio.style.borderBottom = '1px solid ' + colorLuminanceHantana(data.backgroundColor, 0.5);
                        }
                    }
                }

                // if(resultWhiteColor){
                //     mainRadio.style.borderBottom = '1px solid #eee';
                // }else{
                //     mainRadio.style.borderBottom = '1px solid ' + colorLuminanceHantana(data.backgroundColor, 0.5);
                // }
                mainRadio.id = 'hantana_item_' + question.id + '_' + index;
                mainRadio.onclick = function() {
                    onClickSurveyRadioItems(this)
                };

                var txtAlign = 'color:#' + data.fontColor + ';', paddingTextBoxDiv = 0;
                if(dirItems){
                    txtAlign += 'text-align: right;direction: rtl';
                    paddingTextBoxDiv = 'padding: 0 0 0 17px';
                    mainRadio.style.flexDirection = 'row-reverse';
                }else{
                    paddingTextBoxDiv = 'padding: 0 17px 0 0';
                }

                //first child
                var firstChildRadio = document.createElement('div');
                firstChildRadio.className = "div_hantana_main_20_survey";
                mainRadio.appendChild(firstChildRadio);

                var allFirstChildRadio = document.createElement('div');
                allFirstChildRadio.className = "div_hantana_main_survey_inner_1";
                firstChildRadio.appendChild(allFirstChildRadio);


                var firstChildRadio1 = document.createElement('div');
                firstChildRadio1.className = "div_check_main_hantana_div_1";
                allFirstChildRadio.appendChild(firstChildRadio1);
                
                var imgRadio = document.createElement('img');
                imgRadio.alt = "hantana";
                imgRadio.className = "img_check_main_hantana_img_1 animated_hantana hingeFlipIn_hantana_animate";
                imgRadio.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAPFBMVEUAAADMzMzJycnJycnHx8fJycnExMTKysrJycnKysrKysrJycnJycnJycnIyMjJycnJycnKysrExMTJycmKgh1qAAAAE3RSTlMABa33SNIUKun4SubJxqCMPDQRWrMOKgAAAJ9JREFUWMPt1LsOwzAMQ1EltmOnTZ/8/38t0IWDgKKmlgzifu4iQJbLRfd+biFfB0oN+MsOoAU9RtDjofpavn5d0qdPn/5Ufvnj//3wveHoAW8HgGvXvRWwoHhbwYLibWssCJ6F0dX7syB4VxC8KwjeFZwXCs5PFJwXCs5PFZwXCvQmFUTPwk6vFeilAr1WoFcL9GLhBtzphS2vbrnc3D4D4hsra7T0HAAAAABJRU5ErkJggg==';
                imgRadio.onmousedown = function() {return false};
                firstChildRadio1.appendChild(imgRadio);


                //second child
                var secondChildRadio = document.createElement('div');
                secondChildRadio.className = "div_hantana_main_80_survey";
                mainRadio.appendChild(secondChildRadio);

                

                var allSecondChildRadio = document.createElement('div');
                allSecondChildRadio.className = "div_hantana_main_survey_inner_2";
                secondChildRadio.appendChild(allSecondChildRadio);

                var textboxDiv = document.createElement('div');
                textboxDiv.style.cssText = paddingTextBoxDiv;
                secondChildRadio.appendChild(textboxDiv);

                
                var textbox = document.createElement('textarea');
                var hexToRgbValue = hexToRgbHantana('#' + data.backgroundColor);
                if(hexToRgbValue){
                    var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                    if(colorText == "#000000"){
                        textbox.style.border = "1px solid #eeeeee"; 
                    }
                }
                textbox.placeholder = langDataHantana['placeholderInputsSurvey'][data.language]['text'];
                textbox.style.setProperty("direction", langDataHantana['placeholderInputsSurvey'][data.language]['direction'], "important");
                textbox.style.setProperty("text-align", langDataHantana['placeholderInputsSurvey'][data.language]['align'], "important");
                textbox.className = "textarea_comment_survey_hantana";
                textboxDiv.appendChild(textbox);

                var secondChildRadio2 = document.createElement('p');
                secondChildRadio2.className = "p_hantana_main_survey_4";
                secondChildRadio2.style.cssText = txtAlign;
                secondChildRadio2.innerText = radioItem.title;
                allSecondChildRadio.appendChild(secondChildRadio2);

                hantana_items_div_question_survey.appendChild(mainRadio);

            });
        }
        function createCheckBoxSurveyHantana(question){
            hantana_items_div_question_survey.style.setProperty("padding", "5px 0 0 0", "important");
            // hantana_items_div_question_survey.style.padding = "5px 0 0 0";
            var lastItem = question.items[question.items.length - 1];
            if(question.randomOrder){
                if(question.pinLastAnswer){
                    question.items.splice((question.items.length - 1), 1);
                    shuffle(question.items);
                    question.items.push(lastItem);
                }else{
                    shuffle(question.items);
                }
            }
            question.items.forEach(function(radioItem, index) {

                var mainRadio = document.createElement('div');
                mainRadio.className = "div_hantana_main_100_survey_1";


                if(index != (question.items.length - 1)){
                    var hexToRgbValue = hexToRgbHantana('#' + data.backgroundColor);
                    if(hexToRgbValue){
                        var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                        if(colorText == "#000000"){
                            mainRadio.style.borderBottom = '1px solid #eee';
                        }else{
                            mainRadio.style.borderBottom = '1px solid ' + colorLuminanceHantana(data.backgroundColor, 0.5);
                        }
                    }
                }


                // if(resultWhiteColor){
                //     mainRadio.style.borderBottom = '1px solid #eee';
                // }else{
                //     mainRadio.style.borderBottom = '1px solid ' + colorLuminanceHantana(data.backgroundColor, 0.5);
                // }
                mainRadio.id = 'hantana_item_' + question.id + '_' + index + '_' + radioItem.requireComment + '_0';
                mainRadio.onclick = function(e) {
                    onClickSurveyCheckBoxItems(this, e.target.tagName.toLowerCase());
                };

                var txtAlign = 'color:#' + data.fontColor + ';', paddingTextBoxDiv = 0;
                if(Number(countPersianCharacters(radioItem.title)) >= (Number((radioItem.title).length) - Number(countPersianCharacters(radioItem.title)))){
                    txtAlign += 'text-align: right;direction: rtl';
                    paddingTextBoxDiv = 'padding: 0 0 0 17px';
                    mainRadio.style.flexDirection = 'row-reverse';
                }else{
                    paddingTextBoxDiv = 'padding: 0 17px 0 0';
                }

                //first child
                var firstChildRadio = document.createElement('div');
                firstChildRadio.className = "div_hantana_main_20_survey";
                mainRadio.appendChild(firstChildRadio);

                var allFirstChildRadio = document.createElement('div');
                allFirstChildRadio.className = "div_hantana_main_survey_inner_1";
                firstChildRadio.appendChild(allFirstChildRadio);


                var firstChildRadio1 = document.createElement('div');
                firstChildRadio1.className = "div_check_box_main_hantana_div";
                allFirstChildRadio.appendChild(firstChildRadio1);
                
                var imgRadio = document.createElement('img');
                imgRadio.alt = "hantana";
                imgRadio.className = "img_check_main_hantana_img_1 animated_hantana hingeFlipIn_hantana_animate";
                imgRadio.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAPFBMVEUAAADMzMzJycnJycnHx8fJycnExMTKysrJycnKysrKysrJycnJycnJycnIyMjJycnJycnKysrExMTJycmKgh1qAAAAE3RSTlMABa33SNIUKun4SubJxqCMPDQRWrMOKgAAAJ9JREFUWMPt1LsOwzAMQ1EltmOnTZ/8/38t0IWDgKKmlgzifu4iQJbLRfd+biFfB0oN+MsOoAU9RtDjofpavn5d0qdPn/5Ufvnj//3wveHoAW8HgGvXvRWwoHhbwYLibWssCJ6F0dX7syB4VxC8KwjeFZwXCs5PFJwXCs5PFZwXCvQmFUTPwk6vFeilAr1WoFcL9GLhBtzphS2vbrnc3D4D4hsra7T0HAAAAABJRU5ErkJggg==';
                imgRadio.onmousedown = function() {return false};
                firstChildRadio1.appendChild(imgRadio);


                //second child
                var secondChildRadio = document.createElement('div');
                secondChildRadio.className = "div_hantana_main_80_survey";
                mainRadio.appendChild(secondChildRadio);

                

                var allSecondChildRadio = document.createElement('div');
                allSecondChildRadio.className = "div_hantana_main_survey_inner_2";
                secondChildRadio.appendChild(allSecondChildRadio);

                var textboxDiv = document.createElement('div');
                textboxDiv.style.cssText = paddingTextBoxDiv;
                secondChildRadio.appendChild(textboxDiv);

                
                var textbox = document.createElement('textarea');
                var hexToRgbValue = hexToRgbHantana('#' + data.backgroundColor);
                if(hexToRgbValue){
                    var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                    if(colorText == "#000000"){
                        textbox.style.border = "1px solid #eeeeee"; 
                    }
                }
                textbox.placeholder = langDataHantana['placeholderInputsSurvey'][data.language]['text'];
                textbox.style.setProperty("direction", langDataHantana['placeholderInputsSurvey'][data.language]['direction'], "important");
                textbox.style.setProperty("text-align", langDataHantana['placeholderInputsSurvey'][data.language]['align'], "important");
                textbox.className = "textarea_comment_survey_hantana";
                textboxDiv.appendChild(textbox);

                var secondChildRadio2 = document.createElement('p');
                secondChildRadio2.className = "p_hantana_main_survey_4";
                secondChildRadio2.style.cssText = txtAlign;
                secondChildRadio2.innerText = radioItem.title;
                allSecondChildRadio.appendChild(secondChildRadio2);

                hantana_items_div_question_survey.appendChild(mainRadio);

            });
        }

        function onClickRateItemHantana(thisItem){
            var rateClick = (thisItem.id).split('_')[2];
            enableButtonSurveySendInHantana();
            window.localStorage.setItem('hantana_data_answer', rateClick);

            var elements = document.getElementsByClassName('col_rate_survey_hantana');
            for(var i=0; i<elements.length; i++) {
                // if(resultWhiteColor){
                //     elements[i].style.borderTop = "2px solid #eee";
                // }else{
                //     elements[i].style.borderTop = "2px solid " + colorLuminanceHantana(data.backgroundColor, 1.1);
                //     // elements[i].style.setProperty("color", "#ffffff", "important");
                // }
                elements[i].style.setProperty("opacity", "0.5", "important");

                // elements[i].style.transform = 'scale(1)';
                elements[i].style.setProperty("box-shadow", "none", "important");
                elements[i].removeAttribute('name');
            }

            thisItem.style.borderTop = "0px solid transparent";
            // thisItem.style.setProperty("box-shadow", "#"+data.backgroundColor+" 0px 0px 10px 0px inset", "important");
            thisItem.style.setProperty("opacity", "1", "important");
            // thisItem.style.transition = '0.3s';
            // thisItem.style.transform = 'scale(1.2)';
            if(resultWhiteColor){
                // thisItem.style.setProperty("box-shadow", "#eee 0px 0px 80px 0px inset", "important");
            }else{
                // thisItem.style.setProperty("box-shadow", "rgb(255, 255, 255) 0px 0px 80px 0px inset", "important");
                // thisItem.style.setProperty("color", "#" + data.backgroundColor, "important");
            }
            
            thisItem.setAttribute('name', '1');
        }
        
        function createRateSurveyHantana(question, countRate){
            var mainRateDiv = document.createElement('div');
            

            var mainRateDivItems = document.createElement('div');
            mainRateDivItems.className = "row_main_100_rate_survey";
            mainRateDiv.appendChild(mainRateDivItems);

            var i = 1;
            if(countRate == 10){
                i = 0;
            }
            
            for(i; i <= countRate; i++){
                var rateDiv = document.createElement('div');
                rateDiv.className = "col_rate_survey_hantana";
                // rateDiv.id = "col_rate_" + (i + 1);
                rateDiv.id = "col_rate_" + i;
                rateDiv.style.color = "#" + data.backgroundColor;

                if(resultWhiteColor){
                    // rateDiv.style.border = "1px solid #eee";
                    // rateDiv.style.borderTop = "2px solid #eee" ;
                }else{
                    // rateDiv.style.border = "1px solid " + colorLuminanceHantana(data.backgroundColor, 0.4);
                    // rateDiv.style.borderTop = "2px solid " + colorLuminanceHantana(data.backgroundColor, 1.1);
                }
                rateDiv.style.background = "#" + data.fontColor;
                // rateDiv.style.background = colorLuminanceHantana(data.backgroundColor, 1.5);
                // rateDiv.style.boxShadow = colorLuminanceHantana(data.backgroundColor, 0.2) + ' 0px 0px 8px 0px inset';
                rateDiv.onclick = function() {
                    onClickRateItemHantana(this);
                }
                // rateDiv.onmouseover = function() {
                //     onMouseOverRateItemHantana(this);
                // }
                // rateDiv.onmouseout = function() {
                //     onMouseOutRateItemHantana(this);
                // }
                if(data.language == 'fa'){
                    // rateDiv.innerText = toFarsiNumber(i + 1);
                    rateDiv.innerText = toFarsiNumber(i);
                }else if(data.language == 'en'){
                    // rateDiv.innerText = (i + 1);
                    rateDiv.innerText = i;
                }

                mainRateDivItems.appendChild(rateDiv);
            }

        

            var mainRateDivTexts = document.createElement('div');
            mainRateDivTexts.className = "row_main_100_rate_survey";
          

            var highText = document.createElement('div');
            highText.style.color = "#" + data.fontColor;
            if(data.language == 'fa'){
                highText.className = "text_rate_right_hantana";
            }else if(data.language == 'en'){
                highText.className = "text_rate_left_hantana";
            }
            highText.innerText = question.lowToHighText;
            if(Number(countPersianCharacters(question.lowToHighText)) > (Number((question.lowToHighText).length) - Number(countPersianCharacters(question.lowToHighText)))){
                highText.style.direction = 'rtl';
            }else{
                highText.style.direction = 'ltr';
            }
            mainRateDivTexts.appendChild(highText);

            var lowText = document.createElement('div');
            lowText.style.color = "#" + data.fontColor;
            if(data.language == 'fa'){
                lowText.className = "text_rate_left_hantana";
            }else if(data.language == 'en'){
                lowText.className = "text_rate_right_hantana";
            }
            lowText.innerText = question.highToLowText;
            if(Number(countPersianCharacters(question.highToLowText)) > (Number((question.highToLowText).length) - Number(countPersianCharacters(question.highToLowText)))){
                lowText.style.direction = 'rtl';
            }else{
                lowText.style.direction = 'ltr';
            }
            mainRateDivTexts.appendChild(lowText);


            mainRateDiv.appendChild(mainRateDivTexts);
            
            
            if(data.language == 'fa'){
                mainRateDivItems.style.flexDirection = 'row-reverse';
                mainRateDivTexts.style.flexDirection = 'row-reverse';
            }
            

            hantana_items_div_question_survey.appendChild(mainRateDiv);

        }

        function getFileExtension(filename) {
            return filename.split('.').pop();
        }
        function replaceTxtNotInA(html, regex, replace) {
            html = '>' + html + '<';
            html = html.replace(/>([^<>]+)(?!<\/a)</g, function(match, txt) {
                return '>' + txt.replace(regex, replace) + '<';
            });
            return html.substring(1, html.length - 1);
        }
        function replaceURLWithHTMLLinksHa(html) {
            var replacedText = html;

            var exp = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&amp;&@#\/%?=~_|!:,.;]*[-A-Z0-9+&amp;&@#\/%=~_|])/ig;
            var exp2 = /\b(www\.[\S]+)\b/gi;

            var foundProtocolUrls = replacedText.match(exp);
            if(foundProtocolUrls){
                foundProtocolUrls.forEach(function(item){
                    var getExtension = getFileExtension(item).toLowerCase();
                    if(getExtension == 'webp' || getExtension == 'png' || getExtension == 'jpg' || getExtension == 'jpeg' || getExtension == 'gif' || getExtension == 'svg'){
                        replacedText = replaceTxtNotInA(replacedText, item, '<a href="'+item+'" target="_blank"><img class="hantana-survey-media-1" src="'+item+'" /></a>');
                    }else if(getExtension == 'mp4' || getExtension == 'mkv'){
                        replacedText = replaceTxtNotInA(replacedText, item, '<video class="hantana-survey-media-1" controls><source src="'+item+'" type="video/mp4"></video>');
                    }
                });
            }

            var foundUrls = replacedText.match(exp2);
            if(foundUrls){
                foundUrls.forEach(function(item){
                    var getExtension = getFileExtension(item).toLowerCase();
                    if(getExtension == 'webp' || getExtension == 'png' || getExtension == 'jpg' || getExtension == 'jpeg' || getExtension == 'gif' || getExtension == 'svg'){
                        replacedText = replaceTxtNotInA(replacedText, item, '<a href="'+item+'" target="_blank"><img class="hantana-survey-media-1" src="'+item+'" /></a>');
                    }else if(getExtension == 'mp4' || getExtension == 'mkv'){
                        replacedText = replaceTxtNotInA(replacedText, item, '<video class="hantana-survey-media-1" controls><source src="'+item+'" type="video/mp4"></video>');
                    }
                });
            }

            replacedText = replaceTxtNotInA(replacedText, exp, '<a class="hantana-linkify" href="$1" target="_blank">$1</a>');
            replacedText = replaceTxtNotInA(replacedText, exp2, '<a class="hantana-linkify" href="http://$1" target="_blank">$1</a>');

            var exp3 = /(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gi;
            replacedText = replaceTxtNotInA(replacedText, exp3, '<a class="hantana-linkify" href="mailto:$1">$1</a>');

            return {text:replacedText, hasUrl: ((html == replacedText) ? false: true)};
        }
        
        function linkifyHa(inputText) {
            var replacedText, replacePattern1, replacePattern2, replacePattern3;
            replacePattern1 = /(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;
            replacedText = inputText.replace(replacePattern1, '<a class="hantana-linkify" href="$1" target="_blank">$1</a>');
            replacePattern2 = /(^|[^\/])(www\.[\S]+(\b|$))/gim;
            replacedText = replacedText.replace(replacePattern2, '$1<a class="hantana-linkify" href="http://$2" target="_blank">$2</a>');
            replacePattern3 = /(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim;
            replacedText = replacedText.replace(replacePattern3, '<a class="hantana-linkify" href="mailto:$1">$1</a>');
            return {text:replacedText, hasUrl: ((inputText == replacedText) ? false: true)};
        }

        function createMessageShowSurveyHantana(question){
            var messageTextJson = replaceURLWithHTMLLinksHa(question.description);
            var messageText = messageTextJson.text;
            var messageTag = document.createElement('p');
            messageTag.className = "message_tag_survey";
            messageTag.style.color = "#" + data.fontColor;
            if(Number(countPersianCharacters(messageText)) >= (Number((messageText).length) - Number(countPersianCharacters(messageText)))){
                messageTag.style.direction = 'rtl';
                if(externalSurvey == 1){
                    messageTag.style.setProperty("text-align", "right", "important");
                }
            }else{
                messageTag.style.direction = 'ltr';
                if(externalSurvey == 1){
                    messageTag.style.setProperty("text-align", "left", "important");
                }
            }
            if(messageTextJson.hasUrl){
                messageTag.style.direction = 'rtl';
            }
            messageTag.innerHTML = messageText;
            hantana_items_div_question_survey.appendChild(messageTag);
        }
        
        function openMainSurvey() {
            flagClickOpenServey = true;
            hantana_open_div_question_survey.style.background = '#' + data.backgroundColor;
            // if(data.welcomeMessageFlag){
            //     clearTimeout(setTimeoutHantanaShowWelcomeMessage);
            // }
            hantana_message_welcome_div_question_survey.style.display = 'none'
            // hantana_ta_you_div_question_survey.style.display = 'none'
            hantana_open_img_question_survey.style.transform = "rotate(180deg)";
            hantana_main_survey_all_data.style.height = 'auto';
            emptyAnswersCache();
        }
        function closeMainSurvey() {
            flagClickOpenServey = false;
            hantana_open_img_question_survey.style.transform = "rotate(0deg)";
            hantana_main_survey_all_data.style.height = '0px';
            if(data.questionNumber){
                addQuestion(Number(data.questionNumber));
            }else{
                addQuestion(0);
            }
            hantana_open_1_div_question_survey.scrollTop = 0;
            hantana_main_div_question_survey.style.bottom = '-'+ hantana_main_div_question_survey.offsetHeight +'px';
            emptyAnswersCache();
        }

        function enableButtonSurveySendInHantana() {
            hantana_button_question_survey.style.background = '#' + data.nextButtonColor;
            // if(resultTooWhiteButton){
            //     hantana_button_question_survey.style.color = "#000000";
            // }else{
            //     hantana_button_question_survey.style.color = "#ffffff";      
            // }
            // // hantana_button_question_survey.style.color = '#' + data.fontColor;
            hantana_button_question_survey.style.cursor = "pointer";
            hantana_button_question_survey.style.setProperty("opacity", "1", "important");
            hantana_button_question_survey.disabled = false;
        }
        function disableButtonSurveySendInHantana() {
            hantana_button_question_survey.style.background = '#' + data.nextButtonColor;
            // if(resultTooWhiteButton){
            //     hantana_button_question_survey.style.color = "#000000";
            // }else{
            //     hantana_button_question_survey.style.color = "#ffffff";      
            // }
            // hantana_button_question_survey.style.color = '#' + data.fontColor;
            hantana_button_question_survey.style.cursor = "not-allowed";
            hantana_button_question_survey.style.setProperty("opacity", "0.5", "important");
            hantana_button_question_survey.disabled = true;
        }
        function colorLuminanceHantana(hex, lum) {
            // validate hex string
            hex = String(hex).replace(/[^0-9a-f]/gi, '');
            if (hex.length < 6) {
                hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];
            }
            lum = lum || 0;
            // convert to decimal and change luminosity
            var rgb = "#", c, i;
            for (i = 0; i < 3; i++) {
                c = parseInt(hex.substr(i*2,2), 16);
                c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);
                rgb += ("00"+c).substr(c.length);
            }
            return rgb;
        }
        function lightOrDark(a){
            var r,b,g,hsp;
            if (a.match(/^rgb/)) {
                a = a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);
                r = a[1];
                g = a[2];
                b = a[3];
            } else {
                a = +("0x" + a.slice(1).replace(a.length < 5 && /./g, '$&$&'));
                r = a >> 16;
                b = a >> 8 & 255;
                g = a & 255;
            }
            hsp = Math.sqrt(0.299 * (r * r) + 0.587 * (g * g) + 0.114 * (b * b));
            if (hsp>127.5) {
                return "light";
            } else {
                return "dark";
            }
        }
        function onChangeInputSurvey(elem, val, type, require) {

            if(val == ''){
                disableButtonSurveySendInHantana();
                hantana_button_question_survey.disabled = true;
            }else{           
                if(type == 3){
                    if(isValidEmail(val)){
                        enableButtonSurveySendInHantana();
                        hantana_button_question_survey.disabled = false;
                    }else{
                        disableButtonSurveySendInHantana();
                        hantana_button_question_survey.disabled = true;
                    }
                }else{
                    enableButtonSurveySendInHantana();
                    hantana_button_question_survey.disabled = false;
                }
            }
        }
        function findDataIntoQuestionById(id){
            var question = {};
            data.questions.forEach(function(item, index) {
                if(item['id'] == id){
                    question = {
                        index: index,
                        item: item
                    };
                }
            });
            return (question) ? question : data.questions[0];
        }

        function setRadioSelectDataSurveyHantana(index, title, comment){
            var jsonData = {
                "index": index,
                "title": title,
                "comment": comment
            };
            window.localStorage.setItem('hantana_data_answer', JSON.stringify(jsonData));
        }
        function onChangeInputRadioSurvey(elem, val){
            if(val != ''){
                enableButtonSurveySendInHantana();
            }else{
                disableButtonSurveySendInHantana();
            }
        }
        function onClickSurveyRadioItems(thisItem) {
            var questionIndex = (thisItem.id).split('_')[2];
            var answerIndex = (thisItem.id).split('_')[3];
            var getQuestion = findDataIntoQuestionById(questionIndex);

            var oldData = window.localStorage.getItem('hantana_data_answer');
            var oldIndex = -1;
            if(oldData){
                oldData = JSON.parse(oldData);  
                oldIndex = oldData['index'] ;
            }
            if(oldIndex != answerIndex){
                    
            
                var elements = document.getElementsByClassName('div_hantana_main_100_survey_1');
                for(var i=0; i<elements.length; i++) {
                    elements[i].style.setProperty('padding', '13px 5px', 'important');
                    elements[i].style.background = 'transparent';
                    var child = elements[i]['firstChild']['firstChild']['firstChild']['firstChild'];
                    child.style.display = 'none';

                    var getTextAreaItem = elements[i].getElementsByTagName('textarea')[0];
                    getTextAreaItem.value = '';
                    getTextAreaItem.style.display = 'none';
                }
                thisItem.style.background = colorLuminanceHantana(data.backgroundColor, 0.5);
                thisItem['firstChild']['firstChild']['firstChild']['firstChild'].style.display = 'block';
                
                
                setRadioSelectDataSurveyHantana(answerIndex, getQuestion['item']['items'][answerIndex]['title'], '');
                if(getQuestion['item']['items'][answerIndex]['comment']){

                    thisItem.style.setProperty('padding', '2px 5px 5px 5px', 'important');

                    var getTeaxtArea = thisItem.getElementsByTagName('textarea')[0];
                    getTeaxtArea.style.display = 'block';
                    getTeaxtArea.onkeyup = function() {
                        setRadioSelectDataSurveyHantana(answerIndex, getQuestion['item']['items'][answerIndex]['title'], this.value);
                        if(getQuestion['item']['items'][answerIndex]['requireComment']){
                            onChangeInputRadioSurvey(getTeaxtArea, this.value);
                        }
                    }
                    if(getQuestion['item']['items'][answerIndex]['requireComment']){
                        disableButtonSurveySendInHantana();
                    }else{
                        enableButtonSurveySendInHantana();
                    }
                }else{
                    enableButtonSurveySendInHantana();
                }
                
            }
            
        }

        function setCheckBoxSelectDataSurveyHantana(index, title, comment, update = 0){
            var data = window.localStorage.getItem('hantana_data_answer'), jsonData = [], flagAddOrRemove = 1;
            if(data){
                data = JSON.parse(data);  
                if(update){
                    data.forEach(function(item, i){
                        if(item.index == index){
                            data[i]['comment'] = comment;
                        }
                    });
                }else{
                    data.forEach(function(item, i){
                        if(item.index == index){
                            data.splice(i, 1);
                            flagAddOrRemove = 0;
                        }
                    });
                    if(flagAddOrRemove){
                        data.push({
                            "index": index,
                            "title": title,
                            "comment": comment
                        });
                    }
                }
                jsonData = data;
            }else{
                jsonData = [{
                    "index": index,
                    "title": title,
                    "comment": comment
                }];
            }
            window.localStorage.setItem('hantana_data_answer', JSON.stringify(jsonData));
            return flagAddOrRemove;
        }
        function onClickSurveyCheckBoxItems(thisItem, clickTagName) {
            if(clickTagName == 'textarea'){
                return true;
            }
            var questionIndex = (thisItem.id).split('_')[2];
            var answerIndex = (thisItem.id).split('_')[3];
            var requireCommentThis = (thisItem.id).split('_')[4];
            var currentCheckedStatus = (thisItem.id).split('_')[5];
            var newCheckedStatus = '0';
            if(currentCheckedStatus == '0'){
                newCheckedStatus = '1';
            }
            var getQuestion = findDataIntoQuestionById(questionIndex);
            thisItem.id = 'hantana_item_' + questionIndex + '_' + answerIndex + '_' + requireCommentThis + '_' + newCheckedStatus;
            var dataAddOrRemove = setCheckBoxSelectDataSurveyHantana(answerIndex, getQuestion['item']['items'][answerIndex]['title'], '');

            if(dataAddOrRemove){
                thisItem.style.background = colorLuminanceHantana(data.backgroundColor, 0.5);
                thisItem['firstChild']['firstChild']['firstChild']['firstChild'].style.display = 'block';
                if(getQuestion['item']['items'][answerIndex]['comment']){
                    thisItem.style.setProperty('padding', '2px 5px 5px 5px', 'important');
                    var getTeaxtArea = thisItem.getElementsByTagName('textarea')[0];
                    getTeaxtArea.style.display = 'block';
                    getTeaxtArea.onkeyup = function() {
                        setCheckBoxSelectDataSurveyHantana(answerIndex, getQuestion['item']['items'][answerIndex]['title'], this.value, 1);
                        if(getQuestion['item']['items'][answerIndex]['requireComment']){
                            onChangeInputRadioSurvey(getTeaxtArea, this.value);
                        }
                    }
                }else{
                    enableButtonSurveySendInHantana();
                }
            }else{
                thisItem.style.setProperty('padding', '13px 5px', 'important');
                thisItem.style.background = 'transparent';
                var child = thisItem['firstChild']['firstChild']['firstChild']['firstChild'];
                child.style.display = 'none';
                var getTextAreaItem = thisItem.getElementsByTagName('textarea')[0];
                getTextAreaItem.value = '';
                getTextAreaItem.style.display = 'none';
            }

          
            var elements = document.getElementsByClassName('div_hantana_main_100_survey_1'), statusBtnFlag = true, deseletedAll = false;
            for(var i=0; i<elements.length; i++){
                var getTextAreaItem = elements[i].getElementsByTagName('textarea')[0];
                var requireCommentItem = (elements[i].id).split('_')[4];
                var currentCheckedItem = (elements[i].id).split('_')[5];
                if(requireCommentItem == 'true' && getTextAreaItem.value == '' && currentCheckedItem == '1'){
                    statusBtnFlag = false;
                }
                if(currentCheckedItem == '1'){
                    deseletedAll = true;
                }
            }
            if(statusBtnFlag){
                if(!deseletedAll){
                    disableButtonSurveySendInHantana(); 
                }else{
                    enableButtonSurveySendInHantana();
                }
            }else{
                disableButtonSurveySendInHantana(); 
            }
            
            
        }

        function checkAndInsertDataIntoAnswersData(questionId, type, title, answer, comment = ''){
            // console.log(answersData)
            // console.log(questionId)
            // console.log(type)
            // console.log(answer)
            var indexData = -1;
            answersData.forEach(function(data, index){
                if(data.id == questionId){
                    indexData = index;
                }
            });
            if(indexData == -1){

                if(type == 1 || type == 2 || type == 3 || type == 6 || type == 7 || type == 8){
                    answersData.push({
                        "id": questionId,
                        "type": type,
                        "title": title,
                        "answer": [{
                            "title" : answer
                        }]
                    });
                }else if(type == 4){
                    answersData.push({
                        "id": questionId,
                        "type": type,
                        "title": title,
                        "answer": [{
                            "title" : answer,
                            "comment" : comment
                        }]
                    });
                }else if(type == 5){
                    answersData.push({
                        "id": questionId,
                        "type": type,
                        "title": title,
                        "answer": answer
                    });
                } 

            }else{

                if(type == 1 || type == 2 || type == 3 || type == 6 || type == 7 || type == 8){
                    answersData[indexData]['answer'].push({
                        "title" : answer
                    });
                }else if(type == 4){
                    answersData[indexData]['answer'].push({
                        "title" : answer,
                        "comment" : comment
                    });
                }else if(type == 5){
                    answersData[indexData]['answer'] = answersData[indexData]['answer'].concat(answer);
                }
                
            }
        }

        function addQuestion(firstChange = -1, skip = 0){
            hantana_button_question_survey.disabled = true; 
            var questions = data.questions,
            lastId = 0,
            question = {},
            thankYouMessage = 0,
            afterCurrentQuestion = '',
            afterIdQuestion = '',
            thankYouMessageData = questions[questions.length - 1];
         
            // firstChange
            if(firstChange >= 0){
                answersData = [];
                lastId = firstChange;
                hantana_button_question_survey.setAttribute('name', lastId);
                question = questions[firstChange];
            
                if(firstChange == (questions.length - 1)){
                    thankYouMessage = 1;
                }    
            }else{
                var lastId = Number(hantana_button_question_survey.getAttribute('name'));
                
               

                var currentQuestion = questions[lastId];
                var nextQuestionIndex = 0;

                // if(!currentQuestion.require){

                // }

                if(skip){
                    afterCurrentQuestion = currentQuestion['ifSkipAfter'];
                }else{
                    afterCurrentQuestion = currentQuestion['after'];
                }
                if(afterCurrentQuestion == 1){
                    //next question
                    hantana_button_question_survey.setAttribute('name', lastId + 1);
                    question = questions[lastId + 1];
                    nextQuestionIndex = (lastId + 1);
                }else if(afterCurrentQuestion == 2){
                    //thankyou  message
                    hantana_button_question_survey.setAttribute('name', questions.length - 1);
                    question = questions[questions.length - 1];
                    thankYouMessage = 1;
                    nextQuestionIndex = (questions.length - 1);
                }else if(afterCurrentQuestion == 3){
                    //question id
                    if(skip){
                        afterIdQuestion = currentQuestion['ifSkipAfterIdQuestion'];
                    }else{
                        afterIdQuestion = currentQuestion['afterIdQuestion'];
                    }
                    var getIdQuestion = findDataIntoQuestionById(afterIdQuestion);
                    hantana_button_question_survey.setAttribute('name', getIdQuestion['index']);
                    //getIdQuestion['item']
                    question = questions[getIdQuestion['index']];
                    nextQuestionIndex = (getIdQuestion['index']);

                }else if(afterCurrentQuestion == 4){

                    
                    //items after
                    if(currentQuestion['type'] == 4){
                        var radioDataResult = window.localStorage.getItem('hantana_data_answer');
                        if(radioDataResult){
                            radioDataResult = JSON.parse(radioDataResult);  
                            var afterCurrentQuestionItems = currentQuestion['items'][radioDataResult['index']]['after'];
                            var afterIdQuestionItems = currentQuestion['items'][radioDataResult['index']]['afterIdQuestion'];
                            if(afterCurrentQuestionItems == 1){
                                //next question
                                hantana_button_question_survey.setAttribute('name', lastId + 1);
                                question = questions[lastId + 1];
                                nextQuestionIndex = (lastId + 1);
                            }else if(afterCurrentQuestionItems == 2){
                                //thankyou  message
                                hantana_button_question_survey.setAttribute('name', questions.length - 1);
                                question = questions[questions.length - 1];
                                nextQuestionIndex = (questions.length - 1);
                                thankYouMessage = 1;
                            }else if(afterCurrentQuestionItems == 3){
                                    //question id
                                var getIdQuestion = findDataIntoQuestionById(afterIdQuestionItems);
                                hantana_button_question_survey.setAttribute('name', getIdQuestion['index']);
                                question = questions[getIdQuestion['index']];
                                nextQuestionIndex = (getIdQuestion['index']);
                            }
                        }
                    }else if(currentQuestion['type'] == 6 || currentQuestion['type'] == 7 || currentQuestion['type'] == 8){
                        var rateResult = window.localStorage.getItem('hantana_data_answer');
                        if(rateResult){
                            var afterSpecific = currentQuestion['afterSpecific'], afterResult = 1, afterIdQuestionResult = '';

                            if((currentQuestion['type'] == 6 && (rateResult == '1' || rateResult == '2')) || (currentQuestion['type'] == 7 && (rateResult == '1' || rateResult == '2' || rateResult == '3')) || (currentQuestion['type'] == 8 && (rateResult == '0' || rateResult == '1' || rateResult == '2' || rateResult == '3' || rateResult == '4' || rateResult == '5' || rateResult == '6'))){
                                afterResult = afterSpecific[0]['after'];
                                afterIdQuestionResult = afterSpecific[0]['afterIdQuestion'];
                            }else if((currentQuestion['type'] == 6 && rateResult == '3') || (currentQuestion['type'] == 7 && rateResult == '4') || (currentQuestion['type'] == 8 && (rateResult == '7' || rateResult == '8'))){
                                afterResult = afterSpecific[1]['after'];
                                afterIdQuestionResult = afterSpecific[1]['afterIdQuestion'];
                            }else if((currentQuestion['type'] == 6 && (rateResult == '4' || rateResult == '5')) || (currentQuestion['type'] == 7 && (rateResult == '5' || rateResult == '6' || rateResult == '7')) || (currentQuestion['type'] == 8 && (rateResult == '9' || rateResult == '10'))){
                                afterResult = afterSpecific[2]['after'];
                                afterIdQuestionResult = afterSpecific[2]['afterIdQuestion'];
                            }

                            if(afterResult == 1){
                                //next question
                                hantana_button_question_survey.setAttribute('name', lastId + 1);
                                question = questions[lastId + 1];
                                nextQuestionIndex = (lastId + 1);
                            }else if(afterResult == 2){
                                //thankyou  message
                                hantana_button_question_survey.setAttribute('name', questions.length - 1);
                                question = questions[questions.length - 1];
                                nextQuestionIndex = (questions.length - 1);
                                thankYouMessage = 1;
                            }else if(afterResult == 3){
                                //question id
                                var getIdQuestion = findDataIntoQuestionById(afterIdQuestionResult);
                                hantana_button_question_survey.setAttribute('name', getIdQuestion['index']);
                                question = questions[getIdQuestion['index']];
                                nextQuestionIndex = (getIdQuestion['index']);
                            }
                            
                        }
                        

                    }
                }

            
                if(nextQuestionIndex == (questions.length - 1)){
                    //thank you message
                    // hantana_button_question_survey.setAttribute('name', (questions.length - 1));
                    // question = questions[questions.length - 1];
                    thankYouMessage = 1;
                }

                
            }


            var questionTitle = question.title;

            //!firstChange
            // && !thankYouMessage
          
            if(firstChange != 0 && previewSurveyFlag != 1){
                if(currentQuestion['type'] == 1 || currentQuestion['type'] == 2 || currentQuestion['type'] == 3){
                    checkAndInsertDataIntoAnswersData(currentQuestion['id'], currentQuestion['type'], currentQuestion['title'], document.getElementById('input_hantana_text_survey_id').value);
                }else if(currentQuestion['type'] == 4){
                    var radioDataResult = window.localStorage.getItem('hantana_data_answer');
                    var radioAnswer = '', radioComment = '';
                    if(radioDataResult){
                        radioDataResult = JSON.parse(radioDataResult);  
                        radioAnswer = radioDataResult['title'];
                        radioComment = radioDataResult['comment'];
                    }
                    checkAndInsertDataIntoAnswersData(currentQuestion['id'], currentQuestion['type'], currentQuestion['title'], radioAnswer, radioComment);
                }else if(currentQuestion['type'] == 5){
                    var checkBoxResult = window.localStorage.getItem('hantana_data_answer'), checkBoxAnswers = [];
                    if(checkBoxResult){
                        checkBoxAnswers = JSON.parse(checkBoxResult);  
                    }
                    checkAndInsertDataIntoAnswersData(currentQuestion['id'], currentQuestion['type'], currentQuestion['title'], checkBoxAnswers);
                }else if(currentQuestion['type'] == 6 || currentQuestion['type'] == 7 || currentQuestion['type'] == 8){
                    var rateResult = window.localStorage.getItem('hantana_data_answer');
                    checkAndInsertDataIntoAnswersData(currentQuestion['id'], currentQuestion['type'], currentQuestion['title'], ((rateResult) ? rateResult : ''));
                }
            }
            
           


            var titleTextData = replaceURLWithHTMLLinksHa(questionTitle);
            hantana_title_p_div_question_survey.innerHTML = titleTextData.text;
            if(Number(countPersianCharacters(questionTitle)) > (Number((questionTitle).length) - Number(countPersianCharacters(questionTitle)))){
                hantana_title_p_div_question_survey.style.direction = 'rtl';
                if(externalSurvey == 1){
                    hantana_title_p_div_question_survey.style.textAlign = 'right';
                }
            }else{
                hantana_title_p_div_question_survey.style.direction = 'ltr';
                if(externalSurvey == 1){
                    hantana_title_p_div_question_survey.style.textAlign = 'left';
                }
            }

            if(titleTextData.hasUrl){
                hantana_title_p_div_question_survey.style.direction = 'rtl';
            }
           
            hantana_button_question_survey.innerText = langDataHantana['nextQuestionTextSurvey'][data.language]['text'];
            hantana_button_question_survey.style.display = 'block';
            hantana_items_div_question_survey.innerHTML = '';
            disableButtonSurveySendInHantana();
            // hantana_items_div_question_survey.style.padding = "6px 14px"; 
            hantana_items_div_question_survey.style.setProperty("padding", "6px 14px", "important");
            if(question.require || thankYouMessage){
                hantana_button_question_survey_skip.style.display = 'none';
            }else{
                hantana_button_question_survey_skip.style.display = 'block';
            }

            // if(question.after == 2 && thankYouMessageData.after == 2){                
            if(thankYouMessage && thankYouMessageData.after == 2){                
                hantana_button_question_survey.innerText = langDataHantana['lastQuestionTextSurvey'][data.language]['text'];
            }
          
            
            if(thankYouMessage){

                hantana_title_p_div_question_survey.style.textAlign = 'center';

                if(externalSurvey == 1){
                    //external link

                    hantana_footer_div_question_survey.style.display = 'none';

                    var mainThankYouBox = document.createElement('div');
                    mainThankYouBox.className = "hantana_main_thankyou_box_1";
                    var hexToRgbValue = hexToRgbHantana('#' + mainColorBackgroundColor);
                    if(hexToRgbValue){
                        mainThankYouBox.style.backgroundColor = "rgba("+hexToRgbValue.r+","+hexToRgbValue.g+","+hexToRgbValue.b+", 0.1)";
                        var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                        if(colorText == "#000000"){
                            mainThankYouBox.style.border = '1px solid #eee';
                        }
                    }
                    //disable
                    // hantana_items_div_question_survey.appendChild(mainThankYouBox);


                    var pThankYouBox = document.createElement('p');
                    pThankYouBox.className = "hantana_p_thankyou_box_1";
                    pThankYouBox.innerText = 'همین حالا نظرسنجی خود را به آسانی ایجاد کنید!';
                    mainThankYouBox.appendChild(pThankYouBox);

                    var aThankYouBox = document.createElement('a');
                    aThankYouBox.href = "https://hantana.org/register?utm_source="+window.location.href+"&utm_medium=onSite&utm_campaign=referral-surveyRegister";
                    aThankYouBox.className = "hantana_a_thankyou_box_1";
                    mainThankYouBox.appendChild(aThankYouBox);
                    

                    var btnThankYouBox = document.createElement('button');
                    btnThankYouBox.className = "hantana_btn_thankyou_box_1";
                    btnThankYouBox.innerText = 'ثبت نام';
                    aThankYouBox.appendChild(btnThankYouBox);

                    if(data.hantanaBrand == false || checkAccountUserResultHantana == 0 || checkAccountUserResultHantana == 1){

                        var aThankYouBox = document.createElement('a');
                        var urlDataSourceHantana = 'https://hantana.org/?utm_source='+window.location.href+'&utm_medium=widget&utm_campaign=referral-poweredBy&device='+userAgentHantana()+'&widgetCode=4';
                        aThankYouBox.href = urlDataSourceHantana;
                        aThankYouBox.className = "hantana_a_thankyou_box_1";
                        hantana_items_div_question_survey.appendChild(aThankYouBox);

                        var logoThankYouBox = document.createElement('img');
                        logoThankYouBox.className = "hantana_img_thankyou_box_1";
                        logoThankYouBox.src = poweredByImgDark;
                        aThankYouBox.appendChild(logoThankYouBox);

                    }

                    if(previewSurveyFlag == undefined){
                        //when not preview survey
                        saveDataSurveyHantana(ipDetail, data._id);
                    }    

                }else{

                    //on site
                    hantana_button_question_survey.style.display = 'none';

                    if(thankYouMessageData.after == 1){      

                        var closeBtnSurvey = document.createElement('button');
                        closeBtnSurvey.style.backgroundColor = '#' + data.nextButtonColor;
                        closeBtnSurvey.style.width = '80px';
                        closeBtnSurvey.style.fontSize = '14px';
                        closeBtnSurvey.className = "accept_deny_btn_thankyou";
                        closeBtnSurvey.innerText = langDataHantana['closeQuestionTextSurvey'][data.language]['text'];
                        var hexToRgbValue = hexToRgbHantana('#' + data.nextButtonColor);
                        if(hexToRgbValue){
                            var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                            closeBtnSurvey.style.color = colorText;
                        }
                        closeBtnSurvey.onclick = function() {
                            openHantanaMainSurvey();
                        };
                        hantana_items_div_question_survey.appendChild(closeBtnSurvey);
                        
                        if(previewSurveyFlag == undefined){
                            //when not preview survey
                            saveDataSurveyHantana(ipDetail, data._id);
                        }    

                        // hantana_main_div_question_survey.parentNode.removeChild(hantana_main_div_question_survey);
                    }else if(thankYouMessageData.after == 2){

                        var thanksMessage = document.createElement('p');
                        thanksMessage.className = "thankYou_message_text";
                        thanksMessage.style.color = "#" + data.fontColor;
                        if(data.language == 'fa'){
                            thanksMessage.innerText = "آیا اجازه میدهید تا ما با استفاده از نظر شما و (کوکی-رفتار- تعاملاتان) در راستای سریع تر شدن و بهبود کارایی در اینده استفاده کنیم؟";
                        }else if(data.language == 'en'){
                            thanksMessage.innerText = "Do you allow us to use your opinion and (cookies-behavior-interactions) in order to accelerate and improve performance in the future?";

                        }
                        hantana_items_div_question_survey.appendChild(thanksMessage);
                
                        var colorBtnsThanks = '#ffffff';
                        var hexToRgbValue = hexToRgbHantana('#' + data.nextButtonColor);
                        if(hexToRgbValue){
                            var colorText = getContrastColor(hexToRgbValue.r, hexToRgbValue.g, hexToRgbValue.b, 1);
                            colorBtnsThanks = colorText;
                        }
                        
                        var buttonDeny = document.createElement('button');
                        buttonDeny.style.backgroundColor = '#' + data.nextButtonColor;
                        buttonDeny.className = "accept_deny_btn_thankyou";
                        var divImage = document.createElement('div');
                        divImage.className = "deny_btn_thankyou";
                        divImage.innerHTML = '<svg style="fill: '+colorBtnsThanks+'" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.8 12l3.6-3.6c.8-.8.8-2 0-2.8-.8-.8-2-.8-2.8 0L12 9.2 8.4 5.6c-.8-.8-2-.8-2.8 0-.8.8-.8 2 0 2.8L9.2 12l-3.6 3.6c-.8.8-.8 2 0 2.8.4.4.9.6 1.4.6s1-.2 1.4-.6l3.6-3.6 3.6 3.6c.4.4.9.6 1.4.6s1-.2 1.4-.6c.8-.8.8-2 0-2.8L14.8 12z"/></svg>';
                        buttonDeny.appendChild(divImage);
                        buttonDeny.onclick = function() {
                            openHantanaMainSurvey();
                        };
                        hantana_items_div_question_survey.appendChild(buttonDeny);
                        
                        
                        var buttonAccept = document.createElement('button');
                        buttonAccept.style.backgroundColor = '#' + data.nextButtonColor;
                        buttonAccept.className = "accept_deny_btn_thankyou";
                        var divImage = document.createElement('div');
                        divImage.className = "accept_btn_thankyou";
                        divImage.innerHTML = '<svg style="fill: '+colorBtnsThanks+'" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 18c-.5 0-1-.2-1.4-.6l-4-4c-.8-.8-.8-2 0-2.8.8-.8 2.1-.8 2.8 0l2.6 2.6 6.6-6.6c.8-.8 2-.8 2.8 0 .8.8.8 2 0 2.8l-8 8c-.4.4-.9.6-1.4.6z"/></svg>';
                        buttonAccept.appendChild(divImage);
                        buttonAccept.onclick = function() {
                            if(previewSurveyFlag == undefined){
                                //when not preview survey
                                saveDataSurveyHantana(ipDetail, data._id);
                            }
                            openHantanaMainSurvey();
                            // hantana_main_div_question_survey.parentNode.removeChild(hantana_main_div_question_survey);
                        };
                        hantana_items_div_question_survey.appendChild(buttonAccept);
                    }

                }
            }else{
                // require
                if(question.type == 1){
                    createNormalInputSurveyHantana(question);
                }else if(question.type == 2){
                    createLongTestInputSurveyHantana(question);
                }else if(question.type == 3){
                    createEmailInputSurveyHantana(question);
                }else if(question.type == 4){
                    createRadioButtonsSurveyHantana(question);                   
                }else if(question.type == 5){
                    createCheckBoxSurveyHantana(question);
                }else if(question.type == 6){
                    createRateSurveyHantana(question, 5);
                }else if(question.type == 7){
                    createRateSurveyHantana(question, 7);
                }else if(question.type == 8){
                    createRateSurveyHantana(question, 10);
                }else if(question.type == 9){
                    createMessageShowSurveyHantana(question);
                    enableButtonSurveySendInHantana();
                }
            }

            emptyAnswersCache();
            // console.log(JSON.stringify(answersData))

        }

        // setInterval(function(){
        //     console.log(answersData)
        // },2000);
    

        onEndRequesAndInjectHantana('survey');

        viewSurvey = true;
        window.Hantana.showSurvey = function (flagOpen) {
            if(data.whenShowType == 6){
                if(data.untilShow == 2){
                    addToUntilSurveyList(data._id, '2');
                }
                document.body.appendChild(hantana_main_div_question_survey);
                if(flagOpen){
                    flagClickOpenServey = false;
                    openHantanaMainSurvey();
                }  
            }    
        }

    }


   
    
    //subscribe start
    function createSubscribeHantana(data){

        var subscribeIndex = data.index,
        dataNewsletter1Hantana = data.data,
        flagClickNewsLetter = false,
        c1NewsLetter = 'EEEEEE',//button enable background
        c4NewsLetter = '4d4d4d',//button enable color
        c3NewsLetter = 'FFFFFF',//button disable color
        c2NewsLetter = '5E5E5E',//button disable background
        c5NewsLetter = '4d4d4d',//back colors
        lc = '2',
        c2 = 'EEEEEE',
        c3 = '4d4d4d',
        hexToRgbANewsLetter = hexToRgbAHantana('#'+c5NewsLetter);

        var hantana_all_main_div_newsLetter = document.createElement('div');
        hantana_all_main_div_newsLetter.className = "div_hantana_main_100_newsletter1 div_hantana_all_main_newsletter1";


        var hantana_main_div_newsLetter = document.createElement('div');
        hantana_main_div_newsLetter.className = "div_main_hantana_newsletter1";
        hantana_main_div_newsLetter.id = "div_main_hantana_newsletter1_id";

        var persianPlaceholderEmail = '';
        if(checkTextIsPersian(dataNewsletter1Hantana.placeholderEmail)){
            persianPlaceholderEmail = '.input_hantana_main_newsletter_1_1::-webkit-input-placeholder {text-align: right !important;}.input_hantana_main_newsletter_1_1:-moz-placeholder {text-align: right !important;}.input_hantana_main_newsletter_1_1::-moz-placeholder {text-align: right !important;}.input_hantana_main_newsletter_1_1:-ms-input-placeholder {text-align: right !important;}.input_hantana_main_newsletter_1_1{direction: rtl !important;}.input_hantana_main_newsletter_1_1::placeholder {text-align: right !important;}';
        }
        var persianPlaceholderPhone = '';
        if(checkTextIsPersian(dataNewsletter1Hantana.placeholderPhone)){
            persianPlaceholderPhone = '.input_hantana_main_newsletter1_2::-webkit-input-placeholder {text-align: right !important;}.input_hantana_main_newsletter_1_2:-moz-placeholder {text-align: right !important;}.input_hantana_main_newsletter_1_2::-moz-placeholder {text-align: right !important;}.input_hantana_main_newsletter_1_2:-ms-input-placeholder {text-align: right !important;}.input_hantana_main_newsletter_1_2{direction: rtl !important;}.input_hantana_main_newsletter_1_2::placeholder {text-align: right !important;}';
        }


        var changesCssNewsletter1Hantana = persianPlaceholderEmail + persianPlaceholderPhone;
        var style_hantana_font = '<style>'+changesCssNewsletter1Hantana+'</style>';
        document.head.insertAdjacentHTML('beforeend', style_hantana_font );

        var hantana_open_div_newsLetter = document.createElement('div');
        hantana_open_div_newsLetter.className = "div_main_hantana_newsletter1_open";
        hantana_open_div_newsLetter.id = "div_main_hantana_newsletter1_open_id";
        hantana_open_div_newsLetter.onclick = function() {
            openHantanaMainNewsLetter2()
        };
        hantana_open_div_newsLetter.onmouseover = function() {
            openHantanaMainNewsLetter2MouseOver(this)
        };
        hantana_open_div_newsLetter.onmouseout = function() {
            openHantanaMainNewsLetter2MouseOut(this)
        };
        hantana_main_div_newsLetter.appendChild(hantana_open_div_newsLetter);

        var hantana_open_img_newsLetter = document.createElement('img');
        hantana_open_img_newsLetter.alt = "hantana";
        hantana_open_img_newsLetter.className = "img_hantana_main_newsletter_2";
        hantana_open_img_newsLetter.id = "img_hantana_main_newsletter_2_id";
        hantana_open_img_newsLetter.src = arrowBottomHantana;
        hantana_open_img_newsLetter.onmousedown = function() {return false};
        hantana_open_div_newsLetter.appendChild(hantana_open_img_newsLetter);

        var hantana_100_1_div_newsLetter = document.createElement('div');
        hantana_100_1_div_newsLetter.className = "div_hantana_main_100_newsletter1";
        hantana_all_main_div_newsLetter.appendChild(hantana_100_1_div_newsLetter);

        var hantana_p_title_div_newsLetter = document.createElement('p');
        hantana_p_title_div_newsLetter.className = "p_hantana_main_newsletter1_1";
        hantana_p_title_div_newsLetter.id = "p_hantana_main_newsletter1_1_id";
        if(checkTextIsPersian(dataNewsletter1Hantana.title)){
            hantana_p_title_div_newsLetter.style.cssText = 'direction: rtl';
        }
        hantana_p_title_div_newsLetter.innerText = dataNewsletter1Hantana.title;
        hantana_100_1_div_newsLetter.appendChild(hantana_p_title_div_newsLetter);

        var hantana_100_2_div_newsLetter = document.createElement('div');
        hantana_100_2_div_newsLetter.className = "div_hantana_main_100_newsletter1";
        hantana_all_main_div_newsLetter.appendChild(hantana_100_2_div_newsLetter);


        var hantana_inp_email_div_newsLetter = document.createElement('input');
        hantana_inp_email_div_newsLetter.className = "input_hantana_main_newsletter1_1 input_hantana_main_newsletter_1_1";
        hantana_inp_email_div_newsLetter.id = "input_hantana_main_newsletter1_1_id";
        hantana_inp_email_div_newsLetter.type = "text";
        hantana_inp_email_div_newsLetter.placeholder = dataNewsletter1Hantana.placeholderEmail;
        if(checkTextIsPersian(dataNewsletter1Hantana.placeholderEmail)){
            hantana_inp_email_div_newsLetter.style.cssText = 'direction: rtl !important';
        }else{
            hantana_inp_email_div_newsLetter.style.cssText = 'direction: ltr !important';
        }
        hantana_inp_email_div_newsLetter.onkeyup = function() {
            onChangeMainInputsHantana2(this.value)
        }
        if(Number(dataNewsletter1Hantana.statusViewFilds) == 1 || Number(dataNewsletter1Hantana.statusViewFilds) == 3){
            hantana_100_2_div_newsLetter.appendChild(hantana_inp_email_div_newsLetter);
        }



        var hantana_100_5_div_newsLetter = document.createElement('div');
        hantana_100_5_div_newsLetter.className = "div_hantana_main_100_newsletter1";
        hantana_all_main_div_newsLetter.appendChild(hantana_100_5_div_newsLetter);


        var hantana_inp_phone_div_newsLetter = document.createElement('input');
        hantana_inp_phone_div_newsLetter.className = "input_hantana_main_newsletter1_1 input_hantana_main_newsletter_1_2";
        hantana_inp_phone_div_newsLetter.id = "input_hantana_main_newsletter1_2_id";
        hantana_inp_phone_div_newsLetter.type = "text";
        hantana_inp_phone_div_newsLetter.placeholder = dataNewsletter1Hantana.placeholderPhone;
        hantana_inp_phone_div_newsLetter.onfocus = function(){
            hantana_inp_phone_div_newsLetter.value = '09';
            disableButtonSendInHantana();
        };
        hantana_inp_phone_div_newsLetter.onkeydown = function() {
            var key = event.keyCode || event.charCode;

            if(key == 8||key == 46){
                if(hantana_inp_phone_div_newsLetter.value.length == 2){
                    return false;
                }
            }

        };
        if(checkTextIsPersian(dataNewsletter1Hantana.placeholderPhone)){
            hantana_inp_phone_div_newsLetter.style.cssText = 'direction: rtl !important';
        }else{
            hantana_inp_phone_div_newsLetter.style.cssText = 'direction: ltr !important';
        }
        hantana_inp_phone_div_newsLetter.onkeyup = function() {
            onChangeMainInputsHantana2()
        }
        hantana_inp_phone_div_newsLetter.addEventListener('input', restrictNumber);
        function restrictNumber (e) {
            var newValue = this.value.replace(new RegExp(/[^\d]/,'ig'), "");
            this.value = newValue;
        }
        hantana_inp_phone_div_newsLetter.onblur = function() {
            if(checkTextIsPersian(dataNewsletter1Hantana.placeholderPhone)){
                onPersianTextHantanaPhoneInp(this.value);
            }
        }
        if(Number(dataNewsletter1Hantana.statusViewFilds) == 2 || Number(dataNewsletter1Hantana.statusViewFilds) == 3){
            hantana_100_5_div_newsLetter.appendChild(hantana_inp_phone_div_newsLetter);
        }





        var hantana_100_3_div_newsLetter = document.createElement('div');
        hantana_100_3_div_newsLetter.className = "div_hantana_main_100_newsletter1 div_hantana_main_flex_newsletter1";
        hantana_all_main_div_newsLetter.appendChild(hantana_100_3_div_newsLetter);



        var hantana_50_1_div_newsLetter = document.createElement('div');
        hantana_50_1_div_newsLetter.className = "div_hantana_main_50_newsletter1 text_left_hantana2_newsletter1";
        hantana_100_3_div_newsLetter.appendChild(hantana_50_1_div_newsLetter);


        var hantana_p_power_div_newsLetter = document.createElement('p');
        hantana_p_power_div_newsLetter.className = "p_hantana_main_newsletter1_2";
        hantana_p_power_div_newsLetter.id = "p_hantana_main_newsletter1_2_id";
        if(dataNewsletter1Hantana.showHantanaBrand == true || checkAccountUserResultHantana == 0 || checkAccountUserResultHantana == 1){
            var urlDataSourceHantana = 'https://hantana.org/?utm_source='+window.location.href+'&utm_medium=widget&utm_campaign=referral-poweredBy&device='+userAgentHantana()+'&widgetCode=3';
            if(dataNewsletter1Hantana.language == 'fa'){
                hantana_p_power_div_newsLetter.innerHTML = '<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_newsletter1_logo_power_fa" onmousedown="return false;" src="'+poweredByImg+'" /></a>قدرت گرفته از';
            }else{
                hantana_p_power_div_newsLetter.innerHTML = 'powered by<a href="'+urlDataSourceHantana+'" target="_blank"><img class="img_hantana_main_newsletter1_logo_power_en" onmousedown="return false;" src="'+poweredByImg+'" /></a>';
            }
        }
        hantana_50_1_div_newsLetter.appendChild(hantana_p_power_div_newsLetter);


        var hantana_50_2_div_newsLetter = document.createElement('div');
        hantana_50_2_div_newsLetter.className = "div_hantana_main_50_newsletter1 text_right_hantana2_newsletter1";
        hantana_100_3_div_newsLetter.appendChild(hantana_50_2_div_newsLetter);


        var hantana_btn_send_newsLetter = document.createElement('button');
        hantana_btn_send_newsLetter.className = "btn_hantana_main_newsletter1";
        hantana_btn_send_newsLetter.id = "btn_hantana_main_newsletter1_id";
        hantana_btn_send_newsLetter.innerText = dataNewsletter1Hantana.buttonSendText;
        hantana_btn_send_newsLetter.disabled = true;
        hantana_btn_send_newsLetter.onclick = function() {
            sendNewsLetterBtnHantana2();
        }
        hantana_50_2_div_newsLetter.appendChild(hantana_btn_send_newsLetter);

        var hantana_100_4_div_newsLetter = document.createElement('div');
        hantana_100_4_div_newsLetter.className = "div_hantana_main_after_send_newsletter1 animated_hantana fadeIn_hantana_animate";
        hantana_100_4_div_newsLetter.id = "div_hantana_main_after_send_newsletter1_id";
        hantana_all_main_div_newsLetter.appendChild(hantana_100_4_div_newsLetter);

        var hantana_p_tan_div_newsLetter = document.createElement('p');
        hantana_p_tan_div_newsLetter.className = "p_hantana_main_newsletter1_3";
        hantana_p_tan_div_newsLetter.id = "p_hantana_main_newsletter1_3_id";
        hantana_p_tan_div_newsLetter.innerText = dataNewsletter1Hantana.thankYouText;
        hantana_100_4_div_newsLetter.appendChild(hantana_p_tan_div_newsLetter);




        function openHantanaMainNewsLetter2MouseOver(thisItem) {
            thisItem.style.boxShadow = '0 0 18px 2px '+hexToRgbANewsLetter+'';
        }
        function openHantanaMainNewsLetter2MouseOut(thisItem) {
            thisItem.style.boxShadow = 'none';
        }
        function openHantanaMainNewsLetter2() {
            if(flagClickNewsLetter){
                closeMainNewsletter1();
            }else{
                openMainNewsletter1();
            }
        }

        function checkInputsNewsLetterFun(email, phone) {
            if((Number(dataNewsletter1Hantana.statusViewFilds) == 3 && Number(dataNewsletter1Hantana.requiredEmail) == 1 && Number(dataNewsletter1Hantana.requiredPhone) == 0)){
                if(phone != ''){
                    return (isValidEmail(email) && phone.length == 11 && Number.isInteger(Number(phone)))
                }else{
                    return (isValidEmail(email))
                }
            }else if((Number(dataNewsletter1Hantana.statusViewFilds) == 3 && Number(dataNewsletter1Hantana.requiredEmail) == 0 && Number(dataNewsletter1Hantana.requiredPhone) == 1)){
                if(email != ''){
                    return (isValidEmail(email) && phone.length == 11 && Number.isInteger(Number(phone)))
                }else{
                    return (phone.length == 11 && Number.isInteger(Number(phone)))
                }
            }else if(Number(dataNewsletter1Hantana.statusViewFilds) == 3 && Number(dataNewsletter1Hantana.requiredEmail) == 1 && Number(dataNewsletter1Hantana.requiredPhone) == 1){
                return (isValidEmail(email) && phone.length == 11 && Number.isInteger(Number(phone)))
            }else if((Number(dataNewsletter1Hantana.statusViewFilds) == 1)){
                return (isValidEmail(email))
            }else if((Number(dataNewsletter1Hantana.statusViewFilds) == 2)){
                return (phone.length == 11 && Number.isInteger(Number(phone)))
            }
        }
        function onChangeMainInputsHantana2() {
            var email = hantana_inp_email_div_newsLetter.value;
            var phone = hantana_inp_phone_div_newsLetter.value;
            if(checkInputsNewsLetterFun(email, phone)){
                enableButtonSendInHantana();
            }else{
                disableButtonSendInHantana();
            }
        }
        function enableButtonSendInHantana() {
            hantana_btn_send_newsLetter.style.background = '#'+c1NewsLetter+'';//c1NewsLetter
            hantana_btn_send_newsLetter.style.color = '#'+c4NewsLetter+'';//c4NewsLetter
            hantana_btn_send_newsLetter.style.cursor = "pointer";
            hantana_btn_send_newsLetter.style.setProperty("opacity", "1", "important");
            hantana_btn_send_newsLetter.disabled = false;
        }
        function disableButtonSendInHantana() {
            hantana_btn_send_newsLetter.style.background = '#'+c2NewsLetter+'';//c2NewsLetter
            hantana_btn_send_newsLetter.style.color = '#'+c3NewsLetter+'';//c3NewsLetter
            hantana_btn_send_newsLetter.style.cursor = "not-allowed";
            hantana_btn_send_newsLetter.style.setProperty("opacity", "0.5", "important");
            hantana_btn_send_newsLetter.disabled = true;
        }

        async function saveDataHantanaNewsLetter(ipDetail) {

            var email = hantana_inp_email_div_newsLetter.value;
            var phone = hantana_inp_phone_div_newsLetter.value;
            var setUserData = getDataUserApi();

            var request = new XMLHttpRequest();
            // POST to httpbin which returns the POST data as JSON
            request.open('POST', 'https://hantana.org/widget/newNewsLetter', true);
            var formData = new FormData();
            formData.append('ipDetail', ipDetail);
            formData.append('urlData', window.location.href);
            if(Number(dataNewsletter1Hantana.statusViewFilds) == 1){
                formData.append('email', email);
                formData.append('phone', '');
            }else if(Number(dataNewsletter1Hantana.statusViewFilds) == 2){
                formData.append('email', '');
                formData.append('phone', phone);
            }else if(Number(dataNewsletter1Hantana.statusViewFilds) == 3){
                formData.append('email', email);
                formData.append('phone', phone);
            }
            formData.append('siteToken', window._hantanaSettings.tId);
            formData.append('userAgent', navigator.userAgent);
            formData.append('screenHeight', window.screen.height);
            formData.append('screenWidth', window.screen.width);
            formData.append('device',  userAgentHantana());
            formData.append('setUserData', JSON.stringify(setUserData));
            request.send(formData);
            if(JSON.parse(request.responseText)['status']){
                return true;
            }
        }

        function sendNewsLetterBtnHantana2() {
            var email = hantana_inp_email_div_newsLetter.value;
            var phone = hantana_inp_phone_div_newsLetter.value;

            if(checkInputsNewsLetterFun(email, phone)){
                saveDataHantanaNewsLetter(ipDetail);
                if(window.Hantana.hideSubscribeAfterSend){
                    // != undefined
                    if(window.Hantana.hideSubscribeAfterSendFlag){
                        localStorage.showSubscribeHantanaAfterUseFlag = 'false';
                    }
                    var second = window.Hantana.hideSubscribeAfterSend;
                    if(isNaN(second) || Number(second) == 0){
                        hantana_main_div_newsLetter.style.display = 'none';
                    }else{
                        setTimeout(function(){
                            hantana_main_div_newsLetter.style.display = 'none';
                        },second * 1000);
                    }
                }
                afterNewsletter1Show();
            }
        }

        function afterNewsletter1Show() {
            hantana_100_4_div_newsLetter.style.display = 'flex';
            disableButtonSendInHantana();
            setTimeout(function () {
                closeMainNewsletter1();
                setTimeout(function() {
                    hantana_100_4_div_newsLetter.style.display = 'none';
                },500);
            },2500);
        }

        function openMainNewsletter1() {
            flagClickNewsLetter = true;
            hantana_open_div_newsLetter.style.background = '#' + c3;
            hantana_open_img_newsLetter.setAttribute("style", "transform: rotate(180deg)");
            hantana_main_div_newsLetter.style.bottom = '0px';
            if (document.documentElement.clientWidth < 450) {
                hantana_main_div_newsLetter.style.top = '0px';
                hantana_main_div_newsLetter.style.borderRadius = '0px';

                hantana_open_div_newsLetter.style.top = '12px';
                hantana_open_div_newsLetter.style.right = '0px';
                hantana_open_div_newsLetter.style.left = '0px';
            }

        }


        function closeMainNewsletter1() {
            flagClickNewsLetter = false;
            hantana_inp_email_div_newsLetter.value = '';
            hantana_inp_email_div_newsLetter.blur();
            hantana_inp_phone_div_newsLetter.value = '';
            hantana_inp_phone_div_newsLetter.blur();
            
            if(checkTextIsPersian(dataNewsletter1Hantana.placeholderEmail)){
                hantana_inp_email_div_newsLetter.style.cssText = 'direction: rtl !important';
            }
            if(checkTextIsPersian(dataNewsletter1Hantana.placeholderPhone)){
                hantana_inp_phone_div_newsLetter.style.cssText = 'direction: rtl !important';
            }
            hantana_open_img_newsLetter.setAttribute("style", "transform: rotate(0deg)");
            if (document.documentElement.clientWidth < 450) {
                hantana_main_div_newsLetter.style.bottom = '-'+hantana_all_main_div_newsLetter.clientHeight+'px';
                hantana_main_div_newsLetter.style.top = 'auto';
                hantana_main_div_newsLetter.style.borderRadius = '4px 4px 0 0';

                hantana_open_div_newsLetter.style.top = '-26px';

                if(dataNewsletter1Hantana.position == 'bottom-right'){
                    hantana_open_div_newsLetter.style.left = 'auto';
                    hantana_open_div_newsLetter.style.right = '35px';
                }else if(dataNewsletter1Hantana.position == 'bottom-center'){
                    hantana_open_div_newsLetter.style.left = '0';
                    hantana_open_div_newsLetter.style.right = '0';
                }else if(dataNewsletter1Hantana.position == 'bottom-left'){
                    hantana_open_div_newsLetter.style.left = '35px';
                    hantana_open_div_newsLetter.style.right = 'auto';
                }


            }else{
                hantana_main_div_newsLetter.style.bottom = '-'+hantana_main_div_newsLetter.clientHeight+'px';
            }


        }


        function openAutoNewsletter1(second) {
            setTimeout(function () {
                openMainNewsletter1();
            },(second * 1000));
        }

        if(((dataNewsletter1Hantana.showInDesktop && userAgentHantana() == 'desktop') || (dataNewsletter1Hantana.showInTablet && userAgentHantana() == 'tablet') || (dataNewsletter1Hantana.showInMobile && userAgentHantana() == 'mobile')) || flagRequireRunHantana == 'true'){
            hantana_main_div_newsLetter.appendChild(hantana_all_main_div_newsLetter);
            document.body.appendChild(hantana_main_div_newsLetter);
            // document.getElementsByTagName("html")[0].appendChild(hantana_main_div_newsLetter);
        }




        // document.addEventListener('readystatechange', () => {
        //     if (document.readyState == 'complete') {

                hantana_main_div_newsLetter.style.display = 'flex';


                if(dataNewsletter1Hantana.openAutoFlag){
                    if (localStorage.viewCheckInAutoOpenNewsletter1) {
                        localStorage.viewCheckInAutoOpenNewsletter1 = dataNewsletter1Hantana.openAutoOnce;
                        if(localStorage.viewCheckInAutoOpenNewsletter1 == 'false'){
                            openAutoNewsletter1(dataNewsletter1Hantana.openAutoSecond);
                        }
                    }else{
                        localStorage.viewCheckInAutoOpenNewsletter1 = dataNewsletter1Hantana.openAutoOnce;
                        openAutoNewsletter1(dataNewsletter1Hantana.openAutoSecond);
                    }
                }

                if(checkTextIsPersian(dataNewsletter1Hantana.thankYouText)){
                    hantana_p_tan_div_newsLetter.style.direction = 'rtl';
                }else{
                    hantana_p_tan_div_newsLetter.style.direction = 'ltr';
                }


                if (document.documentElement.clientWidth < 450) {

                    if(dataNewsletter1Hantana.position == 'bottom-right'){
                        hantana_open_div_newsLetter.style.left = 'auto';
                        hantana_open_div_newsLetter.style.right = '35px';
                    }else if(dataNewsletter1Hantana.position == 'bottom-center'){
                        hantana_open_div_newsLetter.style.left = '0';
                        hantana_open_div_newsLetter.style.right = '0';
                        hantana_main_div_newsLetter.style.left = '0';
                        hantana_main_div_newsLetter.style.right = '0';
                    }else if(dataNewsletter1Hantana.position == 'bottom-left'){
                        hantana_open_div_newsLetter.style.left = '35px';
                        hantana_open_div_newsLetter.style.right = 'auto';
                    }

                }else{

                    hantana_main_div_newsLetter.style.setProperty("padding", "15px", "important");


                    if(dataNewsletter1Hantana.position == 'bottom-right'){
                        hantana_main_div_newsLetter.style.right = '35px';
                        hantana_open_div_newsLetter.style.right = '35px';
                    }else if(dataNewsletter1Hantana.position == 'bottom-center'){
                        hantana_open_div_newsLetter.style.left = '0';
                        hantana_open_div_newsLetter.style.right = '0';
                        hantana_main_div_newsLetter.style.left = '0';
                        hantana_main_div_newsLetter.style.right = '0';
                    }else if(dataNewsletter1Hantana.position == 'bottom-left'){
                        hantana_main_div_newsLetter.style.left = '35px';
                        hantana_open_div_newsLetter.style.left = '35px';
                    }

                }



                hantana_100_4_div_newsLetter.style.background = '#'+c5NewsLetter+'';
                hantana_main_div_newsLetter.style.background = '#'+c5NewsLetter+'';
                hantana_open_div_newsLetter.style.background = '#'+c5NewsLetter+'';


            // }
        // });

        //add to page
        hantana_main_div_newsLetter.style.bottom = '-'+hantana_main_div_newsLetter.clientHeight+'px';
        hantana_main_div_newsLetter.style.transition = 'all 0.3s ease';

        //newsLetter client apis
        window.Hantana.openSubscribe = function (second) {
            setTimeout(function(){
                openMainNewsletter1();
            },second * 1000);
        };
        window.Hantana.closeSubscribe = function (second) {
            setTimeout(function(){
                closeMainNewsletter1();
            },second * 1000);
        };
        window.Hantana.toggleSubscribe = function (second) {
            setTimeout(function(){
                var hasDisplayNone = (hantana_main_div_newsLetter.style.bottom != '0px');
                if(hasDisplayNone == true){
                    openMainNewsletter1();
                }else{
                    closeMainNewsletter1();
                }
            },second * 1000);
        };
        window.Hantana.setColorButtonSubscribe = function (background, color) {
            //&& /^#([0-9A-F]{3}){1,2}$/i.test(color)
            if(/^#([0-9A-F]{3}){1,2}$/i.test(background)){
                hantana_open_div_newsLetter.style.background = background;
                // hantana_open_p_div_question_survey.style.color = color;
            }else{
                console.log('invalid color')
            }   
        };
        window.Hantana.setTitleSubscribe = function (title) {
            hantana_p_title_div_newsLetter.innerText = title;
        }
        window.Hantana.setPlaceholderEmailTextBoxSubscribe = function (placeholder) {
            hantana_inp_email_div_newsLetter.placeholder = placeholder;
        }
        window.Hantana.setPlaceholderMobileTextBoxSubscribe = function (placeholder) {
            hantana_inp_phone_div_newsLetter.placeholder = placeholder;
        }
        window.Hantana.hideAfterSendSubscribe = function (second, flag = false) {
            window.Hantana.hideSubscribeAfterSend = second.toString();
            window.Hantana.hideSubscribeAfterSendFlag = flag;
        }
        
        onEndRequesAndInjectHantana('subscribe');
    }

  


    //retake start
    if(document.readyState !== 'loading') {
        retakeScreenShotHantanaInPage();
    } else {
        document.addEventListener('DOMContentLoaded', function () {
            retakeScreenShotHantanaInPage();
        });
    }
    function retakeScreenShotHantanaInPage(){

        
        var urlParams = new URLSearchParams(window.location.search);
        if(urlParams.has('_hantana_hp') && urlParams.has('_hantana_ht') && urlParams.has('_hantana_hs') && urlParams.has('_hantana_de')){

            // function getSheetsHantana(styleSheetData){
            //     var classes = (styleSheetData.cssRules || styleSheetData.rules), styles = '';
            //     for (var x = 0; x < classes.length; x++) {
            //         if (classes[x].cssText) {
            //             styles += classes[x].cssText;
            //         } else {
            //             styles += classes[x].style.cssText;
            //         }
            //     }
            //     return styles.toString();
            // }
            // var styleSheets = document.styleSheets, arrDataStyles = [];
            // for (var i = 0; i < styleSheets.length; i++) {
            //     if(styleSheets[i]['href'] == null){
            //         var data = getSheetsHantana(styleSheets[i]);
            //         arrDataStyles.push({index:i, style:'<style>' + data + '</style>'});        
            //     }
            // }
            // arrDataStyles.forEach(function(item){
            //     document.head.innerHTML += item.style;
            //     document.styleSheets[item.index].disabled = true;
            // });

            var heatMapPage = urlParams.get('_hantana_hp');
            var heatMapToken = urlParams.get('_hantana_ht');
            var siteToken = urlParams.get('_hantana_hs');
            var heatMapDevice = urlParams.get('_hantana_de');

            //window._hantanaSettings['flagScreenShot'] = false;

            removeURLParametersHantana(['_hantana_hp', '_hantana_ht', '_hantana_hs', '_hantana_de'])

            var hantana_retake_screenShot_main = document.createElement('div');
            hantana_retake_screenShot_main.style.cssText = "position: fixed !important;z-index: 2147483647;left: 0 !important;right: 0 !important;margin: 0 auto !important;bottom: 14px;text-align: center;max-width: 370px;";
            hantana_retake_screenShot_main.id = "heatmapRetakeMainDiv";

            var hantana_retake_screenShot_btn = document.createElement('button');
            // hantana_retake_screenShot_btn.innerHTML = "&#9732;";
            hantana_retake_screenShot_btn.innerHTML =  '<svg xmlns="http://www.w3.org/2000/svg" width="30" height="45" viewBox="0 0 172 172" style="width: 35px;"><g fill="none" stroke-miterlimit="10" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode:normal"><path d="M0 172V0h172v172z"/><path d="M73.36 17.917a16.174 16.174 0 00-13.927 8l-7.874 13.5H37.625c-12.843 0-23.292 10.449-23.292 23.291v68.084c0 12.842 10.45 23.291 23.292 23.291h96.75c12.843 0 23.292-10.449 23.292-23.291V62.708c0-12.842-10.45-23.291-23.292-23.291h-13.934l-7.874-13.5a16.174 16.174 0 00-13.927-8zm12.64 43c17.78 0 32.25 14.466 32.25 32.25s-14.47 32.25-32.25 32.25-32.25-14.466-32.25-32.25S68.22 60.917 86 60.917zm0 10.75c-11.874 0-21.5 9.626-21.5 21.5s9.626 21.5 21.5 21.5 21.5-9.626 21.5-21.5-9.626-21.5-21.5-21.5z" fill="#fff"/></g></svg>';
            hantana_retake_screenShot_btn.style.cssText = "font-size: 29px;font-weight: bold;color: rgb(255, 255, 255) !important;background: rgb(252, 92, 101) none repeat scroll 0% 0% !important;border: 0px none !important;border-radius: 50px !important;width: 75px !important;height: 75px !important;box-shadow: rgb(200, 200, 200) 0px 4px 17px 0px !important;opacity: 1 !important;cursor: pointer !important;margin: 0 !important;line-height: 0 !important; padding: 0 !important;text-align: center !important;";
            hantana_retake_screenShot_main.appendChild(hantana_retake_screenShot_btn);

            var hantana_retake_screenShot_div = document.createElement('div');
            hantana_retake_screenShot_div.style.cssText = "color: #4d4d4d;background: #fff;border: 0px none;border-radius: 8px;max-width: 340px;height: 75px;box-shadow: 0 4px 30px 0 rgba(0, 0, 0, 0.2);margin: 0 auto !important;position: absolute;top: -100px;left: 0;right: 0;padding-bottom: 10px;";
            hantana_retake_screenShot_main.appendChild(hantana_retake_screenShot_div);

            var hantana_retake_screenShot_div1 = document.createElement('div');
            hantana_retake_screenShot_div1.style.cssText = "background: #fff;margin: 0px auto !important;position: absolute;left: 0px;right: 0px;width: 20px;height: 20px;bottom: -6px;transform: rotate(135deg);border-radius: 0 2px 0 0;";
            hantana_retake_screenShot_div.appendChild(hantana_retake_screenShot_div1);

            var hantana_retake_screenShot_p1 = document.createElement('p');
            hantana_retake_screenShot_p1.innerText = "قبل از بروزرسانی تصویر صفحه!";
            hantana_retake_screenShot_p1.style.cssText = "font-weight: bold;direction: rtl;font-size: 15px;margin-top: 12px !important;margin-bottom: 0px !important;margin-bottom: 0px;font-family: hantanaVazir !important;text-align: center;";
            hantana_retake_screenShot_div.appendChild(hantana_retake_screenShot_p1);

            var hantana_retake_screenShot_p2 = document.createElement('p');
            hantana_retake_screenShot_p2.innerText = "برای بررسی کامل بارگیری صفحه، به پایین بروید.";
            hantana_retake_screenShot_p2.style.cssText = "direction: rtl;font-size: 15px;margin-top: 4px !important;font-weight: 200;font-family: hantanaVazir !important;text-align: center;margin-bottom: 4px !important;";
            hantana_retake_screenShot_div.appendChild(hantana_retake_screenShot_p2);

            var hantana_retake_screenShot_btn1 = document.createElement('button');
            hantana_retake_screenShot_btn1.innerText = "بستن پنجره";
            hantana_retake_screenShot_btn1.style.cssText = "direction: rtl;margin-top: 4px;font-family: hantanaVazir !important;background: #42CA49;color: #fff;font-weight: bold;border: 0;border-radius: 5px;font-size: 14px;padding: 9px 21px;box-shadow: 0 -9px 15px 0 #eee;display:none;height: 38px;line-height: 18px;";
            hantana_retake_screenShot_div.appendChild(hantana_retake_screenShot_btn1);

            var hantana_retake_screenShot_div2 = document.createElement('div');
            hantana_retake_screenShot_div2.style.cssText = "position: fixed !important;top: 0;left: 0;background: rgba(255, 255, 255, 0.9);width: 100%;height: 100%;z-index: -1;display: none;";
            hantana_retake_screenShot_main.appendChild(hantana_retake_screenShot_div2);

            document.body.appendChild(hantana_retake_screenShot_main);

            var flagRunHideHantanaHeatmapDiv1 = false;
            window.addEventListener("scroll", function () {
                if(flagRunHideHantanaHeatmapDiv1 == false){
                    hantana_retake_screenShot_div.style.display = 'none';
                    flagRunHideHantanaHeatmapDiv1 = true;
                }
            });
            hantana_retake_screenShot_btn1.onclick = function(e) {
                window.close()
            }
            hantana_retake_screenShot_btn.onclick = function(e) {

                fixInlineStylesHantana().then(function(){
                
                    flagRunHideHantanaHeatmapDiv1 = true;
                    hantana_retake_screenShot_main.style.display = 'none';//main hide
                    hantana_retake_screenShot_div.style.display = 'none';
                    hantana_retake_screenShot_div2.style.display = 'block';
                    fadeInHantana(hantana_retake_screenShot_div2, 100);
                    //window.scrollTo(0, 0);
                    setTimeout(function () {
                        // hantana_retake_screenShot_btn.innerHTML = "&#4112;";
                        hantana_retake_screenShot_btn.innerHTML = '<svg width="38" height="38" xmlns="http://www.w3.org/2000/svg" style="width: 35px;"><defs><linearGradient x1="8.042%" y1="0%" x2="65.682%" y2="23.865%" id="a"><stop stop-color="#fff" stop-opacity="0" offset="0%"/><stop stop-color="#fff" stop-opacity=".631" offset="63.146%"/><stop stop-color="#fff" offset="100%"/></linearGradient></defs><g transform="translate(1 1)" fill="none" fill-rule="evenodd"><path d="M36 18c0-9.94-8.06-18-18-18" stroke="url(#a)" stroke-width="2"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="0.9s" repeatCount="indefinite"/></path><circle fill="#fff" cx="36" cy="18" r="1"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="0.9s" repeatCount="indefinite"/></circle></g></svg>';
                        hantana_retake_screenShot_btn.setAttribute("disabled", true);
                        var generatedSource = new XMLSerializer().serializeToString(document);
                        var data = new Blob([generatedSource], {type: 'text/html'});
                        hantana_retake_screenShot_main.style.display = 'block';//main hide
                        var fd = new FormData;
                        fd.append('textDoc', data);
                        fd.append('heatMapDevice', heatMapDevice);
                        fd.append('heatMapPage', heatMapPage);
                        fd.append('heatMapToken', heatMapToken);
                        fd.append('pageUrlSource', window.location.href);
                        fd.append('siteToken', siteToken);
                        var xhr = new XMLHttpRequest();
                        xhr.file = data;
                        //headers
                        xhr.addEventListener('progress', function(e) {}, false);
                        if ( xhr.upload ) {xhr.upload.onprogress = function(e) {};}
                        xhr.onreadystatechange = function(e) {
                            if (4 == this.readyState ) {
                                // if(window._hantanaSettings.log){
                                    console.log(xhr.responseText)
                                // }
                                var response = JSON.parse(xhr.responseText);
                                hantana_retake_screenShot_p1.innerText = "تمام شد!";
                                hantana_retake_screenShot_p2.innerText = "لطفا پنجره را بسته و به هانتانا برگردید";
                                hantana_retake_screenShot_btn.style.cssText = "font-size: 29px;font-weight: bold;color: #fff;background: #42CA49;border: 0;border-radius: 50px;width: 75px;height: 75px;box-shadow: 0 4px 17px 0 #c8c8c8;opacity: 1 !important;cursor: pointer;";
                                hantana_retake_screenShot_btn.innerHTML = "&#10004;";
                                hantana_retake_screenShot_div.style.display = 'block';
                                hantana_retake_screenShot_btn1.style.display = 'inline-block';
                                hantana_retake_screenShot_div.style.cssText = "color: #4d4d4d;background: #fff;border: 0px none;border-radius: 8px;max-width: 340px;height: 135px;box-shadow: 0 4px 30px 0 rgba(0, 0, 0, 0.2);margin: 0 auto !important;position: absolute;top: -155px;left: 0;right: 0;";
                                console.log(response)
                            }
                        };
                        xhr.open('POST', heatmapPrefixHantana + 'retakeScreenShot', true);
                        // xhr.setRequestHeader("Content-type","multipart/form-data");
                        xhr.send(fd);

                    },200);

                });

            }

        }
    }

    
    function onEndRequesAndInjectHantana(widget = null) {
        var newEvn = new CustomEvent("hantana_ready", {
            detail: {
                userAgent : navigator.userAgent,
                pageLoadTime : new Date().getTime() - startRunPage,
                tId:Hantana.user,
                widget: widget
            },
        });
        document.dispatchEvent(newEvn);
    }

    function setExternalSurveyJustQuestionsReviewStyleHantana(){
        var external_survey_style_hantana = `
        <style>
            #div_main_hantana_survey_open_id{
                display:none !important;
            }
            .div_hantana_main_100_survey{
                white-space: normal !important;
            }
        </style>
        `;
        document.head.insertAdjacentHTML('beforeend', external_survey_style_hantana);
    };
    function setExternalSurveyStyleHantana(backgroundColor){
        var external_survey_style_hantana = `
        <style>
            html {
                height: 100%;
            }
            body{
                min-height: 100%;
                margin: 0 !important;
                padding: 0 !important;
                background-color: #${backgroundColor};
                -webkit-transition: none !important;
                -moz-transition: none !important;
                -o-transition: none !important;
                transition: none !important;
            }
            #div_main_hantana_survey_open_id{
                display:none !important;
            }
            #div_main_hantana_survey_id{
                -webkit-transition: none !important;
                -moz-transition: none !important;
                -o-transition: none !important;
                transition: none !important;
                background: #fff !important;
                position: relative !important;
                box-shadow: none;
                border-radius: 5px !important;
                width: 670px !important;
                left: 0px !important;
                bottom: 0px !important;
                right: 0 !important;
                top: 50px !important;
            }
            .div_padding_right_left_15_main_survey{
                border-top: 1px solid #eee;
                margin-top: 0px !important;
                padding: 0 45px 0 45px !important;
            }
            .img_check_main_hantana_img_1{
                filter: brightness(50%) !important;
            }
            input:focus {
                outline: none !important;
            }
            textarea:focus {
                outline: none !important;
            }
            .div_check_main_hantana_div_1{
                border: 1px solid #777;
            }
            .div_main_hantana_survey_1{
                padding: 25px 45px 25px 45px !important;
            }
            .p_hantana_main_survey_2{
                padding: 20px 0px 0px 5px !important;
            }
            .btn_hantana_main_survey{
                margin: 13px 7px 0 0 !important;
            }
            .hantana_button_question_survey_skip{
                margin: 13px 12px 0 0 !important;
            }
            @media only screen and (max-width: 767px) {
                #div_main_hantana_survey_id{
                    width: 95% !important;
                }
                .hantana_main_thankyou_box_1{
                    width: 95% !important;
                }
                .div_main_hantana_survey_1{
                    padding: 25px 10px 25px 10px !important;
                }
                .div_padding_right_left_15_main_survey{
                    padding: 0 16px 0 19px !important;
                }
            }
        </style>
        `;
        document.head.insertAdjacentHTML('beforeend', external_survey_style_hantana);
    }

    if(externalSurvey == 1){
        if(externalSurveyData){
            setExternalSurveyStyleHantana(externalSurveyData.backgroundColor);
            createSurveysHantana(externalSurveyData);
        }
    }